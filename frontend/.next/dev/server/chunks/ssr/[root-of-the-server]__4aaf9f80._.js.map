{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/api/index.ts"],"sourcesContent":["import axios from 'axios'\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000'\n\n// Create axios instance\nconst api = axios.create({\n  baseURL: API_URL,\n  withCredentials: true,\n})\n\n// Add request interceptor to include access token\napi.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem('access_token')\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`\n    }\n    return config\n  },\n  (error) => Promise.reject(error)\n)\n\n// Add response interceptor to handle token refresh\napi.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config\n\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true\n\n      try {\n        // Try to refresh the token - works with both localStorage tokens and httpOnly cookies\n        const refreshToken = localStorage.getItem('refresh_token')\n        const response = await axios.post(`${API_URL}/api/v1/auth/refresh`, refreshToken ? {\n          refresh_token: refreshToken,\n        } : {}, {\n          withCredentials: true,  // Include httpOnly cookies if no localStorage token\n        })\n\n        const { access_token } = response.data\n        if (access_token) {\n          localStorage.setItem('access_token', access_token)\n          // Retry the original request with new token\n          originalRequest.headers.Authorization = `Bearer ${access_token}`\n        }\n        return api(originalRequest)\n      } catch (refreshError) {\n        // Refresh failed, redirect to login only if not already on signin page\n        localStorage.removeItem('access_token')\n        localStorage.removeItem('refresh_token')\n\n        // Only redirect if we're not already on the signin page\n        if (typeof window !== 'undefined' && !window.location.pathname.includes('/auth/signin')) {\n          window.location.href = '/auth/signin'\n        }\n        return Promise.reject(refreshError)\n      }\n    }\n\n    return Promise.reject(error)\n  }\n)\n\nexport default api\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,UAAU,6DAAmC;AAEnD,wBAAwB;AACxB,MAAM,MAAM,gJAAK,CAAC,MAAM,CAAC;IACvB,SAAS;IACT,iBAAiB;AACnB;AAEA,kDAAkD;AAClD,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAC1B,CAAC;IACC,MAAM,QAAQ,aAAa,OAAO,CAAC;IACnC,IAAI,OAAO;QACT,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;IAClD;IACA,OAAO;AACT,GACA,CAAC,QAAU,QAAQ,MAAM,CAAC;AAG5B,mDAAmD;AACnD,IAAI,YAAY,CAAC,QAAQ,CAAC,GAAG,CAC3B,CAAC,WAAa,UACd,OAAO;IACL,MAAM,kBAAkB,MAAM,MAAM;IAEpC,IAAI,MAAM,QAAQ,EAAE,WAAW,OAAO,CAAC,gBAAgB,MAAM,EAAE;QAC7D,gBAAgB,MAAM,GAAG;QAEzB,IAAI;YACF,sFAAsF;YACtF,MAAM,eAAe,aAAa,OAAO,CAAC;YAC1C,MAAM,WAAW,MAAM,gJAAK,CAAC,IAAI,CAAC,GAAG,QAAQ,oBAAoB,CAAC,EAAE,eAAe;gBACjF,eAAe;YACjB,IAAI,CAAC,GAAG;gBACN,iBAAiB;YACnB;YAEA,MAAM,EAAE,YAAY,EAAE,GAAG,SAAS,IAAI;YACtC,IAAI,cAAc;gBAChB,aAAa,OAAO,CAAC,gBAAgB;gBACrC,4CAA4C;gBAC5C,gBAAgB,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,cAAc;YAClE;YACA,OAAO,IAAI;QACb,EAAE,OAAO,cAAc;YACrB,uEAAuE;YACvE,aAAa,UAAU,CAAC;YACxB,aAAa,UAAU,CAAC;YAExB,wDAAwD;YACxD,IAAI,kDAAkB,eAAe,CAAC,OAAO,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC;;YAGxE,OAAO,QAAQ,MAAM,CAAC;QACxB;IACF;IAEA,OAAO,QAAQ,MAAM,CAAC;AACxB;uCAGa","debugId":null}},
    {"offset": {"line": 163, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/auth-context.tsx"],"sourcesContent":["'use client'\n\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react'\nimport { useRouter } from 'next/navigation'\nimport api from '@/lib/api'\n\ninterface User {\n  id: string\n  email: string\n  username: string\n  full_name?: string\n  avatar_url?: string\n  is_active: boolean\n  is_superuser: boolean\n  created_at: string\n}\n\ninterface AuthContextType {\n  user: User | null\n  loading: boolean\n  login: (email: string, password: string) => Promise<void>\n  signup: (email: string, username: string, password: string, fullName?: string) => Promise<void>\n  logout: () => void\n  checkAuth: () => Promise<void>\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [loading, setLoading] = useState(true)\n  const router = useRouter()\n\n  const checkAuth = async () => {\n    try {\n      // Try to fetch user info - will use httpOnly cookies if available\n      const response = await api.get(`/api/v1/auth/me`)\n      setUser(response.data)\n      // Also sync to localStorage for backwards compatibility if tokens are available\n      // (though httpOnly cookies are the primary mechanism)\n    } catch (error: any) {\n      // 401 is expected when user is not logged in - don't log it as an error\n      if (error.response?.status !== 401) {\n        console.error('Auth check failed:', error)\n      }\n      // Clear localStorage in case there are any stale tokens\n      localStorage.removeItem('access_token')\n      localStorage.removeItem('refresh_token')\n      setUser(null)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  useEffect(() => {\n    checkAuth()\n  }, [])\n\n  const login = async (email: string, password: string) => {\n    try {\n      const response = await api.post(`/api/v1/auth/login`, {\n        email,\n        password\n      })\n\n      const { access_token, refresh_token } = response.data\n\n      localStorage.setItem('access_token', access_token)\n      if (refresh_token) {\n        localStorage.setItem('refresh_token', refresh_token)\n      }\n\n      // Fetch user data after successful login\n      const userResponse = await api.get(`/api/v1/auth/me`)\n      setUser(userResponse.data)\n\n      // Fetch organizations to determine redirect\n      try {\n        const orgsResponse = await api.get(`/api/v1/organisations/`)\n        const organisations = orgsResponse.data\n\n        if (organisations.length === 0) {\n          // No organizations - redirect to create first one\n          router.push('/organizations/new')\n        } else if (organisations.length === 1) {\n          // One organization - auto-select and go to projects\n          localStorage.setItem('current_organisation', JSON.stringify(organisations[0]))\n          router.push(`/organizations/${organisations[0].id}/projects`)\n        } else {\n          // Multiple organizations - show selection page\n          router.push('/organizations')\n        }\n      } catch (orgError) {\n        console.error('Failed to fetch organisations:', orgError)\n        // Fallback if org fetch fails\n        router.push('/organizations')\n      }\n    } catch (error: any) {\n      console.error('Login failed:', error)\n      throw new Error(error.response?.data?.detail || 'Login failed')\n    }\n  }\n\n  const signup = async (email: string, username: string, password: string, fullName?: string) => {\n    try {\n      const response = await api.post(`/api/v1/auth/signup`, {\n        email,\n        username,\n        password,\n        full_name: fullName\n      })\n\n      const { access_token, refresh_token } = response.data\n\n      localStorage.setItem('access_token', access_token)\n      if (refresh_token) {\n        localStorage.setItem('refresh_token', refresh_token)\n      }\n\n      // Fetch user data after successful signup\n      const userResponse = await api.get(`/api/v1/auth/me`)\n      setUser(userResponse.data)\n\n      // Fetch organizations to determine redirect\n      try {\n        const orgsResponse = await api.get(`/api/v1/organisations/`)\n        const organisations = orgsResponse.data\n\n        if (organisations.length === 0) {\n          // No organizations - redirect to create first one\n          router.push('/organizations/new')\n        } else if (organisations.length === 1) {\n          // One organization - auto-select and go to projects\n          localStorage.setItem('current_organisation', JSON.stringify(organisations[0]))\n          router.push(`/organizations/${organisations[0].id}/projects`)\n        } else {\n          // Multiple organizations - show selection page\n          router.push('/organizations')\n        }\n      } catch (orgError) {\n        console.error('Failed to fetch organisations:', orgError)\n        // Fallback if org fetch fails\n        router.push('/organizations')\n      }\n    } catch (error: any) {\n      console.error('Signup failed:', error)\n      throw new Error(error.response?.data?.detail || 'Signup failed')\n    }\n  }\n\n  const logout = () => {\n    localStorage.removeItem('access_token')\n    localStorage.removeItem('refresh_token')\n    localStorage.removeItem('current_organisation')\n    localStorage.removeItem('current_project')\n    setUser(null)\n    router.push('/auth/signin')\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, loading, login, signup, logout, checkAuth }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 321, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/providers.tsx"],"sourcesContent":["'use client'\n\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query'\nimport { ThemeProvider } from 'next-themes'\nimport { Toaster } from 'sonner'\nimport { useState } from 'react'\nimport { AuthProvider } from '@/lib/auth-context'\n\nexport function Providers({ children }: { children: React.ReactNode }) {\n  const [queryClient] = useState(() => new QueryClient({\n    defaultOptions: {\n      queries: {\n        staleTime: 60 * 1000, // 1 minute\n        refetchOnWindowFocus: false,\n      },\n    },\n  }))\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider attribute=\"class\" defaultTheme=\"light\" enableSystem={false} forcedTheme=\"light\">\n        <AuthProvider>\n          {children}\n          <Toaster position=\"top-right\" richColors />\n        </AuthProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAQO,SAAS,UAAU,EAAE,QAAQ,EAAiC;IACnE,MAAM,CAAC,YAAY,GAAG,IAAA,iNAAQ,EAAC,IAAM,IAAI,4LAAW,CAAC;YACnD,gBAAgB;gBACd,SAAS;oBACP,WAAW,KAAK;oBAChB,sBAAsB;gBACxB;YACF;QACF;IAEA,qBACE,8OAAC,6MAAmB;QAAC,QAAQ;kBAC3B,cAAA,8OAAC,iKAAa;YAAC,WAAU;YAAQ,cAAa;YAAQ,cAAc;YAAO,aAAY;sBACrF,cAAA,8OAAC,mJAAY;;oBACV;kCACD,8OAAC,mJAAO;wBAAC,UAAS;wBAAY,UAAU;;;;;;;;;;;;;;;;;;;;;;AAKlD","debugId":null}}]
}