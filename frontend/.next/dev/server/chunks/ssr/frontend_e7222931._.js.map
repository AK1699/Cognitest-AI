{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sKAAO,EAAC,IAAA,6IAAI,EAAC;AACtB","debugId":null}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  'inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50',\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-destructive-foreground hover:bg-destructive/90',\n        outline:\n          'border border-input bg-background hover:bg-accent hover:text-accent-foreground',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost: 'hover:bg-accent hover:text-accent-foreground',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-10 px-4 py-2',\n        sm: 'h-9 rounded-md px-3',\n        lg: 'h-11 rounded-md px-8',\n        icon: 'h-10 w-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : 'button'\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = 'Button'\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;;;;;;AAEA,MAAM,iBAAiB,IAAA,uKAAG,EACxB,0RACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,mNAAgB,CAC7B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,wKAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,IAAA,8HAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/date-utils.ts"],"sourcesContent":["/**\n * Date formatting utilities for consistent date display across the application\n */\n\n/**\n * Format date to human-readable format: \"01 Nov 2025\"\n * @param date - Date string or Date object\n * @returns Formatted date string (e.g., \"01 Nov 2025\")\n */\nexport function formatDateHumanReadable(date: string | Date): string {\n  try {\n    const dateObj = typeof date === 'string' ? new Date(date) : date\n\n    if (isNaN(dateObj.getTime())) {\n      return 'Invalid date'\n    }\n\n    const day = String(dateObj.getDate()).padStart(2, '0')\n    const month = dateObj.toLocaleString('en-US', { month: 'short' }).charAt(0).toUpperCase() + dateObj.toLocaleString('en-US', { month: 'short' }).slice(1)\n    const year = dateObj.getFullYear()\n\n    return `${day} ${month} ${year}`\n  } catch (error) {\n    console.error('Error formatting date:', error)\n    return 'Invalid date'\n  }\n}\n\n/**\n * Format date with time: \"01 Nov 2025, 10:30 AM\"\n * @param date - Date string or Date object\n * @returns Formatted date and time string\n */\nexport function formatDateWithTime(date: string | Date): string {\n  try {\n    const dateObj = typeof date === 'string' ? new Date(date) : date\n\n    if (isNaN(dateObj.getTime())) {\n      return 'Invalid date'\n    }\n\n    const day = String(dateObj.getDate()).padStart(2, '0')\n    const month = dateObj.toLocaleString('en-US', { month: 'short' }).charAt(0).toUpperCase() + dateObj.toLocaleString('en-US', { month: 'short' }).slice(1)\n    const year = dateObj.getFullYear()\n    const time = dateObj.toLocaleString('en-US', {\n      hour: '2-digit',\n      minute: '2-digit',\n      hour12: true,\n    })\n\n    return `${day} ${month} ${year}, ${time}`\n  } catch (error) {\n    console.error('Error formatting date with time:', error)\n    return 'Invalid date'\n  }\n}\n\n/**\n * Format relative time: \"2 days ago\", \"3 minutes ago\"\n * @param date - Date string or Date object\n * @returns Relative time string\n */\nexport function formatRelativeTime(date: string | Date): string {\n  try {\n    const dateObj = typeof date === 'string' ? new Date(date) : date\n\n    if (isNaN(dateObj.getTime())) {\n      return 'Invalid date'\n    }\n\n    const now = new Date()\n    const diffMs = now.getTime() - dateObj.getTime()\n    const diffSecs = Math.floor(diffMs / 1000)\n    const diffMins = Math.floor(diffSecs / 60)\n    const diffHours = Math.floor(diffMins / 60)\n    const diffDays = Math.floor(diffHours / 24)\n    const diffWeeks = Math.floor(diffDays / 7)\n    const diffMonths = Math.floor(diffDays / 30)\n    const diffYears = Math.floor(diffDays / 365)\n\n    if (diffSecs < 60) return 'just now'\n    if (diffMins < 60) return `${diffMins} minute${diffMins > 1 ? 's' : ''} ago`\n    if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`\n    if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`\n    if (diffWeeks < 4) return `${diffWeeks} week${diffWeeks > 1 ? 's' : ''} ago`\n    if (diffMonths < 12) return `${diffMonths} month${diffMonths > 1 ? 's' : ''} ago`\n    return `${diffYears} year${diffYears > 1 ? 's' : ''} ago`\n  } catch (error) {\n    console.error('Error formatting relative time:', error)\n    return 'Invalid date'\n  }\n}\n\n/**\n * Format date for API/database: \"2025-01-01\"\n * @param date - Date object or string\n * @returns ISO date string (YYYY-MM-DD)\n */\nexport function formatDateForAPI(date: string | Date): string {\n  try {\n    const dateObj = typeof date === 'string' ? new Date(date) : date\n\n    if (isNaN(dateObj.getTime())) {\n      return ''\n    }\n\n    return dateObj.toISOString().split('T')[0]\n  } catch (error) {\n    console.error('Error formatting date for API:', error)\n    return ''\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 181, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/role-display-utils.ts"],"sourcesContent":["/**\n * Centralized utility for role display names and type mappings\n * This ensures consistency across all UI components when displaying roles\n */\n\nexport interface RoleDisplayInfo {\n  displayName: string\n  type: string\n  description: string\n}\n\n/**\n * Map from role_type to display information\n * This is the single source of truth for how roles are displayed throughout the application\n */\nexport const ROLE_DISPLAY_MAP: Record<string, RoleDisplayInfo> = {\n  owner: {\n    displayName: 'Owner',\n    type: 'Super Administrator',\n    description: 'Has full control â€” can manage billing, delete the organization, assign roles, and configure SSO'\n  },\n  admin: {\n    displayName: 'Admin',\n    type: 'Administration',\n    description: 'Manages organization settings, users, integrations, and platform operations'\n  },\n  qa_manager: {\n    displayName: 'QA Manager',\n    type: 'Quality Assurance',\n    description: 'Manages QA teams, assigns testers, oversees test execution, and reviews results'\n  },\n  qa_lead: {\n    displayName: 'QA Lead',\n    type: 'Quality Assurance',\n    description: 'Leads QA engineers, approves test cases, and validates AI-generated fixes'\n  },\n  qa_engineer: {\n    displayName: 'QA Engineer',\n    type: 'Quality Assurance',\n    description: 'Creates, executes, and maintains automated and manual tests'\n  },\n  product_owner: {\n    displayName: 'Product Owner',\n    type: 'Stakeholder',\n    description: 'Represents business interests, reviews reports and KPIs, ensures testing aligns with product goals'\n  },\n  viewer: {\n    displayName: 'Viewer',\n    type: 'Read Only',\n    description: 'Has view-only access to dashboards, reports, and analytics'\n  }\n}\n\n/**\n * Get display name for a role type\n * Example: 'qa_engineer' -> 'QA Engineer (Tester)'\n */\nexport function getRoleDisplayName(roleType: string): string {\n  const info = ROLE_DISPLAY_MAP[roleType.toLowerCase()]\n  if (info) {\n    return info.displayName\n  }\n  // Fallback for unknown types\n  return roleType.replace(/_/g, ' ').split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')\n}\n\n/**\n * Get type/category for a role type\n * Example: 'qa_engineer' -> 'Quality Assurance'\n */\nexport function getRoleType(roleType: string): string {\n  const info = ROLE_DISPLAY_MAP[roleType.toLowerCase()]\n  if (info) {\n    return info.type\n  }\n  return 'Unknown'\n}\n\n/**\n * Get description for a role type\n * Example: 'qa_engineer' -> 'Creates, executes, and maintains automated and manual tests'\n */\nexport function getRoleDescription(roleType: string): string {\n  const info = ROLE_DISPLAY_MAP[roleType.toLowerCase()]\n  if (info) {\n    return info.description\n  }\n  return ''\n}\n\n/**\n * Get display info with dropdown-friendly format\n * Example: 'qa_engineer' -> 'QA Engineer (Quality Assurance)'\n */\nexport function getRoleDisplayWithType(roleType: string): string {\n  const info = ROLE_DISPLAY_MAP[roleType.toLowerCase()]\n  if (info) {\n    return `${info.displayName} (${info.type})`\n  }\n  return getRoleDisplayName(roleType)\n}\n\n/**\n * Get all role display options for dropdown/select lists\n */\nexport function getAllRoleDisplayOptions() {\n  return Object.entries(ROLE_DISPLAY_MAP).map(([roleType, info]) => ({\n    roleType,\n    displayName: info.displayName,\n    type: info.type,\n    description: info.description,\n    displayWithType: `${info.displayName} (${info.type})`\n  }))\n}\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;;;;;AAYM,MAAM,mBAAoD;IAC/D,OAAO;QACL,aAAa;QACb,MAAM;QACN,aAAa;IACf;IACA,OAAO;QACL,aAAa;QACb,MAAM;QACN,aAAa;IACf;IACA,YAAY;QACV,aAAa;QACb,MAAM;QACN,aAAa;IACf;IACA,SAAS;QACP,aAAa;QACb,MAAM;QACN,aAAa;IACf;IACA,aAAa;QACX,aAAa;QACb,MAAM;QACN,aAAa;IACf;IACA,eAAe;QACb,aAAa;QACb,MAAM;QACN,aAAa;IACf;IACA,QAAQ;QACN,aAAa;QACb,MAAM;QACN,aAAa;IACf;AACF;AAMO,SAAS,mBAAmB,QAAgB;IACjD,MAAM,OAAO,gBAAgB,CAAC,SAAS,WAAW,GAAG;IACrD,IAAI,MAAM;QACR,OAAO,KAAK,WAAW;IACzB;IACA,6BAA6B;IAC7B,OAAO,SAAS,OAAO,CAAC,MAAM,KAAK,KAAK,CAAC,KAAK,GAAG,CAAC,CAAA,OAAQ,KAAK,MAAM,CAAC,GAAG,WAAW,KAAK,KAAK,KAAK,CAAC,IAAI,IAAI,CAAC;AAC/G;AAMO,SAAS,YAAY,QAAgB;IAC1C,MAAM,OAAO,gBAAgB,CAAC,SAAS,WAAW,GAAG;IACrD,IAAI,MAAM;QACR,OAAO,KAAK,IAAI;IAClB;IACA,OAAO;AACT;AAMO,SAAS,mBAAmB,QAAgB;IACjD,MAAM,OAAO,gBAAgB,CAAC,SAAS,WAAW,GAAG;IACrD,IAAI,MAAM;QACR,OAAO,KAAK,WAAW;IACzB;IACA,OAAO;AACT;AAMO,SAAS,uBAAuB,QAAgB;IACrD,MAAM,OAAO,gBAAgB,CAAC,SAAS,WAAW,GAAG;IACrD,IAAI,MAAM;QACR,OAAO,GAAG,KAAK,WAAW,CAAC,EAAE,EAAE,KAAK,IAAI,CAAC,CAAC,CAAC;IAC7C;IACA,OAAO,mBAAmB;AAC5B;AAKO,SAAS;IACd,OAAO,OAAO,OAAO,CAAC,kBAAkB,GAAG,CAAC,CAAC,CAAC,UAAU,KAAK,GAAK,CAAC;YACjE;YACA,aAAa,KAAK,WAAW;YAC7B,MAAM,KAAK,IAAI;YACf,aAAa,KAAK,WAAW;YAC7B,iBAAiB,GAAG,KAAK,WAAW,CAAC,EAAE,EAAE,KAAK,IAAI,CAAC,CAAC,CAAC;QACvD,CAAC;AACH","debugId":null}},
    {"offset": {"line": 277, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/layout/sidebar.tsx"],"sourcesContent":["'use client'\n\nimport Link from 'next/link'\nimport { usePathname } from 'next/navigation'\nimport {\n  LayoutDashboard,\n  ClipboardList,\n  Code,\n  Shield,\n  Zap,\n  Workflow,\n  ChevronLeft,\n  Menu,\n  FolderOpen,\n  BarChart3,\n  CreditCard,\n  Users,\n  Puzzle,\n  ChevronDown,\n  Building2,\n  Plus,\n  User,\n  Settings,\n  HelpCircle,\n  LogOut,\n  Check\n} from 'lucide-react'\nimport { useState, useEffect } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { useAuth } from '@/lib/auth-context'\nimport api from '@/lib/api'\nimport { toast } from 'sonner'\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000'\n\ninterface SidebarProps {\n  organisationId?: string\n  projectId?: string\n}\n\nconst getMainMenuItems = (organisationId?: string, isOwner?: boolean) => {\n  const allItems = [\n    {\n      name: 'Projects',\n      href: organisationId ? `/organizations/${organisationId}/projects` : '/projects',\n      icon: FolderOpen,\n      iconColor: 'text-blue-600',\n      bgColor: 'bg-blue-100',\n      allowMember: true, // Members can see this\n    },\n    {\n      name: 'Enterprise Reporting',\n      href: organisationId ? `/organizations/${organisationId}/enterprise-reporting` : '/enterprise-reporting',\n      icon: BarChart3,\n      iconColor: 'text-purple-600',\n      bgColor: 'bg-purple-100',\n      allowMember: false, // Only owners\n    },\n    {\n      name: 'Billing & Usage',\n      href: organisationId ? `/organizations/${organisationId}/billing` : '/billing',\n      icon: CreditCard,\n      iconColor: 'text-green-600',\n      bgColor: 'bg-green-100',\n      allowMember: false, // Only owners\n    },\n    {\n      name: 'Users & Teams',\n      href: organisationId ? `/organizations/${organisationId}/users-teams` : '/users-teams',\n      icon: Users,\n      iconColor: 'text-orange-600',\n      bgColor: 'bg-orange-100',\n      allowMember: false, // Only owners\n    },\n    {\n      name: 'Integrations',\n      href: organisationId ? `/organizations/${organisationId}/integrations` : '/integrations',\n      icon: Puzzle,\n      iconColor: 'text-pink-600',\n      bgColor: 'bg-pink-100',\n      allowMember: false, // Only owners\n    },\n    {\n      name: 'Settings',\n      href: organisationId ? `/organizations/${organisationId}/settings` : '/settings',\n      icon: Settings,\n      iconColor: 'text-gray-600',\n      bgColor: 'bg-gray-100',\n      allowMember: false, // Only owners\n    },\n  ]\n\n  // Filter items based on user role\n  if (isOwner) {\n    return allItems\n  } else {\n    // Members only see items where allowMember is true\n    return allItems.filter(item => item.allowMember)\n  }\n}\n\nconst otherMenuItems = []\n\ninterface Organisation {\n  id: string\n  name: string\n  website?: string\n  description?: string\n  owner_id: string\n  created_at: string\n  updated_at?: string\n}\n\nexport function Sidebar({ organisationId, projectId }: SidebarProps) {\n  const pathname = usePathname()\n  const router = useRouter()\n  const { user, logout } = useAuth()\n  const [isCollapsed, setIsCollapsed] = useState(false)\n  const [isMobileOpen, setIsMobileOpen] = useState(false)\n  const [currentOrganisation, setCurrentOrganisation] = useState<Organisation | null>(null)\n  const [organisations, setOrganisations] = useState<Organisation[]>([])\n  const [isProfileOpen, setIsProfileOpen] = useState(false)\n  const [isOwner, setIsOwner] = useState(false)\n\n  useEffect(() => {\n    const currentOrg = localStorage.getItem('current_organization')\n    if (currentOrg) {\n      try {\n        setCurrentOrganisation(JSON.parse(currentOrg))\n      } catch (error) {\n        console.error('Failed to parse organization from localStorage', error)\n      }\n    }\n    if (user) {\n      fetchOrganisations()\n    }\n  }, [user])\n\n  // Check if current user is the owner of the organization\n  useEffect(() => {\n    if (user && currentOrganisation) {\n      setIsOwner(currentOrganisation.owner_id === user.id)\n    }\n  }, [user, currentOrganisation])\n\n  const fetchOrganisations = async () => {\n    if (!user) return\n    try {\n      const response = await api.get('/api/v1/organisations/')\n      setOrganisations(response.data)\n    } catch (error) {\n      console.error('Failed to fetch organisations:', error)\n    }\n  }\n\n  const switchOrganisation = (org: Organisation) => {\n    setCurrentOrganisation(org)\n    localStorage.setItem('current_organization', JSON.stringify(org))\n    window.dispatchEvent(new CustomEvent('organisationChanged', { detail: org }))\n    setIsProfileOpen(false)\n    // Refetch organizations after switching\n    setTimeout(() => fetchOrganisations(), 100)\n    router.push(`/organizations/${org.id}/projects`)\n  }\n\n  return (\n    <>\n      {/* Mobile Menu Button */}\n      <button\n        onClick={() => setIsMobileOpen(!isMobileOpen)}\n        className=\"lg:hidden fixed top-4 left-4 z-50 p-2 bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-200 dark:border-gray-700\"\n      >\n        <Menu className=\"w-5 h-5 text-gray-600 dark:text-gray-400\" />\n      </button>\n\n      {/* Mobile Overlay */}\n      {isMobileOpen && (\n        <div\n          className=\"lg:hidden fixed inset-0 bg-black/50 z-40\"\n          onClick={() => setIsMobileOpen(false)}\n        />\n      )}\n\n      {/* Sidebar */}\n      <aside\n        className={`\n          fixed lg:sticky top-0 left-0 h-screen border-r border-gray-200 dark:border-gray-700 z-40 transition-all duration-300\n          ${isCollapsed ? 'lg:w-20' : 'lg:w-64'}\n          ${isMobileOpen ? 'translate-x-0 w-64' : '-translate-x-full lg:translate-x-0'}\n        `}\n        style={{\n          backgroundColor: '#f0fefa'\n        }}\n      >\n        <div className=\"flex flex-col h-full\">\n          {/* Profile Section */}\n          {!isCollapsed && user && currentOrganisation && (\n            <div className=\"p-4 relative\">\n              {/* Main Profile Button */}\n              <button\n                onClick={() => {\n                  setIsProfileOpen(!isProfileOpen)\n                  if (!isProfileOpen) {\n                    // Refetch organizations when opening the profile menu\n                    fetchOrganisations()\n                  }\n                }}\n                className={`w-full flex items-center gap-3 p-3 rounded-xl transition-all ${\n                  isProfileOpen\n                    ? 'border-2 border-gray-400 bg-white/40 shadow-lg'\n                    : 'border-2 border-gray-300 hover:bg-white/20'\n                }`}\n              >\n                <div className=\"w-10 h-10 rounded-full bg-primary flex items-center justify-center flex-shrink-0\">\n                  <span className=\"text-sm font-semibold text-white\">\n                    {currentOrganisation.name.substring(0, 2).toUpperCase()}\n                  </span>\n                </div>\n                <div className=\"flex-1 min-w-0 text-left\">\n                  <p className=\"text-sm font-semibold text-gray-800 leading-tight line-clamp-1\">\n                    {currentOrganisation.name}\n                  </p>\n                  <p className=\"text-xs text-gray-600 uppercase tracking-wide mt-0.5\">\n                    {user.username}\n                  </p>\n                </div>\n                <ChevronDown\n                  className={`w-4 h-4 text-gray-600 flex-shrink-0 transition-transform ${\n                    isProfileOpen ? 'rotate-180' : ''\n                  }`}\n                />\n              </button>\n\n              {/* Profile Dropdown Details - Overlay */}\n              {isProfileOpen && (\n                <div className=\"absolute top-24 left-4 right-4 p-4 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-lg space-y-4 z-50\">\n                  {/* Organisations Section */}\n                  <div className=\"space-y-2\">\n                    <h3 className=\"text-sm font-semibold text-gray-600 dark:text-gray-400\">\n                      Organisations ({organisations.length})\n                    </h3>\n                    <div className=\"space-y-2 max-h-40 overflow-y-auto\">\n                      {organisations.map((org) => (\n                        <button\n                          key={org.id}\n                          onClick={() => switchOrganisation(org)}\n                          className=\"w-full flex items-center gap-2 p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-left\"\n                        >\n                          <Building2 className=\"w-4 h-4 text-gray-600 dark:text-gray-400 flex-shrink-0\" />\n                          <span className=\"text-sm text-gray-900 dark:text-white flex-1 truncate\">\n                            {org.name}\n                          </span>\n                          {currentOrganisation?.id === org.id && (\n                            <Check className=\"w-4 h-4 text-primary flex-shrink-0\" />\n                          )}\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n\n                  {/* Add Organisation - Only show for owners */}\n                  {isOwner && (\n                    <>\n                      <hr className=\"border-gray-200 dark:border-gray-700\" />\n                      <button\n                        onClick={() => {\n                          router.push('/organizations/new')\n                          setIsProfileOpen(false)\n                        }}\n                        className=\"w-full flex items-center gap-3 p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-left\"\n                      >\n                        <Plus className=\"w-4 h-4 text-gray-600 dark:text-gray-400\" />\n                        <span className=\"text-sm text-gray-900 dark:text-white\">Add Organisation</span>\n                      </button>\n                    </>\n                  )}\n\n                  <hr className=\"border-gray-200 dark:border-gray-700\" />\n\n                  {/* Edit Profile */}\n                  <button\n                    onClick={() => {\n                      router.push('/profile/edit')\n                      setIsProfileOpen(false)\n                    }}\n                    className=\"w-full flex items-center gap-3 p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-left\"\n                  >\n                    <User className=\"w-4 h-4 text-gray-600 dark:text-gray-400\" />\n                    <span className=\"text-sm text-gray-900 dark:text-white\">Edit profile</span>\n                  </button>\n\n                  {/* Account Settings */}\n                  <button\n                    onClick={() => {\n                      router.push('/account/settings')\n                      setIsProfileOpen(false)\n                    }}\n                    className=\"w-full flex items-center gap-3 p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-left\"\n                  >\n                    <Settings className=\"w-4 h-4 text-gray-600 dark:text-gray-400\" />\n                    <span className=\"text-sm text-gray-900 dark:text-white\">Account settings</span>\n                  </button>\n\n                  {/* Support */}\n                  <button\n                    onClick={() => {\n                      router.push('/support')\n                      setIsProfileOpen(false)\n                    }}\n                    className=\"w-full flex items-center gap-3 p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-left\"\n                  >\n                    <HelpCircle className=\"w-4 h-4 text-gray-600 dark:text-gray-400\" />\n                    <span className=\"text-sm text-gray-900 dark:text-white\">Support</span>\n                  </button>\n\n                  <hr className=\"border-gray-200 dark:border-gray-700\" />\n\n                  {/* Sign Out */}\n                  <button\n                    onClick={() => {\n                      logout()\n                      setIsProfileOpen(false)\n                    }}\n                    className=\"w-full flex items-center gap-3 p-2 rounded-md hover:bg-red-100 dark:hover:bg-red-900/20 transition-colors text-left\"\n                  >\n                    <LogOut className=\"w-4 h-4 text-red-600 dark:text-red-400\" />\n                    <span className=\"text-sm text-red-600 dark:text-red-400 font-medium\">Sign out</span>\n                  </button>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Close profile dropdown when clicking outside */}\n          {isProfileOpen && (\n            <div\n              className=\"fixed inset-0 z-40\"\n              onClick={() => setIsProfileOpen(false)}\n            />\n          )}\n\n          {/* Navigation */}\n          <nav className=\"flex-1 overflow-y-auto py-6 px-3\">\n            <div className=\"space-y-1 mb-6\">\n              {getMainMenuItems(currentOrganisation?.id, isOwner).map((item) => {\n                const isActive = pathname === item.href\n                const Icon = item.icon\n\n                return (\n                  <Link\n                    key={item.name}\n                    href={item.href}\n                    onClick={() => setIsMobileOpen(false)}\n                    className={`\n                      flex items-center gap-3 px-4 py-3 rounded-xl transition-all group\n                      ${\n                        isActive\n                          ? `${item.bgColor} text-gray-900 shadow-lg border-2 border-gray-400`\n                          : 'text-gray-700 hover:bg-white/30 border-2 border-transparent'\n                      }\n                      ${isCollapsed ? 'justify-center' : ''}\n                    `}\n                  >\n                    <Icon\n                      className={`w-5 h-5 flex-shrink-0 ${item.iconColor}`}\n                    />\n                    {!isCollapsed && (\n                      <span className=\"font-medium text-sm\">{item.name}</span>\n                    )}\n                  </Link>\n                )\n              })}\n            </div>\n\n          </nav>\n\n          {/* Footer - Project Info */}\n          {!isCollapsed && projectId && (\n            <div className=\"p-4 border-t border-gray-300\">\n              <div className=\"text-xs text-gray-600 mb-1\">\n                Current Project\n              </div>\n              <div className=\"text-sm font-medium text-gray-800 truncate\">\n                Project Name\n              </div>\n            </div>\n          )}\n        </div>\n      </aside>\n    </>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 867, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/axios.ts"],"sourcesContent":["import axios from 'axios'\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000'\n\n// Create axios instance\nconst api = axios.create({\n  baseURL: API_URL,\n  withCredentials: true,\n})\n\n// Request interceptor - cookies are automatically sent via withCredentials: true\napi.interceptors.request.use(\n  (config) => {\n    // With httpOnly cookies, authorization is handled automatically\n    // No need to manually add Bearer token\n    return config\n  },\n  (error) => Promise.reject(error)\n)\n\n// Add response interceptor to handle token refresh\napi.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config\n\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true\n\n      try {\n        // Try to refresh the token using httpOnly cookies\n        // The refresh endpoint will use the httpOnly refresh_token cookie automatically\n        const response = await axios.post(`${API_URL}/api/v1/auth/refresh`, {}, {\n          withCredentials: true,\n        })\n\n        // The server will set new httpOnly cookies automatically\n        // Just retry the original request\n        return api(originalRequest)\n      } catch (refreshError) {\n        // Refresh failed, redirect to login only if not already on signin page\n        // httpOnly cookies are managed by the server\n        // Clear any stale localStorage tokens for backward compatibility\n        if (localStorage.getItem('access_token')) {\n          localStorage.removeItem('access_token')\n        }\n        if (localStorage.getItem('refresh_token')) {\n          localStorage.removeItem('refresh_token')\n        }\n\n        // Only redirect if we're not already on the signin page\n        if (typeof window !== 'undefined' && !window.location.pathname.includes('/auth/signin')) {\n          window.location.href = '/auth/signin'\n        }\n        return Promise.reject(refreshError)\n      }\n    }\n\n    return Promise.reject(error)\n  }\n)\n\nexport default api\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,UAAU,6DAAmC;AAEnD,wBAAwB;AACxB,MAAM,MAAM,gJAAK,CAAC,MAAM,CAAC;IACvB,SAAS;IACT,iBAAiB;AACnB;AAEA,iFAAiF;AACjF,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAC1B,CAAC;IACC,gEAAgE;IAChE,uCAAuC;IACvC,OAAO;AACT,GACA,CAAC,QAAU,QAAQ,MAAM,CAAC;AAG5B,mDAAmD;AACnD,IAAI,YAAY,CAAC,QAAQ,CAAC,GAAG,CAC3B,CAAC,WAAa,UACd,OAAO;IACL,MAAM,kBAAkB,MAAM,MAAM;IAEpC,IAAI,MAAM,QAAQ,EAAE,WAAW,OAAO,CAAC,gBAAgB,MAAM,EAAE;QAC7D,gBAAgB,MAAM,GAAG;QAEzB,IAAI;YACF,kDAAkD;YAClD,gFAAgF;YAChF,MAAM,WAAW,MAAM,gJAAK,CAAC,IAAI,CAAC,GAAG,QAAQ,oBAAoB,CAAC,EAAE,CAAC,GAAG;gBACtE,iBAAiB;YACnB;YAEA,yDAAyD;YACzD,kCAAkC;YAClC,OAAO,IAAI;QACb,EAAE,OAAO,cAAc;YACrB,uEAAuE;YACvE,6CAA6C;YAC7C,iEAAiE;YACjE,IAAI,aAAa,OAAO,CAAC,iBAAiB;gBACxC,aAAa,UAAU,CAAC;YAC1B;YACA,IAAI,aAAa,OAAO,CAAC,kBAAkB;gBACzC,aAAa,UAAU,CAAC;YAC1B;YAEA,wDAAwD;YACxD,IAAI,kDAAkB,eAAe,CAAC,OAAO,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC;;YAGxE,OAAO,QAAQ,MAAM,CAAC;QACxB;IACF;IAEA,OAAO,QAAQ,MAAM,CAAC;AACxB;uCAGa","debugId":null}},
    {"offset": {"line": 922, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/api/roles.ts"],"sourcesContent":["import axios from '@/lib/axios'\n\nexport interface Permission {\n  id: string\n  name: string\n  description?: string\n  resource: string\n  action: string\n}\n\nexport interface ProjectRole {\n  id: string\n  name: string\n  description?: string\n  role_type: string\n  organisation_id: string\n  is_system_role: boolean\n  is_active: boolean\n  created_at: string\n  updated_at?: string\n}\n\nexport interface UserProjectRoleWithDetails {\n  id: string\n  user_id: string\n  role_id: string\n  project_id: string\n  role: ProjectRole\n  user?: {\n    username: string\n    email: string\n  }\n}\n\nexport interface GroupProjectRoleWithDetails {\n  id: string\n  group_id: string\n  role_id: string\n  project_id: string\n  role: ProjectRole\n  group?: {\n    name: string\n  }\n}\n\nexport async function listRoles(organisationId: string): Promise<{ roles: ProjectRole[] }> {\n  const response = await axios.get(`/api/v1/roles/`, {\n    params: { organisation_id: organisationId }\n  })\n  return response.data\n}\n\nexport async function listUserRoles(userId: string, projectId: string): Promise<UserProjectRoleWithDetails[]> {\n  const response = await axios.get(`/api/v1/roles/assignments/users`, {\n    params: { user_id: userId, project_id: projectId }\n  })\n  return response.data.assignments || []\n}\n\nexport async function listGroupRoles(groupId: string, projectId: string): Promise<GroupProjectRoleWithDetails[]> {\n  const response = await axios.get(`/api/v1/roles/assignments/groups`, {\n    params: { group_id: groupId, project_id: projectId }\n  })\n  return response.data.assignments || []\n}\n\nexport async function assignRoleToUser(\n  userId: string,\n  roleId: string,\n  projectId: string\n): Promise<UserProjectRoleWithDetails> {\n  const response = await axios.post('/api/v1/roles/assignments/users', {\n    user_id: userId,\n    role_id: roleId,\n    project_id: projectId\n  })\n  return response.data\n}\n\nexport async function assignRoleToGroup(\n  groupId: string,\n  roleId: string,\n  projectId: string\n): Promise<GroupProjectRoleWithDetails> {\n  const response = await axios.post('/api/v1/roles/assignments/groups', {\n    group_id: groupId,\n    role_id: roleId,\n    project_id: projectId\n  })\n  return response.data\n}\n\nexport async function removeRoleFromUser(assignmentId: string): Promise<void> {\n  await axios.delete(`/api/v1/roles/assignments/users/${assignmentId}`)\n}\n\nexport async function removeRoleFromGroup(assignmentId: string): Promise<void> {\n  await axios.delete(`/api/v1/roles/assignments/groups/${assignmentId}`)\n}\n\nexport async function createRole(\n  organisationId: string,\n  name: string,\n  roleType: string,\n  description?: string,\n  permissions?: string[]\n): Promise<ProjectRole> {\n  const response = await axios.post('/api/v1/roles/', {\n    organisation_id: organisationId,\n    name,\n    role_type: roleType,\n    description,\n    permissions: permissions || []\n  })\n  return response.data\n}\n\nexport async function deleteRole(roleId: string): Promise<void> {\n  await axios.delete(`/api/v1/roles/${roleId}`)\n}\n\nexport async function listPermissions(): Promise<Permission[]> {\n  const response = await axios.get('/api/v1/roles/permissions')\n  return response.data.permissions || []\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;;AA6CO,eAAe,UAAU,cAAsB;IACpD,MAAM,WAAW,MAAM,mIAAK,CAAC,GAAG,CAAC,CAAC,cAAc,CAAC,EAAE;QACjD,QAAQ;YAAE,iBAAiB;QAAe;IAC5C;IACA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,cAAc,MAAc,EAAE,SAAiB;IACnE,MAAM,WAAW,MAAM,mIAAK,CAAC,GAAG,CAAC,CAAC,+BAA+B,CAAC,EAAE;QAClE,QAAQ;YAAE,SAAS;YAAQ,YAAY;QAAU;IACnD;IACA,OAAO,SAAS,IAAI,CAAC,WAAW,IAAI,EAAE;AACxC;AAEO,eAAe,eAAe,OAAe,EAAE,SAAiB;IACrE,MAAM,WAAW,MAAM,mIAAK,CAAC,GAAG,CAAC,CAAC,gCAAgC,CAAC,EAAE;QACnE,QAAQ;YAAE,UAAU;YAAS,YAAY;QAAU;IACrD;IACA,OAAO,SAAS,IAAI,CAAC,WAAW,IAAI,EAAE;AACxC;AAEO,eAAe,iBACpB,MAAc,EACd,MAAc,EACd,SAAiB;IAEjB,MAAM,WAAW,MAAM,mIAAK,CAAC,IAAI,CAAC,mCAAmC;QACnE,SAAS;QACT,SAAS;QACT,YAAY;IACd;IACA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBACpB,OAAe,EACf,MAAc,EACd,SAAiB;IAEjB,MAAM,WAAW,MAAM,mIAAK,CAAC,IAAI,CAAC,oCAAoC;QACpE,UAAU;QACV,SAAS;QACT,YAAY;IACd;IACA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,mBAAmB,YAAoB;IAC3D,MAAM,mIAAK,CAAC,MAAM,CAAC,CAAC,gCAAgC,EAAE,cAAc;AACtE;AAEO,eAAe,oBAAoB,YAAoB;IAC5D,MAAM,mIAAK,CAAC,MAAM,CAAC,CAAC,iCAAiC,EAAE,cAAc;AACvE;AAEO,eAAe,WACpB,cAAsB,EACtB,IAAY,EACZ,QAAgB,EAChB,WAAoB,EACpB,WAAsB;IAEtB,MAAM,WAAW,MAAM,mIAAK,CAAC,IAAI,CAAC,kBAAkB;QAClD,iBAAiB;QACjB;QACA,WAAW;QACX;QACA,aAAa,eAAe,EAAE;IAChC;IACA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,WAAW,MAAc;IAC7C,MAAM,mIAAK,CAAC,MAAM,CAAC,CAAC,cAAc,EAAE,QAAQ;AAC9C;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM,mIAAK,CAAC,GAAG,CAAC;IACjC,OAAO,SAAS,IAAI,CAAC,WAAW,IAAI,EAAE;AACxC","debugId":null}},
    {"offset": {"line": 1015, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/api/users.ts"],"sourcesContent":["import api from './index'\n\nexport interface User {\n  id: string\n  username: string\n  email: string\n  full_name?: string\n  is_active: boolean\n  created_at: string\n  updated_at?: string\n}\n\nexport async function listOrganisationUsers(organisationId: string): Promise<User[]> {\n  const response = await api.get(`/api/v1/organisations/${organisationId}/users`)\n  return response.data\n}\n\nexport async function getUserById(userId: string): Promise<User> {\n  const response = await api.get(`/api/v1/users/${userId}`)\n  return response.data\n}\n\nexport async function updateUser(userId: string, data: Partial<User>): Promise<User> {\n  const response = await api.put(`/api/v1/users/${userId}`, data)\n  return response.data\n}\n\nexport async function deleteUser(userId: string): Promise<void> {\n  await api.delete(`/api/v1/users/${userId}`)\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAYO,eAAe,sBAAsB,cAAsB;IAChE,MAAM,WAAW,MAAM,0IAAG,CAAC,GAAG,CAAC,CAAC,sBAAsB,EAAE,eAAe,MAAM,CAAC;IAC9E,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,YAAY,MAAc;IAC9C,MAAM,WAAW,MAAM,0IAAG,CAAC,GAAG,CAAC,CAAC,cAAc,EAAE,QAAQ;IACxD,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,WAAW,MAAc,EAAE,IAAmB;IAClE,MAAM,WAAW,MAAM,0IAAG,CAAC,GAAG,CAAC,CAAC,cAAc,EAAE,QAAQ,EAAE;IAC1D,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,WAAW,MAAc;IAC7C,MAAM,0IAAG,CAAC,MAAM,CAAC,CAAC,cAAc,EAAE,QAAQ;AAC5C","debugId":null}},
    {"offset": {"line": 1046, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/roles/role-assignment-modal.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { X, Shield, Trash2, Plus, AlertCircle } from 'lucide-react'\nimport { toast } from 'sonner'\nimport { formatDateHumanReadable } from '@/lib/date-utils'\nimport { getRoleDisplayWithType } from '@/lib/role-display-utils'\nimport {\n  listRoles,\n  listUserRoles,\n  listGroupRoles,\n  assignRoleToUser,\n  assignRoleToGroup,\n  removeRoleFromUser,\n  removeRoleFromGroup,\n  type ProjectRole,\n  type UserProjectRoleWithDetails,\n  type GroupProjectRoleWithDetails\n} from '@/lib/api/roles'\n\ninterface RoleAssignmentModalProps {\n  isOpen: boolean\n  onClose: () => void\n  organisationId: string\n  projectId?: string\n  entityType: 'user' | 'group'\n  entityId: string\n  entityName: string\n  availableProjects?: Array<{ id: string; name: string }>\n  initialRoleId?: string\n  onRoleAssigned?: () => void | Promise<void>\n  onModalOpen?: () => void | Promise<void>\n}\n\nexport function RoleAssignmentModal({\n  isOpen,\n  onClose,\n  organisationId,\n  projectId: initialProjectId,\n  entityType,\n  entityId,\n  entityName,\n  availableProjects = [],\n  initialRoleId,\n  onRoleAssigned,\n  onModalOpen\n}: RoleAssignmentModalProps) {\n  const [loading, setLoading] = useState(false)\n  const [roles, setRoles] = useState<ProjectRole[]>([])\n  const [currentRoles, setCurrentRoles] = useState<(UserProjectRoleWithDetails | GroupProjectRoleWithDetails)[]>([])\n  const [selectedProjectId, setSelectedProjectId] = useState<string>(initialProjectId || '')\n  const [filterProjectId, setFilterProjectId] = useState<string>(initialProjectId || '')\n  const [selectedRoleId, setSelectedRoleId] = useState<string>('')\n  const [showAddRole, setShowAddRole] = useState(false)\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState(false)\n  const [deleteTargetId, setDeleteTargetId] = useState<string>('')\n\n  // Fetch roles on modal open (independent of project selection)\n  useEffect(() => {\n    if (isOpen) {\n      // Call parent callback to refresh projects/data if needed\n      if (onModalOpen) {\n        onModalOpen()\n      }\n      fetchRoles()\n      fetchAllUserRoles() // Fetch all roles for this user across all projects\n      // Set initial role if provided\n      if (initialRoleId) {\n        setSelectedRoleId(initialRoleId)\n      }\n    }\n  }, [isOpen, organisationId, initialRoleId])\n\n  // Fetch current assignments when filter project changes\n  useEffect(() => {\n    if (isOpen && filterProjectId) {\n      fetchCurrentRoles()\n    }\n  }, [filterProjectId, entityId])\n\n  // Fetch all roles for this user across all projects\n  const fetchAllUserRoles = async () => {\n    try {\n      // Fetch from all projects to see where user already has roles\n      if (entityType === 'user' && availableProjects.length > 0) {\n        let allRoles: (UserProjectRoleWithDetails | GroupProjectRoleWithDetails)[] = []\n\n        for (const project of availableProjects) {\n          try {\n            const userRolesData = await listUserRoles(entityId, project.id)\n            allRoles = [...allRoles, ...userRolesData]\n          } catch (e) {\n            // Project might not have any roles for this user\n          }\n        }\n\n        setCurrentRoles(allRoles)\n      }\n    } catch (error: any) {\n      console.error('Error fetching all user roles:', error)\n    }\n  }\n\n  const fetchRoles = async () => {\n    setLoading(true)\n    try {\n      const rolesData = await listRoles(organisationId)\n      setRoles(rolesData.roles)\n    } catch (error: any) {\n      console.error('Error fetching roles:', error)\n      toast.error(error.message || 'Failed to load roles')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const fetchCurrentRoles = async () => {\n    if (!filterProjectId) return\n\n    try {\n      // Fetch current role assignments for the selected project\n      if (entityType === 'user') {\n        const userRolesData = await listUserRoles(entityId, filterProjectId)\n        setCurrentRoles(userRolesData)\n      } else {\n        const groupRolesData = await listGroupRoles(entityId, filterProjectId)\n        setCurrentRoles(groupRolesData)\n      }\n    } catch (error: any) {\n      console.error('Error fetching current roles:', error)\n      toast.error(error.message || 'Failed to load current roles')\n    }\n  }\n\n  const handleAssignRole = async () => {\n    const selectedRole = roles.find(r => r.id === selectedRoleId)\n    const isAdminRole = selectedRole?.role_type === 'administrator' || selectedRole?.role_type === 'owner' || selectedRole?.role_type === 'admin'\n\n    // Admin role only needs role selection\n    // Other roles require both role and project\n    if (!selectedRoleId) return\n    if (!isAdminRole && !selectedProjectId) return\n\n    try {\n      let projectToAssign = selectedProjectId\n\n      // Get list of projects where user already has roles\n      const projectsWithRoles = new Set(\n        currentRoles.map(role => {\n          // Extract project_id from currentRoles\n          return (role as any).project_id\n        })\n      )\n\n      // For admin role, if no project selected, find a project where user doesn't already have a role\n      if (isAdminRole && !projectToAssign && availableProjects.length > 0) {\n        // Find first project without a role assignment\n        const projectWithoutRole = availableProjects.find(\n          p => !projectsWithRoles.has(p.id)\n        )\n\n        if (projectWithoutRole) {\n          projectToAssign = projectWithoutRole.id\n        } else {\n          // All projects have roles, use the first one and suggest updating\n          projectToAssign = availableProjects[0].id\n          toast.warning('User already has roles in all projects. Attempting to assign as admin role (may need to remove existing role first).')\n        }\n      }\n\n      // For non-admin roles, check if selected project already has a role\n      if (!isAdminRole && selectedProjectId && projectsWithRoles.has(selectedProjectId)) {\n        // User already has a role on this project, try to find alternative\n        const projectWithoutRole = availableProjects.find(\n          p => !projectsWithRoles.has(p.id)\n        )\n\n        if (projectWithoutRole) {\n          // Auto-switch to project without role\n          projectToAssign = projectWithoutRole.id\n          toast.info(`User already has a role on \"${availableProjects.find(p => p.id === selectedProjectId)?.name || 'selected project'}\". Assigning to \"${projectWithoutRole.name}\" instead.`)\n        } else {\n          // All projects have roles for this user\n          toast.error('User already has a role on all projects. Please remove an existing role first, or assign an admin role for organization-wide access.')\n          return\n        }\n      }\n\n      if (!projectToAssign) {\n        toast.error('Please create a project first before assigning roles')\n        return\n      }\n\n      if (entityType === 'user') {\n        await assignRoleToUser(entityId, selectedRoleId, projectToAssign)\n      } else {\n        await assignRoleToGroup(entityId, selectedRoleId, projectToAssign)\n      }\n\n      toast.success('Role assigned successfully')\n      if (isAdminRole) {\n        toast.success('âœ… Admin user now has automatic access to all projects in this organization')\n      }\n      setSelectedRoleId('')\n      setSelectedProjectId('')\n      setShowAddRole(false)\n      // Refresh if viewing that project\n      if (filterProjectId === projectToAssign) {\n        await fetchCurrentRoles()\n      }\n      // Call parent callback to refresh data\n      if (onRoleAssigned) {\n        await onRoleAssigned()\n      }\n    } catch (error: any) {\n      toast.error(error.response?.data?.detail || error.message || 'Failed to assign role')\n    }\n  }\n\n  const handleRemoveRole = async (assignmentId: string) => {\n    setDeleteTargetId(assignmentId)\n    setShowDeleteConfirm(true)\n  }\n\n  const confirmRemoveRole = async () => {\n    if (!deleteTargetId) return\n\n    try {\n      if (entityType === 'user') {\n        await removeRoleFromUser(deleteTargetId)\n      } else {\n        await removeRoleFromGroup(deleteTargetId)\n      }\n\n      toast.success('Role removed successfully')\n      // Refresh roles after removal\n      await fetchAllUserRoles()\n      if (filterProjectId) {\n        await fetchCurrentRoles()\n      }\n      setShowDeleteConfirm(false)\n      setDeleteTargetId('')\n    } catch (error: any) {\n      toast.error(error.message || 'Failed to remove role')\n    }\n  }\n\n  const getRoleBadgeColor = (roleType: string) => {\n    switch (roleType) {\n      case 'owner':\n      case 'admin':\n      case 'administrator':\n        return 'bg-red-100 text-red-800 border-red-200'\n      case 'project_manager':\n        return 'bg-purple-100 text-purple-800 border-purple-200'\n      case 'developer':\n        return 'bg-blue-100 text-blue-800 border-blue-200'\n      case 'tester':\n      case 'qa_engineer':\n        return 'bg-green-100 text-green-800 border-green-200'\n      case 'viewer':\n      case 'product_owner':\n        return 'bg-gray-100 text-gray-800 border-gray-200'\n      default:\n        return 'bg-cyan-100 text-cyan-800 border-cyan-200'\n    }\n  }\n\n  const getRoleDisplayName = (roleType: string) => {\n    switch (roleType) {\n      case 'owner':\n        return 'Super Administrator'\n      case 'admin':\n        return 'Administrator'\n      case 'qa_manager':\n        return 'Quality Assurance'\n      case 'qa_lead':\n        return 'Quality Assurance'\n      case 'qa_engineer':\n        return 'Quality Assurance'\n      case 'product_owner':\n        return 'Stakeholder'\n      case 'viewer':\n        return 'Read Only'\n      default:\n        return roleType.replace(/_/g, ' ').split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ')\n    }\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n          <div className=\"flex items-center gap-3\">\n            <Shield className=\"w-6 h-6 text-primary\" />\n            <div>\n              <h2 className=\"text-xl font-bold text-gray-900 dark:text-white\">\n                Manage Roles - {entityName}\n              </h2>\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                Assign and manage roles for this {entityType}\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\n          >\n            <X className=\"w-5 h-5 text-gray-500\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto p-6 space-y-6\">\n          {loading ? (\n            <div className=\"flex items-center justify-center py-12\">\n              <div className=\"text-gray-500\">Loading roles...</div>\n            </div>\n          ) : (\n            <>\n              {/* Assign Role Section - Always Visible */}\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                  Assign Role\n                </h3>\n\n                <div className=\"space-y-4\">\n                  {/* Role Selection */}\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Select Role\n                    </label>\n                    <select\n                      value={selectedRoleId}\n                      onChange={(e) => setSelectedRoleId(e.target.value)}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                    >\n                      <option value=\"\">Choose a role...</option>\n                      {roles.map((role) => (\n                        <option key={role.id} value={role.id}>\n                          {getRoleDisplayWithType(role.role_type)}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n\n                  {/* Project Selection for Assignment - Hidden for Admin/Owner Role */}\n                  {selectedRoleId && (() => {\n                    const selectedRole = roles.find(r => r.id === selectedRoleId)\n                    const isAdminRole = selectedRole?.role_type === 'administrator' || selectedRole?.role_type === 'owner' || selectedRole?.role_type === 'admin'\n\n                    if (isAdminRole) {\n                      return (\n                        <div className=\"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg\">\n                          <div className=\"flex items-start gap-3\">\n                            <Shield className=\"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5\" />\n                            <div>\n                              <p className=\"text-sm font-semibold text-green-800 dark:text-green-200 mb-1\">\n                                {selectedRole?.role_type === 'owner' ? 'Owner Role' : 'Admin Role'} - No Project Selection Needed\n                              </p>\n                              <p className=\"text-sm text-green-700 dark:text-green-300\">\n                                {selectedRole?.role_type === 'owner'\n                                  ? 'Owner has full control â€” can manage billing, delete the organization, assign roles, and configure SSO.'\n                                  : 'Admin users automatically have full access to all projects in this organization.'\n                                }\n                              </p>\n                            </div>\n                          </div>\n                        </div>\n                      )\n                    }\n\n                    // Get projects where user already has roles\n                    const projectsWithRoles = new Set(\n                      currentRoles.map(role => (role as any).project_id)\n                    )\n\n                    return (\n                      <div className=\"space-y-3\">\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                            Select Project to Assign To\n                          </label>\n                          {availableProjects.length > 0 ? (\n                            <select\n                              value={selectedProjectId}\n                              onChange={(e) => setSelectedProjectId(e.target.value)}\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                            >\n                              <option value=\"\">Select a project...</option>\n                              {availableProjects.map((project) => (\n                                <option key={project.id} value={project.id}>\n                                  {project.name}\n                                  {projectsWithRoles.has(project.id) ? ' (already assigned)' : ''}\n                                </option>\n                              ))}\n                            </select>\n                          ) : (\n                            <div className=\"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg\">\n                              <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n                                âš ï¸ No projects available. Please create a project first before assigning roles.\n                              </p>\n                            </div>\n                          )}\n                        </div>\n\n                        {/* Warning: Projects with existing roles */}\n                        {projectsWithRoles.size > 0 && (\n                          <div className=\"p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg\">\n                            <p className=\"text-xs font-semibold text-amber-800 dark:text-amber-200 mb-2\">\n                              â„¹ï¸ User already has roles on:\n                            </p>\n                            <div className=\"flex flex-wrap gap-2\">\n                              {availableProjects\n                                .filter(p => projectsWithRoles.has(p.id))\n                                .map(p => (\n                                  <span\n                                    key={p.id}\n                                    className=\"inline-block px-2 py-1 text-xs bg-amber-200 text-amber-900 dark:bg-amber-800 dark:text-amber-100 rounded\"\n                                  >\n                                    {p.name}\n                                  </span>\n                                ))}\n                            </div>\n                            <p className=\"text-xs text-amber-700 dark:text-amber-300 mt-2\">\n                              System will automatically use a different project if you select one with an existing role.\n                            </p>\n                          </div>\n                        )}\n                      </div>\n                    )\n                  })()}\n\n\n                  {/* Role Preview */}\n                  {selectedRoleId && (\n                    <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n                      {(() => {\n                        const selectedRole = roles.find(r => r.id === selectedRoleId)\n                        if (!selectedRole) return null\n\n                        return (\n                          <div>\n                            <div className=\"flex items-center gap-2 mb-2\">\n                              <Shield className=\"w-5 h-5 text-blue-600\" />\n                              <span className=\"font-semibold text-blue-900 dark:text-blue-100\">\n                                {selectedRole.name}\n                              </span>\n                              <span className={`px-2 py-0.5 text-xs font-semibold rounded-full border ${getRoleBadgeColor(selectedRole.role_type)}`}>\n                                {getRoleDisplayName(selectedRole.role_type)}\n                              </span>\n                            </div>\n                            {selectedRole.description && (\n                              <p className=\"text-sm text-blue-700 dark:text-blue-200\">\n                                {selectedRole.description}\n                              </p>\n                            )}\n                          </div>\n                        )\n                      })()}\n                    </div>\n                  )}\n\n                  {/* Assign Button */}\n                  {(() => {\n                    const selectedRole = roles.find(r => r.id === selectedRoleId)\n                    const isAdminRole = selectedRole?.role_type === 'administrator' || selectedRole?.role_type === 'owner' || selectedRole?.role_type === 'admin'\n                    // Admin role only needs role selection, others need both role and project\n                    const isEnabled = selectedRoleId && (isAdminRole || selectedProjectId)\n\n                    // Check if the selected role already exists\n                    const roleAlreadyExists = currentRoles.some(role => {\n                      const roleId = (role as any).role?.id || (role as any).role_id\n                      const projectId = (role as any).project_id\n\n                      // For admin roles, check if role exists (regardless of project)\n                      if (isAdminRole) {\n                        return roleId === selectedRoleId\n                      }\n\n                      // For non-admin roles, check if same role exists on same project\n                      return roleId === selectedRoleId && projectId === selectedProjectId\n                    })\n\n                    return (\n                      <Button\n                        onClick={handleAssignRole}\n                        disabled={!isEnabled || roleAlreadyExists}\n                        className=\"w-full\"\n                      >\n                        Assign Role\n                      </Button>\n                    )\n                  })()}\n                </div>\n              </div>\n\n              {/* Current Role Assignments */}\n              <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                  Current Roles\n                </h3>\n\n                {/* Show all current roles */}\n                {currentRoles.length > 0 ? (\n                  <div className=\"space-y-3 mb-4\">\n                    {currentRoles.map((roleAssignment) => {\n                      const roleName = (roleAssignment as any).role?.name || (roleAssignment as any).role_name || 'Unknown Role'\n                      const roleType = (roleAssignment as any).role?.role_type || (roleAssignment as any).role_type || 'system'\n                      const projectId = (roleAssignment as any).project_id\n                      const projectName = availableProjects.find(p => p.id === projectId)?.name || 'Unknown Project'\n\n                      return (\n                        <div\n                          key={roleAssignment.id}\n                          className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600\"\n                        >\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2 mb-1\">\n                              <span className=\"font-medium text-gray-900 dark:text-white\">\n                                {roleName}\n                              </span>\n                              <span className={`px-2 py-0.5 text-xs font-semibold rounded-full border ${getRoleBadgeColor(roleType)}`}>\n                                {getRoleDisplayName(roleType)}\n                              </span>\n                            </div>\n                            {/* Only show project for non-org-level roles */}\n                            {!(roleType === 'owner' || roleType === 'admin' || roleType === 'administrator') && (\n                              <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                                Project: {projectName}\n                              </p>\n                            )}\n                            {/* Show org-level indicator for org roles */}\n                            {(roleType === 'owner' || roleType === 'admin' || roleType === 'administrator') && (\n                              <p className=\"text-xs text-blue-600 dark:text-blue-400 font-medium\">\n                                Organization-level access\n                              </p>\n                            )}\n                          </div>\n                          <button\n                            onClick={() => handleRemoveRole(roleAssignment.id)}\n                            className=\"ml-4 p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors\"\n                            title=\"Remove role\"\n                          >\n                            <Trash2 size={16} />\n                          </button>\n                        </div>\n                      )\n                    })}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 bg-gray-50 dark:bg-gray-700/50 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600\">\n                    <Shield className=\"w-12 h-12 mx-auto mb-3 text-gray-400\" />\n                    <p className=\"text-sm text-gray-600 dark:text-gray-400\">No roles assigned yet</p>\n                  </div>\n                )}\n\n                {/* Project Filter for Viewing Specific Project Roles */}\n                {availableProjects.length > 0 && (\n                  <div className=\"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      View roles by project (optional)\n                    </label>\n                    <select\n                      value={filterProjectId}\n                      onChange={(e) => {\n                        setFilterProjectId(e.target.value)\n                        if (e.target.value) {\n                          fetchCurrentRoles()\n                        }\n                      }}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                    >\n                      <option value=\"\">All projects</option>\n                      {availableProjects.map((project) => (\n                        <option key={project.id} value={project.id}>\n                          {project.name}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                )}\n\n                {filterProjectId && currentRoles.length === 0 ? (\n                  <div className=\"text-center py-8 bg-gray-50 dark:bg-gray-700/50 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600\">\n                    <Shield className=\"w-12 h-12 mx-auto mb-3 text-gray-400\" />\n                    <p className=\"text-gray-500 dark:text-gray-400\">\n                      No roles assigned yet for this project\n                    </p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {currentRoles.map((assignment) => (\n                      <div\n                        key={assignment.id}\n                        className=\"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600\"\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <Shield className=\"w-5 h-5 text-gray-400\" />\n                          <div>\n                            <div className=\"flex items-center gap-2\">\n                              <span className=\"font-medium text-gray-900 dark:text-white\">\n                                {(assignment as any).role?.name || (assignment as any).role_name}\n                              </span>\n                              <span className={`px-2 py-0.5 text-xs font-semibold rounded-full border ${getRoleBadgeColor((assignment as any).role?.role_type || (assignment as any).role_type)}`}>\n                                {getRoleDisplayName((assignment as any).role?.role_type || (assignment as any).role_type)}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => handleRemoveRole(assignment.id)}\n                          className=\"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20\"\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"flex items-center justify-end gap-2 p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800\">\n          <Button variant=\"outline\" onClick={onClose}>\n            Close\n          </Button>\n        </div>\n      </div>\n\n      {/* Delete Confirmation Modal */}\n      {showDeleteConfirm && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-[60] p-4\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-sm w-full\">\n            {/* Modal Header */}\n            <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                Remove Role Assignment\n              </h3>\n              <button\n                onClick={() => setShowDeleteConfirm(false)}\n                className=\"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors\"\n              >\n                <X className=\"w-5 h-5 text-gray-500\" />\n              </button>\n            </div>\n\n            {/* Modal Body */}\n            <div className=\"p-6\">\n              <div className=\"flex items-start gap-4\">\n                <div className=\"p-3 bg-red-50 dark:bg-red-900/20 rounded-lg\">\n                  <AlertCircle className=\"w-6 h-6 text-red-600 dark:text-red-400\" />\n                </div>\n                <div className=\"flex-1\">\n                  <p className=\"text-gray-900 dark:text-white font-medium mb-2\">\n                    Are you sure you want to remove this role assignment?\n                  </p>\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                    This action will revoke the {entityType}'s access to the assigned project. This cannot be undone.\n                  </p>\n                </div>\n              </div>\n            </div>\n\n            {/* Modal Footer */}\n            <div className=\"flex items-center justify-end gap-2 p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800\">\n              <Button\n                variant=\"outline\"\n                onClick={() => setShowDeleteConfirm(false)}\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={confirmRemoveRole}\n                className=\"bg-red-600 hover:bg-red-700 text-white\"\n              >\n                Remove Role\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2162, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/api/invitations.ts"],"sourcesContent":["import api from './index'\n\nexport interface Invitation {\n  id: string\n  email: string\n  token: string\n  organisation_id: string\n  invited_by: string\n  expiry_date: string\n  accepted_at?: string\n  created_at: string\n}\n\nexport async function createInvitation(data: {\n  email: string\n  full_name?: string\n  organisation_id: string\n  expiry_days?: number\n  role_id?: string\n}): Promise<Invitation> {\n  const response = await api.post('/api/v1/invitations/', data)\n  return response.data\n}\n\nexport async function listInvitations(organisationId: string): Promise<Invitation[]> {\n  const response = await api.get(`/api/v1/invitations/`, {\n    params: { organisation_id: organisationId }\n  })\n  return response.data\n}\n\nexport async function cancelInvitation(invitationId: string): Promise<void> {\n  await api.delete(`/api/v1/invitations/${invitationId}`)\n}\n\nexport async function acceptInvitation(token: string, data: {\n  username: string\n  password: string\n  full_name?: string\n}): Promise<{ access_token: string; refresh_token: string }> {\n  const response = await api.post('/api/v1/invitations/accept', {\n    invitation_token: token,\n    ...data\n  })\n  return response.data\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAaO,eAAe,iBAAiB,IAMtC;IACC,MAAM,WAAW,MAAM,0IAAG,CAAC,IAAI,CAAC,wBAAwB;IACxD,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,gBAAgB,cAAsB;IAC1D,MAAM,WAAW,MAAM,0IAAG,CAAC,GAAG,CAAC,CAAC,oBAAoB,CAAC,EAAE;QACrD,QAAQ;YAAE,iBAAiB;QAAe;IAC5C;IACA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,iBAAiB,YAAoB;IACzD,MAAM,0IAAG,CAAC,MAAM,CAAC,CAAC,oBAAoB,EAAE,cAAc;AACxD;AAEO,eAAe,iBAAiB,KAAa,EAAE,IAIrD;IACC,MAAM,WAAW,MAAM,0IAAG,CAAC,IAAI,CAAC,8BAA8B;QAC5D,kBAAkB;QAClB,GAAG,IAAI;IACT;IACA,OAAO,SAAS,IAAI;AACtB","debugId":null}},
    {"offset": {"line": 2200, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/settings/permission-matrix.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState, Fragment } from 'react'\nimport api from '@/lib/api'\nimport { Loader2 } from 'lucide-react'\n\ninterface Permission {\n  id: string\n  name: string\n  resource: string\n  action: string\n  description?: string\n}\n\ninterface Role {\n  id: string\n  name: string\n  role_type?: string\n  description?: string\n  permission_count?: number\n  permissions?: Permission[]\n}\n\ninterface PermissionMatrixProps {\n  organisationId: string\n  isAdmin?: boolean\n}\n\ninterface RolePermissionMap {\n  [roleId: string]: string[]\n}\n\n// Group permissions by resource for better organization\nconst PERMISSION_GROUPS = {\n  'User Management': ['user_read_access', 'user_write_access', 'user_delete_access'],\n  'Role Management': ['role_read_access', 'role_write_access', 'role_delete_access'],\n  'Project Management': ['project_read_access', 'project_write_access', 'project_delete_access'],\n  'Settings': ['settings_read_access', 'settings_write_access'],\n  'Organization': ['organization_manage_access'],\n  'Test Case Management': [\n    'test_case_read_access', 'test_case_write_access', 'test_case_delete_access', 'test_case_execute_access',\n  ],\n  'Security Testing': [\n    'security_test_read_access', 'security_test_write_access', 'security_test_delete_access', 'security_test_execute_access',\n  ],\n  'API Testing': [\n    'api_test_read_access', 'api_test_write_access', 'api_test_delete_access', 'api_test_execute_access',\n  ],\n  'Automation Hub': [\n    'automation_read_access', 'automation_write_access', 'automation_delete_access', 'automation_execute_access',\n  ],\n}\n\n// Permission matrix definition - which roles have which permissions\n// Based on role permission specification: Owner/Admin have full access, others have graduated access levels\n// NOTE: This matrix should include ALL permissions that exist in the database\nconst PERMISSION_MATRIX: Record<string, Record<string, boolean>> = {\n  // User Management\n  'user_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'user_write_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'user_delete_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  // Role Management\n  'role_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'role_write_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'role_delete_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  // Project Management\n  'project_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'project_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'project_delete_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  // Settings\n  'settings_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'settings_write_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  // Organization\n  'organization_manage_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  // Test Case Management (using newer naming convention)\n  'test_case_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'test_case_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'test_case_delete_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'test_case_execute_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // Test Management (alternate naming convention)\n  'read_test_management': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'write_test_management': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'manage_test_management': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'execute_test_management': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // Security Testing\n  'security_test_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'security_test_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'security_test_delete_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'security_test_execute_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // Security Testing (alternate naming)\n  'read_security_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'write_security_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'manage_security_testing': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'execute_security_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // API Testing\n  'api_test_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'api_test_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'api_test_delete_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'api_test_execute_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // API Testing (alternate naming)\n  'read_api_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'write_api_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'manage_api_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'execute_api_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // Automation Hub\n  'automation_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'automation_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'automation_delete_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'automation_execute_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // Automation Hub (alternate naming)\n  'read_automation_hub': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'write_automation_hub': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'manage_automation_hub': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'execute_automation_hub': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // Performance Testing\n  'read_performance_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'write_performance_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'manage_performance_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'execute_performance_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'performance_test_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'performance_test_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'performance_test_delete_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'performance_test_execute_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // Mobile Testing\n  'read_mobile_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'write_mobile_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'manage_mobile_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'execute_mobile_testing': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'mobile_test_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'mobile_test_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'mobile_test_delete_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'mobile_test_execute_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n}\n\nexport function PermissionMatrix({ organisationId, isAdmin = false }: PermissionMatrixProps) {\n  const [roles, setRoles] = useState<Role[]>([])\n  const [permissions, setPermissions] = useState<Permission[]>([])\n  const [loading, setLoading] = useState(true)\n  const [rolePermissions, setRolePermissions] = useState<RolePermissionMap>({})\n  const [permissionGroups, setPermissionGroups] = useState<Record<string, string[]>>(PERMISSION_GROUPS)\n\n  useEffect(() => {\n    fetchData()\n  }, [organisationId])\n\n  const fetchData = async () => {\n    setLoading(true)\n    try {\n      // Fetch roles\n      const rolesResponse = await api.get('/api/v1/roles/', {\n        params: { organisation_id: organisationId }\n      })\n      const rolesList = rolesResponse.data.roles || []\n      console.log('ðŸŽ¯ Roles from API:', rolesList.map(r => ({\n        id: r.id,\n        name: r.name,\n        role_type: r.role_type,\n        permissions_from_api: r.permissions?.length || 0,\n        permission_count: r.permission_count\n      })))\n      setRoles(rolesList)\n\n      // Fetch dynamic permissions based on enabled modules\n      let permsList: Permission[] = []\n      try {\n        const dynamicResponse = await api.get(`/api/v1/roles/dynamic/${organisationId}`)\n        const { permission_groups, all_permissions, enabled_modules } = dynamicResponse.data\n\n        // Use dynamic permission groups if available\n        if (permission_groups) {\n          setPermissionGroups(permission_groups)\n        }\n\n\n        // Use all permissions including dynamic ones\n        permsList = all_permissions || []\n        setPermissions(permsList)\n      } catch (dynamicError) {\n        // Fallback to static permissions if dynamic endpoint fails\n        console.warn('Could not fetch dynamic permissions, using static permissions:', dynamicError)\n        const permsResponse = await api.get('/api/v1/roles/permissions')\n        permsList = permsResponse.data.permissions || []\n        setPermissions(permsList)\n      }\n\n      // Initialize role-permission mapping based on PERMISSION_MATRIX ONLY\n      // CRITICAL: We MUST ignore any permissions from the API and use ONLY PERMISSION_MATRIX\n      const permMap: RolePermissionMap = {}\n\n      // Create a mapping of permission names to IDs for quick lookup\n      const permNameToIdMap: Record<string, string> = {}\n      permsList.forEach(perm => {\n        permNameToIdMap[perm.name] = perm.id\n      })\n\n      console.log('ðŸ” Permission name to ID mapping:', Object.keys(permNameToIdMap).slice(0, 5))\n      console.log('ðŸ“‹ Total permissions found:', permsList.length)\n\n      rolesList.forEach((role: Role) => {\n        let rolePerms: string[] = []\n\n        console.log(`ðŸ” Processing role \"${role.name}\" (${role.role_type}):`, {\n          hasPermissions: !!role.permissions,\n          permissionCount: role.permissions?.length || 0,\n          permissionIds: role.permissions?.map(p => p.id) || []\n        })\n\n        // ALWAYS use permissions from the API - this is the source of truth\n        if (role.permissions && role.permissions.length > 0) {\n          rolePerms = role.permissions.map(p => p.id)\n          console.log(`âœ… Role \"${role.name}\" (${role.role_type}): ${rolePerms.length} permissions from API`)\n          console.log(`   Permission IDs: ${rolePerms.slice(0, 3).join(', ')}...`)\n        } else {\n          // If no permissions from API, it means the role has NO permissions assigned\n          console.log(`âš ï¸ Role \"${role.name}\" (${role.role_type}) has NO permissions assigned in database`)\n        }\n\n        permMap[role.id] = rolePerms\n      })\n\n      // Log detailed mapping for debugging\n      console.log('ðŸ“ Detailed permission mapping:')\n      Object.entries(permMap).forEach(([roleId, permIds]) => {\n        const role = rolesList.find(r => r.id === roleId)\n        console.log(`  ${role?.name}: [${permIds.map(id => {\n          const perm = permsList.find(p => p.id === id)\n          return perm?.name || id\n        }).join(', ')}]`)\n      })\n\n      console.log('ðŸ“Š Final permission map:', Object.entries(permMap).map(([roleId, perms]) => ({\n        roleId: roleId.slice(0, 8),\n        count: perms.length,\n        sampleIds: perms.slice(0, 2)\n      })))\n\n      // Set state - these are the ONLY permissions we will use\n      setRolePermissions(permMap)\n    } catch (error: any) {\n      console.error('Failed to fetch data:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\n        <span className=\"ml-2\">Loading permission matrix...</span>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div>\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\n          Role Permissions Matrix\n        </h3>\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n          View current role permissions (read-only)\n        </p>\n      </div>\n\n\n      {/* Permission Matrix */}\n      <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden bg-white dark:bg-gray-800\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full text-sm border-collapse\" style={{ tableLayout: 'fixed' }}>\n            {/* Header */}\n            <thead>\n              <tr className=\"bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700\">\n                <th className=\"px-3 py-3 text-left font-semibold text-gray-900 dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-900 z-10\" style={{ width: '192px' }}>\n                  Permission\n                </th>\n                {roles.map(role => (\n                  <th\n                    key={role.id}\n                    className=\"px-2 py-3 text-center font-semibold text-gray-900 dark:text-white whitespace-nowrap align-middle\"\n                    style={{ width: '120px' }}\n                  >\n                    <div className=\"truncate text-xs\" title={role.name}>\n                      {role.name}\n                    </div>\n                  </th>\n                ))}\n              </tr>\n            </thead>\n\n            {/* Body */}\n            <tbody>\n              {Object.entries(permissionGroups).map(([groupName, permNames]) => {\n                return (\n                  <Fragment key={groupName}>\n                    {/* Group Header */}\n                    <tr className=\"bg-blue-50 dark:bg-blue-900/20 border-b border-gray-200 dark:border-gray-700\">\n                      <td\n                        colSpan={roles.length + 1}\n                        className=\"px-3 py-2 text-sm font-bold text-blue-900 dark:text-blue-200 sticky left-0 bg-blue-50 dark:bg-blue-900/20 z-10\"\n                      >\n                        {groupName}\n                      </td>\n                    </tr>\n\n                    {/* Permission rows */}\n                    {permNames.map((permName, idx) => {\n                      // Find the permission by name\n                      const perm = permissions.find(p => p.name === permName)\n                      if (!perm) return null\n\n                      return (\n                        <tr\n                          key={`${groupName}-${permName}-${idx}`}\n                          className=\"border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50\"\n                        >\n                          <td className=\"px-3 py-3 text-gray-900 dark:text-white sticky left-0 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700/50 z-10 align-middle\" style={{ width: '192px' }}>\n                            <div>\n                              <div className=\"font-medium text-xs truncate\" title={perm.name}>{perm.name}</div>\n                              <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-0.5 hidden sm:block truncate\" title={perm.description || `${perm.action} ${perm.resource}`}>\n                                {perm.description || `${perm.action} ${perm.resource}`}\n                              </div>\n                            </div>\n                          </td>\n                          {roles.map(role => {\n                            const isChecked = (rolePermissions[role.id] || []).includes(perm.id)\n                            return (\n                              <td\n                                key={`${role.id}-${perm.id}`}\n                                className=\"px-2 py-3 text-center align-middle\"\n                                style={{ width: '120px' }}\n                              >\n                                <div className=\"flex items-center justify-center h-full\">\n                                  <input\n                                    type=\"checkbox\"\n                                    checked={isChecked === true}\n                                    onChange={() => {}}\n                                    className=\"w-4 h-4 accent-primary\"\n                                    disabled={true}\n                                    title=\"Permission matrix is read-only\"\n                                    data-role={role.id}\n                                    data-perm={perm.id}\n                                  />\n                                </div>\n                              </td>\n                            )\n                          })}\n                        </tr>\n                      )\n                    })}\n                  </Fragment>\n                )\n              })}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* Summary */}\n      <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3\">\n        {roles.map(role => (\n          <div\n            key={role.id}\n            className=\"p-3 border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800\"\n          >\n            <div className=\"text-xs font-semibold text-gray-900 dark:text-white mb-1 truncate\" title={role.name}>\n              {role.name}\n            </div>\n            <div className=\"text-xl font-bold text-blue-600 dark:text-blue-400\">\n              {(rolePermissions[role.id] || []).length}\n            </div>\n            <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n              assigned\n            </div>\n          </div>\n        ))}\n      </div>\n\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3212, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/app/organizations/%5Buuid%5D/users-teams/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { PlusCircle, User, Users, Search, Pencil, Trash2, UserPlus, Shield, Plus } from 'lucide-react'\nimport { useParams } from 'next/navigation'\nimport { toast } from 'sonner'\nimport { formatDateHumanReadable } from '@/lib/date-utils'\nimport { getRoleType } from '@/lib/role-display-utils'\nimport { Sidebar } from '@/components/layout/sidebar'\nimport {\n  listRoles,\n  listUserRoles,\n  assignRoleToUser,\n  removeRoleFromUser,\n  createRole,\n  deleteRole,\n  listPermissions,\n  type ProjectRole,\n  type UserProjectRoleWithDetails,\n  type Permission\n} from '@/lib/api/roles'\nimport { listOrganisationUsers, type User as UserType } from '@/lib/api/users'\nimport { RoleAssignmentModal } from '@/components/roles/role-assignment-modal'\nimport { createInvitation } from '@/lib/api/invitations'\nimport { PermissionMatrix } from '@/components/settings/permission-matrix'\nimport { useAuth } from '@/lib/auth-context'\nimport api from '@/lib/api'\n\ntype Tab = 'users' | 'roles'\n\ninterface Project {\n  id: string\n  name: string\n}\n\ninterface Organisation {\n  id: string\n  name: string\n  owner_id: string\n  created_at: string\n}\n\nexport default function UsersTeamsPage() {\n  const params = useParams()\n  const organisationId = params.uuid as string\n  const { user: currentUser } = useAuth()\n\n  const [activeTab, setActiveTab] = useState<Tab>('users')\n  const [organisation, setOrganisation] = useState<Organisation | null>(null)\n  const [users, setUsers] = useState<UserType[]>([])\n  const [roles, setRoles] = useState<ProjectRole[]>([])\n  const [permissions, setPermissions] = useState<Permission[]>([])\n  const [userRoles, setUserRoles] = useState<UserProjectRoleWithDetails[]>([])\n  const [loading, setLoading] = useState(true)\n  const [searchQuery, setSearchQuery] = useState('')\n  const [projects, setProjects] = useState<Project[]>([])\n  const [userProjects, setUserProjects] = useState<Record<string, Project[]>>({})\n  const [isCurrentUserAdmin, setIsCurrentUserAdmin] = useState(false)\n\n  // Modal states\n  const [showInviteModal, setShowInviteModal] = useState(false)\n  const [showProjectAssignModal, setShowProjectAssignModal] = useState(false)\n  const [showAssignRoleModal, setShowAssignRoleModal] = useState(false)\n  const [showCreateRoleModal, setShowCreateRoleModal] = useState(false)\n  const [rolesView, setRolesView] = useState<'list' | 'matrix'>('list')\n  const [showDeleteRoleDialog, setShowDeleteRoleDialog] = useState(false)\n  const [roleToDelete, setRoleToDelete] = useState<ProjectRole | null>(null)\n  const [deletingRoleId, setDeletingRoleId] = useState<string | null>(null)\n\n  // Selected items\n  const [selectedUser, setSelectedUser] = useState<UserType | null>(null)\n  const [selectedUserForProjects, setSelectedUserForProjects] = useState<UserType | null>(null)\n  const [roleModalEntity, setRoleModalEntity] = useState<{\n    type: 'user'\n    id: string\n    name: string\n    initialRoleId?: string\n  } | null>(null)\n  const [selectedUserToAdd, setSelectedUserToAdd] = useState<string>('')\n  const [showAddMemberSection, setShowAddMemberSection] = useState(false)\n\n  // Form data\n  const [userFormData, setUserFormData] = useState({\n    email: '',\n    username: '',\n    password: '',\n    full_name: '',\n    roleType: ''\n  })\n  const [roleFormData, setRoleFormData] = useState({\n    name: '',\n    roleType: '',\n    description: '',\n    selectedPermissions: [] as string[]\n  })\n\n  useEffect(() => {\n    const loadAllData = async () => {\n      try {\n        // Fetch projects first since other data depends on it\n        const projectsResponse = await api.get('/api/v1/projects/', {\n          params: { organisation_id: organisationId }\n        })\n        const projectsData = projectsResponse.data\n        setProjects(projectsData)\n\n        // Then fetch other data, passing projects as parameter\n        await Promise.all([\n          fetchDataWithProjects(projectsData),\n          fetchPermissions()\n        ])\n      } catch (error: any) {\n        console.error('Error loading data:', error)\n        toast.error('Failed to load data')\n      }\n    }\n    loadAllData()\n  }, [organisationId, activeTab])\n\n  const fetchData = async () => {\n    // This is kept for modal callbacks - it will use current state projects\n    const currentProjects = projects\n    await fetchDataWithProjects(currentProjects)\n  }\n\n  const fetchDataWithProjects = async (projectsData: Project[]) => {\n    setLoading(true)\n    try {\n      // Fetch organization details\n      const orgResponse = await api.get(`/api/v1/organisations/${organisationId}`)\n      setOrganisation(orgResponse.data)\n\n      // Determine if current user is admin\n      const isAdmin = currentUser?.is_superuser || currentUser?.id === orgResponse.data.owner_id\n      setIsCurrentUserAdmin(isAdmin)\n\n      // Fetch users\n      const usersData = await listOrganisationUsers(organisationId)\n      setUsers(usersData)\n\n      // Fetch roles\n      const rolesData = await listRoles(organisationId)\n      setRoles(rolesData.roles)\n\n      // Fetch user roles across all projects (pass projects as parameter)\n      await fetchAllUserRoles(usersData, projectsData)\n\n      // Fetch user projects for each user\n      if (usersData.length > 0) {\n        await fetchAllUserProjects(usersData, projectsData)\n      }\n\n    } catch (error: any) {\n      console.error('Error fetching data:', error)\n      toast.error(error.message || 'Failed to load data')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const fetchAllUserRoles = async (usersList: UserType[], projectsList: Project[] = projects) => {\n    try {\n      let allRoles: UserProjectRoleWithDetails[] = []\n\n      // Fetch roles for each project\n      for (const project of projectsList) {\n        try {\n          const response = await api.get(`/api/v1/roles/assignments/users`, {\n            params: { project_id: project.id }\n          })\n          if (response.data.assignments) {\n            allRoles = [...allRoles, ...response.data.assignments]\n          }\n        } catch (e) {\n          // Project might not have any roles\n        }\n      }\n\n      setUserRoles(allRoles)\n    } catch (error: any) {\n      console.error('Error fetching user roles:', error)\n    }\n  }\n\n  const getUserRole = (user: UserType): string => {\n    // If user is the organization owner, return \"Owner\"\n    if (organisation && user.id === organisation.owner_id) {\n      return 'Owner'\n    }\n    // Check if user has any organization-level roles\n    const userOrgRoles = userRoles.filter(ur => ur.user_id === user.id)\n    if (userOrgRoles.length > 0) {\n      // Return the first organization-level role\n      const firstRole = userOrgRoles[0]\n      return (firstRole as any).role?.name || (firstRole as any).role_name || 'No Role'\n    }\n    // If no role assigned, return empty string\n    return ''\n  }\n\n  const fetchAllUserProjects = async (usersList: UserType[], projectsList: Project[] = projects) => {\n    try {\n      const userProjectsMap: Record<string, Project[]> = {}\n\n      for (const user of usersList) {\n        const assignedProjects: Project[] = []\n\n        for (const project of projectsList) {\n          try {\n            const response = await api.get(`/api/v1/projects/${project.id}/members`)\n            if (response.data.some((m: any) => m.id === user.id)) {\n              assignedProjects.push(project)\n            }\n          } catch (e) {\n            // User not assigned to this project, skip\n          }\n        }\n\n        userProjectsMap[user.id] = assignedProjects\n      }\n\n      setUserProjects(userProjectsMap)\n    } catch (error: any) {\n      console.error('Error fetching user projects:', error)\n    }\n  }\n\n  const fetchUserProjects = async (userId: string) => {\n    try {\n      const assignedProjects: Project[] = []\n\n      for (const project of projects) {\n        try {\n          const response = await api.get(`/api/v1/projects/${project.id}/members`)\n          if (response.data && Array.isArray(response.data)) {\n            if (response.data.some((m: any) => m.id === userId)) {\n              assignedProjects.push(project)\n            }\n          }\n        } catch (e: any) {\n          // Log for debugging\n          console.log(`Error fetching members for project ${project.id}:`, e.response?.status, e.response?.data?.detail)\n          // User not assigned to this project or permission denied\n        }\n      }\n\n      setUserProjects(prev => ({ ...prev, [userId]: assignedProjects }))\n    } catch (error: any) {\n      console.error('Failed to fetch user projects:', error)\n    }\n  }\n\n  const fetchProjects = async () => {\n    try {\n      const response = await api.get('/api/v1/projects/', {\n        params: { organisation_id: organisationId }\n      })\n      console.log('Fetched projects:', response.data)\n      setProjects(response.data)\n    } catch (error: any) {\n      console.error('Error fetching projects:', error)\n      toast.error('Failed to fetch projects: ' + (error.response?.data?.detail || error.message))\n    }\n  }\n\n  const fetchPermissions = async () => {\n    try {\n      const permissionsData = await listPermissions()\n      setPermissions(permissionsData)\n    } catch (error: any) {\n      console.error('Error fetching permissions:', error)\n    }\n  }\n\n  const handleInviteUser = async () => {\n    if (!userFormData.email) {\n      toast.error('Email address is required')\n      return\n    }\n\n    try {\n      await createInvitation({\n        email: userFormData.email,\n        full_name: userFormData.full_name || undefined,\n        organisation_id: organisationId,\n        expiry_days: 7,\n        role_id: userFormData.roleType || undefined\n      })\n\n      toast.success(`Invitation sent to ${userFormData.email}`)\n      setShowInviteModal(false)\n      setUserFormData({ email: '', username: '', password: '', full_name: '', roleType: '' })\n\n      // Refresh data to show pending invitations\n      fetchData()\n    } catch (error: any) {\n      console.error('Failed to send invitation:', error)\n      toast.error(error.response?.data?.detail || 'Failed to send invitation')\n    }\n  }\n\n  const openProjectAssignmentModal = (user: UserType) => {\n    setSelectedUserForProjects(user)\n    setShowProjectAssignModal(true)\n  }\n\n  const handleAssignToProject = async (projectId: string) => {\n    if (!selectedUserForProjects) return\n\n    try {\n      await api.post(`/api/v1/projects/${projectId}/members`, null, {\n        params: { user_id: selectedUserForProjects.id }\n      })\n      toast.success(`${selectedUserForProjects.username} assigned to project`)\n      // Refresh user projects with all current projects\n      await fetchUserProjects(selectedUserForProjects.id)\n      // Also refresh all user data to update the main table\n      await fetchData()\n    } catch (error: any) {\n      console.error('Failed to assign user:', error)\n      toast.error(error.response?.data?.detail || 'Failed to assign user')\n    }\n  }\n\n  const handleRemoveFromProject = async (projectId: string) => {\n    if (!selectedUserForProjects) return\n\n    if (!confirm(`Remove ${selectedUserForProjects.username} from this project?`)) return\n\n    try {\n      await api.delete(\n        `/api/v1/projects/${projectId}/members/${selectedUserForProjects.id}`\n      )\n      toast.success('User removed from project')\n      // Refresh user projects with all current projects\n      await fetchUserProjects(selectedUserForProjects.id)\n      // Also refresh all user data to update the main table\n      await fetchData()\n    } catch (error: any) {\n      console.error('Failed to remove user:', error)\n      toast.error(error.response?.data?.detail || 'Failed to remove user')\n    }\n  }\n\n  const handleCreateRole = async () => {\n    if (!roleFormData.name || !roleFormData.roleType) {\n      toast.error('Please fill in all required fields')\n      return\n    }\n\n    try {\n      await createRole(\n        organisationId,\n        roleFormData.name,\n        roleFormData.roleType,\n        roleFormData.description,\n        roleFormData.selectedPermissions\n      )\n      toast.success('Role created successfully')\n      setShowCreateRoleModal(false)\n      setRoleFormData({ name: '', roleType: '', description: '', selectedPermissions: [] })\n      fetchData()\n    } catch (error: any) {\n      console.error('Failed to create role:', error)\n      toast.error(error.response?.data?.detail || 'Failed to create role')\n    }\n  }\n\n  const handleDeleteRole = async (role: ProjectRole) => {\n    // Check if it's a system role\n    if (role.is_system_role) {\n      toast.error('Cannot delete system roles')\n      return\n    }\n\n    setRoleToDelete(role)\n    setShowDeleteRoleDialog(true)\n  }\n\n  const confirmDeleteRole = async () => {\n    if (!roleToDelete) return\n\n    setDeletingRoleId(roleToDelete.id)\n    try {\n      await deleteRole(roleToDelete.id)\n      toast.success(`Role \"${roleToDelete.name}\" deleted successfully`)\n      setShowDeleteRoleDialog(false)\n      setRoleToDelete(null)\n      fetchData()\n    } catch (error: any) {\n      console.error('Failed to delete role:', error)\n      toast.error(error.response?.data?.detail || 'Failed to delete role')\n    } finally {\n      setDeletingRoleId(null)\n    }\n  }\n\n  const filteredUsers = users.filter(user =>\n    user.email.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    user.username.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    (user.full_name && user.full_name.toLowerCase().includes(searchQuery.toLowerCase()))\n  )\n\n  const filteredRoles = roles\n    .filter(role =>\n      role.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      role.role_type.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      (role.description && role.description.toLowerCase().includes(searchQuery.toLowerCase()))\n    )\n    .sort((a, b) => a.name.localeCompare(b.name))\n\n  if (loading) {\n    return (\n      <div className=\"flex min-h-screen\">\n        <Sidebar organisationId={organisationId} />\n        <div className=\"flex-1 flex items-center justify-center bg-white\">\n          <div className=\"text-center\">\n            <div className=\"text-gray-500\">Loading...</div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen bg-white\">\n      <Sidebar organisationId={organisationId} />\n      <main className=\"flex-1 overflow-auto\">\n        {/* Header */}\n        <div className=\"px-8 py-6\">\n          <div className=\"flex items-center gap-3 mb-1\">\n            <div className=\"w-10 h-10 bg-primary rounded-lg flex items-center justify-center flex-shrink-0\">\n              <Users className=\"w-5 h-5 text-white\" />\n            </div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">Users & Teams</h1>\n          </div>\n          <p className=\"text-sm text-gray-600 mt-2 ml-13\">Manage user access, teams, and role assignments</p>\n        </div>\n\n        <div className=\"px-8 py-6\">\n          <div className=\"flex items-center justify-end mb-8\">\n        <div className=\"flex gap-2\">\n          {activeTab === 'users' && (\n            <Button onClick={() => setShowInviteModal(true)}>\n              <PlusCircle className=\"mr-2 h-4 w-4\" />\n              Invite User\n            </Button>\n          )}\n          {activeTab === 'roles' && (\n            <Button onClick={() => setShowCreateRoleModal(true)}>\n              <Shield className=\"mr-2 h-4 w-4\" />\n              Create Role\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"border-b border-gray-200 mb-6\">\n        <nav className=\"-mb-px flex space-x-8\">\n          <button\n            onClick={() => setActiveTab('users')}\n            className={`${\n              activeTab === 'users'\n                ? 'border-primary text-primary'\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n            } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2`}\n          >\n            <User className=\"w-4 h-4\" />\n            Users ({users.length})\n          </button>\n          <button\n            onClick={() => setActiveTab('roles')}\n            className={`${\n              activeTab === 'roles'\n                ? 'border-primary text-primary'\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n            } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2`}\n          >\n            <Shield className=\"w-4 h-4\" />\n            Roles ({roles.length})\n          </button>\n        </nav>\n      </div>\n\n      {/* Search and Filters */}\n      <div className=\"mb-6 flex gap-3\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n          <input\n            type=\"text\"\n            placeholder={`Search ${activeTab}...`}\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n          />\n        </div>\n      </div>\n\n      {/* Users Tab Content */}\n      {activeTab === 'users' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm text-left text-gray-500 dark:text-gray-400\">\n              <thead className=\"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400\">\n                <tr>\n                  <th scope=\"col\" className=\"px-6 py-3\">User</th>\n                  <th scope=\"col\" className=\"px-6 py-3\">Role</th>\n                  <th scope=\"col\" className=\"px-6 py-3\">Projects</th>\n                  <th scope=\"col\" className=\"px-6 py-3\">Created</th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-center\">Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                {filteredUsers.length === 0 ? (\n                  <tr>\n                    <td colSpan={5} className=\"px-6 py-8 text-center text-gray-500\">\n                      No users found. Invite users to get started.\n                    </td>\n                  </tr>\n                ) : (\n                  filteredUsers.map((user) => (\n                    <tr key={user.id} className=\"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\">\n                      <td className=\"px-6 py-4\">\n                        <div className=\"flex items-center\">\n                          <div className=\"h-10 w-10 flex-shrink-0\">\n                            <div className=\"h-10 w-10 rounded-full bg-gradient-to-br from-teal-500 to-cyan-600 flex items-center justify-center\">\n                              <span className=\"text-sm font-semibold text-white\">\n                                {user.username.substring(0, 2).toUpperCase()}\n                              </span>\n                            </div>\n                          </div>\n                          <div className=\"ml-4\">\n                            <div className=\"text-sm font-medium text-gray-900 dark:text-white\">{user.full_name || user.username}</div>\n                            <div className=\"text-sm text-gray-500 dark:text-gray-400\">{user.email}</div>\n                          </div>\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4\">\n                        {(() => {\n                          const userRolesList = userRoles.filter(ur => ur.user_id === user.id)\n                          if (userRolesList.length === 0) {\n                            return <span className=\"text-sm text-gray-500 dark:text-gray-400\">No roles</span>\n                          }\n\n                          // Deduplicate roles by name\n                          const uniqueRoles = Array.from(\n                            new Map(\n                              userRolesList.map(ur => {\n                                const roleName = (ur as any).role?.name || (ur as any).role_name || 'Unknown Role'\n                                return [roleName, ur]\n                              })\n                            ).values()\n                          )\n\n                          return (\n                            <div className=\"flex flex-wrap gap-1\">\n                              {uniqueRoles.map(ur => (\n                                <span\n                                  key={ur.id}\n                                  className=\"inline-block px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded\"\n                                >\n                                  {(ur as any).role?.name || (ur as any).role_name || 'Unknown Role'}\n                                </span>\n                              ))}\n                            </div>\n                          )\n                        })()}\n                      </td>\n                      <td className=\"px-6 py-4\">\n                        <div className=\"space-y-1\">\n                          {(() => {\n                            // Check if user has organization-level role (Owner or Admin)\n                            const hasOrgLevelRole = userRoles.some(\n                              ur => ur.user_id === user.id &&\n                                ((ur as any).role?.role_type === 'owner' ||\n                                 (ur as any).role?.role_type === 'admin' ||\n                                 (ur as any).role?.role_type === 'administrator' ||\n                                 (ur as any).role?.name === 'Owner' ||\n                                 (ur as any).role?.name === 'Admin' ||\n                                 (ur as any).role_name === 'Owner' ||\n                                 (ur as any).role_name === 'Admin')\n                            )\n\n                            if (hasOrgLevelRole) {\n                              return (\n                                <div className=\"flex items-center gap-2 px-3 py-2 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n                                  <Shield className=\"w-4 h-4 text-green-600 dark:text-green-400\" />\n                                  <span className=\"text-sm font-medium text-green-800 dark:text-green-200\">\n                                    All projects (auto)\n                                  </span>\n                                </div>\n                              )\n                            }\n\n                            if ((userProjects[user.id] || []).length > 0) {\n                              return (\n                                <div className=\"flex flex-wrap gap-1\">\n                                  {(userProjects[user.id] || []).map(project => (\n                                    <span\n                                      key={project.id}\n                                      className=\"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded\"\n                                    >\n                                      {project.name}\n                                    </span>\n                                  ))}\n                                </div>\n                              )\n                            }\n\n                            return (\n                              <span className=\"text-sm text-gray-500 dark:text-gray-400\">No projects</span>\n                            )\n                          })()}\n                          {(() => {\n                            // Don't show Manage Projects button for org-level roles\n                            const hasOrgLevelRole = userRoles.some(\n                              ur => ur.user_id === user.id &&\n                                ((ur as any).role?.role_type === 'owner' ||\n                                 (ur as any).role?.role_type === 'admin' ||\n                                 (ur as any).role?.role_type === 'administrator' ||\n                                 (ur as any).role?.name === 'Owner' ||\n                                 (ur as any).role?.name === 'Admin' ||\n                                 (ur as any).role_name === 'Owner' ||\n                                 (ur as any).role_name === 'Admin')\n                            )\n\n                            if (hasOrgLevelRole) {\n                              return null\n                            }\n\n                            return (\n                              <button\n                                onClick={() => openProjectAssignmentModal(user)}\n                                className=\"text-xs text-primary hover:underline flex items-center gap-1 mt-1\"\n                              >\n                                <Plus className=\"w-3 h-3\" />\n                                Manage Projects\n                              </button>\n                            )\n                          })()}\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4 text-sm text-gray-500\">\n                        {formatDateHumanReadable(user.created_at)}\n                      </td>\n                      <td className=\"px-6 py-4 flex justify-center items-center\">\n                        <button\n                          onClick={() => {\n                            // Get the first role ID if the user has roles\n                            const userRolesList = userRoles.filter(ur => ur.user_id === user.id)\n                            const firstRoleId = userRolesList.length > 0 ? userRolesList[0].id : undefined\n\n                            setRoleModalEntity({\n                              type: 'user',\n                              id: user.id,\n                              name: user.full_name || user.username,\n                              initialRoleId: firstRoleId\n                            })\n                            setShowAssignRoleModal(true)\n                          }}\n                          className=\"flex items-center gap-1 px-3 py-2 rounded-lg text-blue-600 bg-blue-50 hover:bg-blue-100 dark:text-blue-400 dark:bg-blue-900/20 dark:hover:bg-blue-900/30 transition-colors\"\n                        >\n                          <Pencil className=\"w-4 h-4\" />\n                          Edit Roles\n                        </button>\n                      </td>\n                    </tr>\n                  ))\n                )}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n\n      {/* Roles Tab Content */}\n      {activeTab === 'roles' && (\n        <div>\n          {/* Roles Tab Sub-navigation */}\n          <div className=\"mb-6 flex gap-4 border-b border-gray-200 dark:border-gray-700\">\n            <button\n              onClick={() => setRolesView('list')}\n              className={`py-3 px-4 text-sm font-medium border-b-2 transition-colors ${\n                rolesView === 'list'\n                  ? 'border-primary text-primary'\n                  : 'border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white'\n              }`}\n            >\n              ðŸ“‹ Roles List\n            </button>\n            <button\n              onClick={() => setRolesView('matrix')}\n              className={`py-3 px-4 text-sm font-medium border-b-2 transition-colors ${\n                rolesView === 'matrix'\n                  ? 'border-primary text-primary'\n                  : 'border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white'\n              }`}\n            >\n              ðŸ” Permission Matrix\n            </button>\n          </div>\n\n          {/* Roles List View */}\n          {rolesView === 'list' && (\n            <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm\">\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full text-sm text-left text-gray-500 dark:text-gray-400\">\n                  <thead className=\"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400\">\n                    <tr>\n                      <th scope=\"col\" className=\"px-6 py-3\">Role Name</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">Type</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">Description</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">Status</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">System Role</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">Created</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {filteredRoles.length === 0 ? (\n                      <tr>\n                        <td colSpan={7} className=\"px-6 py-8 text-center text-gray-500\">\n                          No roles found. {roles.length === 0 ? 'Initialize default roles or create a custom role to get started.' : 'Try adjusting your search.'}\n                        </td>\n                      </tr>\n                    ) : (\n                      filteredRoles.map((role) => (\n                        <tr key={role.id} className=\"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\">\n                          <td className=\"px-6 py-4\">\n                            <div className=\"font-medium text-gray-900 dark:text-white\">{role.name}</div>\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800\">\n                              {getRoleType(role.role_type)}\n                            </span>\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <div className=\"text-sm text-gray-500 dark:text-gray-400 max-w-xs truncate\">\n                              {role.description || '-'}\n                            </div>\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                              role.is_active ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'\n                            }`}>\n                              {role.is_active ? 'Active' : 'Inactive'}\n                            </span>\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                              role.is_system_role ? 'bg-purple-100 text-purple-800' : 'bg-gray-100 text-gray-800'\n                            }`}>\n                              {role.is_system_role ? 'System' : 'Custom'}\n                            </span>\n                          </td>\n                          <td className=\"px-6 py-4 text-sm text-gray-500\">\n                            {formatDateHumanReadable(role.created_at)}\n                          </td>\n                          <td className=\"px-6 py-4 text-sm\">\n                            <button\n                              onClick={() => handleDeleteRole(role)}\n                              disabled={role.is_system_role || deletingRoleId === role.id}\n                              className=\"inline-flex items-center gap-2 text-red-600 hover:text-red-800 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors\"\n                              title={role.is_system_role ? 'Cannot delete system roles' : 'Delete role'}\n                            >\n                              <Trash2 size={16} />\n                              {deletingRoleId === role.id ? 'Deleting...' : 'Delete'}\n                            </button>\n                          </td>\n                        </tr>\n                      ))\n                    )}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          )}\n\n          {/* Permission Matrix View */}\n          {rolesView === 'matrix' && (\n            <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm p-8\">\n              <PermissionMatrix organisationId={organisationId} isAdmin={isCurrentUserAdmin} />\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Add User Modal */}\n      {showInviteModal && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6\">\n            <h2 className=\"text-xl font-bold mb-4\">ðŸ“§ Invite User</h2>\n            <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-6\">\n              Send an invitation email. The user will receive a welcome email with a link to create their account and join your organization.\n            </p>\n\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Email Address <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"email\"\n                  value={userFormData.email}\n                  onChange={(e) => setUserFormData({ ...userFormData, email: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                  placeholder=\"user@example.com\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Full Name (Optional)\n                </label>\n                <input\n                  type=\"text\"\n                  value={userFormData.full_name}\n                  onChange={(e) => setUserFormData({ ...userFormData, full_name: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                  placeholder=\"John Doe\"\n                />\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                  This will be pre-filled in the invitation email\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Assign Role (Optional)\n                </label>\n                <select\n                  value={userFormData.roleType}\n                  onChange={(e) => setUserFormData({ ...userFormData, roleType: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                >\n                  <option value=\"\">Select a role...</option>\n                  {roles.map(role => (\n                    <option key={role.id} value={role.id}>\n                      {role.name}\n                    </option>\n                  ))}\n                </select>\n              </div>\n\n              <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3\">\n                <p className=\"text-xs text-blue-700 dark:text-blue-300\">\n                  ðŸ’¡ The invitation will expire in <strong>7 days</strong>. The user will choose their username and password when they accept the invitation.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex justify-end gap-2 mt-6\">\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setShowInviteModal(false)\n                  setUserFormData({ email: '', username: '', password: '', full_name: '' })\n                }}\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={handleInviteUser}\n                disabled={!userFormData.email}\n              >\n                Send Invitation\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Create Role Modal */}\n      {showCreateRoleModal && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto\">\n            <h2 className=\"text-xl font-bold mb-4\">Create Custom Role</h2>\n            <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-6\">\n              Create a custom role with specific permissions for your organization.\n            </p>\n\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Role Name <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"text\"\n                  value={roleFormData.name}\n                  onChange={(e) => setRoleFormData({ ...roleFormData, name: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                  placeholder=\"e.g., QA Lead\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Role Type <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"text\"\n                  value={roleFormData.roleType}\n                  onChange={(e) => setRoleFormData({ ...roleFormData, roleType: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                  placeholder=\"e.g., qa_lead (lowercase, underscores)\"\n                />\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                  Use lowercase letters and underscores only (e.g., qa_lead, senior_qa_engineer)\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Description\n                </label>\n                <textarea\n                  value={roleFormData.description}\n                  onChange={(e) => setRoleFormData({ ...roleFormData, description: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                  rows={3}\n                  placeholder=\"Describe the responsibilities and access level of this role...\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Permissions (Optional)\n                </label>\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-3\">\n                  Select permissions by module. Each module has READ, WRITE, EXECUTE, and MANAGE permission levels.\n                </p>\n                <div className=\"border border-gray-300 dark:border-gray-600 rounded-md p-4 max-h-96 overflow-y-auto\">\n                  {permissions.length === 0 ? (\n                    <p className=\"text-sm text-gray-500 text-center py-4\">\n                      No permissions available. Run the module permissions initialization script first.\n                    </p>\n                  ) : (\n                    <div className=\"space-y-4\">\n                      {(() => {\n                        // Group permissions by module\n                        const moduleGroups = permissions.reduce((acc, permission) => {\n                          const module = permission.resource\n                          if (!acc[module]) {\n                            acc[module] = []\n                          }\n                          acc[module].push(permission)\n                          return acc\n                        }, {} as Record<string, typeof permissions>)\n\n                        // Module display names and icons\n                        const moduleConfig: Record<string, { name: string; icon: string; color: string }> = {\n                          automation_hub: { name: 'Automation Hub', icon: 'ðŸ¤–', color: 'blue' },\n                          api_testing: { name: 'API Testing', icon: 'ðŸ”Œ', color: 'green' },\n                          test_management: { name: 'Test Management', icon: 'ðŸ“‹', color: 'purple' },\n                          security_testing: { name: 'Security Testing', icon: 'ðŸ”’', color: 'red' },\n                          performance_testing: { name: 'Performance Testing', icon: 'âš¡', color: 'yellow' },\n                          mobile_testing: { name: 'Mobile Testing', icon: 'ðŸ“±', color: 'indigo' },\n                        }\n\n                        // Sort modules\n                        const sortedModules = Object.keys(moduleGroups).sort((a, b) => {\n                          const order = ['automation_hub', 'api_testing', 'test_management', 'security_testing', 'performance_testing', 'mobile_testing']\n                          return order.indexOf(a) - order.indexOf(b)\n                        })\n\n                        return sortedModules.map((module) => {\n                          const config = moduleConfig[module] || { name: module, icon: 'ðŸ“¦', color: 'gray' }\n                          const modulePerms = moduleGroups[module].sort((a, b) => {\n                            const order = ['read', 'write', 'execute', 'manage']\n                            return order.indexOf(a.action) - order.indexOf(b.action)\n                          })\n\n                          const colorClasses = {\n                            blue: 'bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800',\n                            green: 'bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800',\n                            purple: 'bg-purple-50 border-purple-200 dark:bg-purple-900/20 dark:border-purple-800',\n                            red: 'bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800',\n                            yellow: 'bg-yellow-50 border-yellow-200 dark:bg-yellow-900/20 dark:border-yellow-800',\n                            indigo: 'bg-indigo-50 border-indigo-200 dark:bg-indigo-900/20 dark:border-indigo-800',\n                            gray: 'bg-gray-50 border-gray-200 dark:bg-gray-900/20 dark:border-gray-800',\n                          }\n\n                          return (\n                            <div key={module} className={`border rounded-lg p-3 ${colorClasses[config.color as keyof typeof colorClasses]}`}>\n                              <div className=\"flex items-center gap-2 mb-3\">\n                                <span className=\"text-xl\">{config.icon}</span>\n                                <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                  {config.name}\n                                </h4>\n                                <span className=\"ml-auto text-xs text-gray-500 dark:text-gray-400\">\n                                  {modulePerms.filter(p => roleFormData.selectedPermissions.includes(p.id)).length}/{modulePerms.length} selected\n                                </span>\n                              </div>\n                              <div className=\"space-y-2\">\n                                {modulePerms.map((permission) => (\n                                  <label\n                                    key={permission.id}\n                                    className=\"flex items-start gap-2 p-2 hover:bg-white/50 dark:hover:bg-gray-800/50 rounded cursor-pointer\"\n                                  >\n                                    <input\n                                      type=\"checkbox\"\n                                      checked={roleFormData.selectedPermissions.includes(permission.id)}\n                                      onChange={(e) => {\n                                        if (e.target.checked) {\n                                          setRoleFormData({\n                                            ...roleFormData,\n                                            selectedPermissions: [...roleFormData.selectedPermissions, permission.id]\n                                          })\n                                        } else {\n                                          setRoleFormData({\n                                            ...roleFormData,\n                                            selectedPermissions: roleFormData.selectedPermissions.filter(id => id !== permission.id)\n                                          })\n                                        }\n                                      }}\n                                      className=\"mt-1 h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded\"\n                                    />\n                                    <div className=\"flex-1 min-w-0\">\n                                      <div className=\"text-sm font-medium text-gray-900 dark:text-white flex items-center gap-2\">\n                                        <span className=\"uppercase text-xs px-2 py-0.5 bg-white dark:bg-gray-700 rounded font-semibold\">\n                                          {permission.action}\n                                        </span>\n                                        <span className=\"truncate text-xs\">{permission.name}</span>\n                                      </div>\n                                      {permission.description && (\n                                        <div className=\"text-xs text-gray-600 dark:text-gray-400 mt-1\">\n                                          {permission.description}\n                                        </div>\n                                      )}\n                                    </div>\n                                  </label>\n                                ))}\n                              </div>\n                            </div>\n                          )\n                        })\n                      })()}\n                    </div>\n                  )}\n                </div>\n                {roleFormData.selectedPermissions.length > 0 && (\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-2\">\n                    âœ… {roleFormData.selectedPermissions.length} permission(s) selected across {\n                      new Set(permissions.filter(p => roleFormData.selectedPermissions.includes(p.id)).map(p => p.resource)).size\n                    } module(s)\n                  </p>\n                )}\n              </div>\n            </div>\n\n            <div className=\"flex justify-end gap-2 mt-6\">\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setShowCreateRoleModal(false)\n                  setRoleFormData({ name: '', roleType: '', description: '', selectedPermissions: [] })\n                }}\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={handleCreateRole}\n                disabled={!roleFormData.name || !roleFormData.roleType}\n              >\n                Create Role\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Project Assignment Modal */}\n      {showProjectAssignModal && selectedUserForProjects && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div>\n                <h2 className=\"text-xl font-bold text-gray-900 dark:text-white\">\n                  Manage Projects for {selectedUserForProjects.full_name || selectedUserForProjects.username}\n                </h2>\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                  Assign or remove this user from projects in your organization\n                </p>\n              </div>\n            </div>\n\n            <div className=\"space-y-3\">\n              {projects.length === 0 ? (\n                <div className=\"text-center py-12 text-gray-500\">\n                  No projects available. Create a project first.\n                </div>\n              ) : (\n                projects.map((project) => {\n                  const isAssigned = (userProjects[selectedUserForProjects.id] || [])\n                    .some(p => p.id === project.id)\n\n                  return (\n                    <div\n                      key={project.id}\n                      className={`flex items-center justify-between p-4 border rounded-lg transition-colors ${\n                        isAssigned\n                          ? 'border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-900/20'\n                          : 'border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50'\n                      }`}\n                    >\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"font-medium text-gray-900 dark:text-white\">\n                            {project.name}\n                          </div>\n                          {isAssigned && (\n                            <span className=\"px-2 py-0.5 text-xs bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-200 rounded-full\">\n                              Assigned\n                            </span>\n                          )}\n                        </div>\n                        {project.description && (\n                          <div className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                            {project.description}\n                          </div>\n                        )}\n                      </div>\n\n                      <div className=\"ml-4\">\n                        {isAssigned ? (\n                          <button\n                            onClick={() => handleRemoveFromProject(project.id)}\n                            className=\"px-4 py-2 text-sm bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/30 transition-colors font-medium\"\n                          >\n                            Remove\n                          </button>\n                        ) : (\n                          <button\n                            onClick={() => handleAssignToProject(project.id)}\n                            className=\"px-4 py-2 text-sm bg-primary text-white rounded-lg hover:opacity-90 transition-opacity font-medium\"\n                          >\n                            Assign\n                          </button>\n                        )}\n                      </div>\n                    </div>\n                  )\n                })\n              )}\n            </div>\n\n            <div className=\"flex items-center justify-between mt-6 pt-4 border-t border-gray-200 dark:border-gray-700\">\n              <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                {(userProjects[selectedUserForProjects.id] || []).length} of {projects.length} projects assigned\n              </div>\n              <button\n                onClick={() => {\n                  setShowProjectAssignModal(false)\n                  setSelectedUserForProjects(null)\n                }}\n                className=\"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\"\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Role Assignment Modal */}\n      {showAssignRoleModal && roleModalEntity && (\n        <RoleAssignmentModal\n          isOpen={showAssignRoleModal}\n          onClose={() => {\n            setShowAssignRoleModal(false)\n            setRoleModalEntity(null)\n            fetchData() // Refresh data after role changes\n          }}\n          organisationId={organisationId}\n          entityType={roleModalEntity.type}\n          entityId={roleModalEntity.id}\n          entityName={roleModalEntity.name}\n          availableProjects={projects}\n          initialRoleId={roleModalEntity.initialRoleId}\n          onRoleAssigned={fetchData} // Refresh data immediately after role assignment\n          onModalOpen={async () => {\n            // Refresh projects when modal opens to ensure latest projects are available\n            try {\n              const projectsResponse = await api.get('/api/v1/projects/', {\n                params: { organisation_id: organisationId }\n              })\n              setProjects(projectsResponse.data)\n            } catch (error) {\n              console.error('Error refreshing projects:', error)\n            }\n          }}\n        />\n      )}\n\n      {/* Delete Role Confirmation Dialog */}\n      {showDeleteRoleDialog && roleToDelete && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/20\">\n                <Trash2 className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">Delete Role</h3>\n              </div>\n            </div>\n            <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n              Are you sure you want to delete the role <strong>{roleToDelete.name}</strong>? This action cannot be undone.\n            </p>\n            <div className=\"flex gap-3 justify-end\">\n              <button\n                onClick={() => {\n                  setShowDeleteRoleDialog(false)\n                  setRoleToDelete(null)\n                }}\n                disabled={deletingRoleId !== null}\n                className=\"px-4 py-2 text-sm font-medium border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={confirmDeleteRole}\n                disabled={deletingRoleId !== null}\n                className=\"px-4 py-2 text-sm font-medium bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2\"\n              >\n                {deletingRoleId === roleToDelete.id ? (\n                  <>\n                    <span className=\"animate-spin\">â³</span>\n                    Deleting...\n                  </>\n                ) : (\n                  <>\n                    <Trash2 size={16} />\n                    Delete Role\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n        </div>\n      </main>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}