{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/auth-context.tsx"],"sourcesContent":["'use client'\n\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react'\nimport { useRouter } from 'next/navigation'\nimport axios from 'axios'\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000'\n\ninterface User {\n  id: string\n  email: string\n  username: string\n  full_name?: string\n  avatar_url?: string\n  is_active: boolean\n  is_superuser: boolean\n  created_at: string\n}\n\ninterface AuthContextType {\n  user: User | null\n  loading: boolean\n  login: (email: string, password: string) => Promise<void>\n  signup: (email: string, username: string, password: string, fullName?: string) => Promise<void>\n  logout: () => void\n  checkAuth: () => Promise<void>\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [loading, setLoading] = useState(true)\n  const router = useRouter()\n\n  const checkAuth = async () => {\n    const token = localStorage.getItem('access_token')\n    if (!token) {\n      setLoading(false)\n      return\n    }\n\n    try {\n      const response = await axios.get(`${API_URL}/api/v1/auth/me`, {\n        headers: { Authorization: `Bearer ${token}` }\n      })\n      setUser(response.data)\n    } catch (error) {\n      console.error('Auth check failed:', error)\n      localStorage.removeItem('access_token')\n      localStorage.removeItem('refresh_token')\n      setUser(null)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  useEffect(() => {\n    checkAuth()\n  }, [])\n\n  const login = async (email: string, password: string) => {\n    try {\n      const response = await axios.post(`${API_URL}/api/v1/auth/login`, {\n        email,\n        password\n      })\n\n      const { access_token, refresh_token } = response.data\n\n      localStorage.setItem('access_token', access_token)\n      if (refresh_token) {\n        localStorage.setItem('refresh_token', refresh_token)\n      }\n\n      // Fetch user data after successful login\n      const userResponse = await axios.get(`${API_URL}/api/v1/auth/me`, {\n        headers: { Authorization: `Bearer ${access_token}` }\n      })\n      setUser(userResponse.data)\n\n      // Fetch organizations to determine redirect\n      try {\n        const orgsResponse = await axios.get(`${API_URL}/api/v1/organisations/`, {\n          headers: { Authorization: `Bearer ${access_token}` }\n        })\n        const organisations = orgsResponse.data\n\n        if (organisations.length === 0) {\n          // No organizations - redirect to create first one\n          router.push('/organisations/new')\n        } else if (organisations.length === 1) {\n          // One organization - auto-select and go to projects\n          localStorage.setItem('current_organisation', JSON.stringify(organisations[0]))\n          router.push(`/organizations/${organisations[0].id}/projects`)\n        } else {\n          // Multiple organizations - show selection page\n          router.push('/organizations')\n        }\n      } catch (orgError) {\n        console.error('Failed to fetch organisations:', orgError)\n        // Fallback if org fetch fails\n        router.push('/organizations')\n      }\n    } catch (error: any) {\n      console.error('Login failed:', error)\n      throw new Error(error.response?.data?.detail || 'Login failed')\n    }\n  }\n\n  const signup = async (email: string, username: string, password: string, fullName?: string) => {\n    try {\n      const response = await axios.post(`${API_URL}/api/v1/auth/signup`, {\n        email,\n        username,\n        password,\n        full_name: fullName\n      })\n\n      const { access_token, refresh_token } = response.data\n\n      localStorage.setItem('access_token', access_token)\n      if (refresh_token) {\n        localStorage.setItem('refresh_token', refresh_token)\n      }\n\n      // Fetch user data after successful signup\n      const userResponse = await axios.get(`${API_URL}/api/v1/auth/me`, {\n        headers: { Authorization: `Bearer ${access_token}` }\n      })\n      setUser(userResponse.data)\n\n      // Fetch organizations to determine redirect\n      try {\n        const orgsResponse = await axios.get(`${API_URL}/api/v1/organisations/`, {\n          headers: { Authorization: `Bearer ${access_token}` }\n        })\n        const organisations = orgsResponse.data\n\n        if (organisations.length === 0) {\n          // No organizations - redirect to create first one\n          router.push('/organisations/new')\n        } else if (organisations.length === 1) {\n          // One organization - auto-select and go to projects\n          localStorage.setItem('current_organisation', JSON.stringify(organisations[0]))\n          router.push(`/organizations/${organisations[0].id}/projects`)\n        } else {\n          // Multiple organizations - show selection page\n          router.push('/organizations')\n        }\n      } catch (orgError) {\n        console.error('Failed to fetch organisations:', orgError)\n        // Fallback if org fetch fails\n        router.push('/organizations')\n      }\n    } catch (error: any) {\n      console.error('Signup failed:', error)\n      throw new Error(error.response?.data?.detail || 'Signup failed')\n    }\n  }\n\n  const logout = () => {\n    localStorage.removeItem('access_token')\n    localStorage.removeItem('refresh_token')\n    localStorage.removeItem('current_organisation')\n    localStorage.removeItem('current_project')\n    setUser(null)\n    router.push('/auth/signin')\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, loading, login, signup, logout, checkAuth }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 283, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/providers.tsx"],"sourcesContent":["'use client'\n\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query'\nimport { ThemeProvider } from 'next-themes'\nimport { Toaster } from 'sonner'\nimport { useState } from 'react'\nimport { AuthProvider } from '@/lib/auth-context'\n\nexport function Providers({ children }: { children: React.ReactNode }) {\n  const [queryClient] = useState(() => new QueryClient({\n    defaultOptions: {\n      queries: {\n        staleTime: 60 * 1000, // 1 minute\n        refetchOnWindowFocus: false,\n      },\n    },\n  }))\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider attribute=\"class\" defaultTheme=\"light\" enableSystem={false} forcedTheme=\"light\">\n        <AuthProvider>\n          {children}\n          <Toaster position=\"top-right\" richColors />\n        </AuthProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;AACA;AACA;AANA;;;;;;;AAQO,SAAS,UAAU,EAAE,QAAQ,EAAiC;IACnE,MAAM,CAAC,YAAY,GAAG,IAAA,iNAAQ,EAAC,IAAM,IAAI,4LAAW,CAAC;YACnD,gBAAgB;gBACd,SAAS;oBACP,WAAW,KAAK;oBAChB,sBAAsB;gBACxB;YACF;QACF;IAEA,qBACE,8OAAC,6MAAmB;QAAC,QAAQ;kBAC3B,cAAA,8OAAC,iKAAa;YAAC,WAAU;YAAQ,cAAa;YAAQ,cAAc;YAAO,aAAY;sBACrF,cAAA,8OAAC,mJAAY;;oBACV;kCACD,8OAAC,mJAAO;wBAAC,UAAS;wBAAY,UAAU;;;;;;;;;;;;;;;;;;;;;;AAKlD","debugId":null}}]
}