{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/utils.ts"],"sourcesContent":["import { type ClassValue, clsx } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB","debugId":null}},
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/ui/button.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Slot } from '@radix-ui/react-slot'\nimport { cva, type VariantProps } from 'class-variance-authority'\nimport { cn } from '@/lib/utils'\n\nconst buttonVariants = cva(\n  'inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50',\n  {\n    variants: {\n      variant: {\n        default: 'bg-primary text-primary-foreground hover:bg-primary/90',\n        destructive:\n          'bg-destructive text-destructive-foreground hover:bg-destructive/90',\n        outline:\n          'border border-input bg-background hover:bg-accent hover:text-accent-foreground',\n        secondary:\n          'bg-secondary text-secondary-foreground hover:bg-secondary/80',\n        ghost: 'hover:bg-accent hover:text-accent-foreground',\n        link: 'text-primary underline-offset-4 hover:underline',\n      },\n      size: {\n        default: 'h-10 px-4 py-2',\n        sm: 'h-9 rounded-md px-3',\n        lg: 'h-11 rounded-md px-8',\n        icon: 'h-10 w-10',\n      },\n    },\n    defaultVariants: {\n      variant: 'default',\n      size: 'default',\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : 'button'\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = 'Button'\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AACA;AACA;;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,0RACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,2KAAgB,MAC7B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAC9B,qBACE,6LAAC;QACC,WAAW,IAAA,iIAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 89, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/date-utils.ts"],"sourcesContent":["/**\n * Date formatting utilities for consistent date display across the application\n */\n\n/**\n * Format date to human-readable format: \"01 JAN 2025\"\n * @param date - Date string or Date object\n * @returns Formatted date string (e.g., \"01 JAN 2025\")\n */\nexport function formatDateHumanReadable(date: string | Date): string {\n  try {\n    const dateObj = typeof date === 'string' ? new Date(date) : date\n\n    if (isNaN(dateObj.getTime())) {\n      return 'Invalid date'\n    }\n\n    const day = String(dateObj.getDate()).padStart(2, '0')\n    const month = dateObj.toLocaleString('en-US', { month: 'short' }).toUpperCase()\n    const year = dateObj.getFullYear()\n\n    return `${day} ${month} ${year}`\n  } catch (error) {\n    console.error('Error formatting date:', error)\n    return 'Invalid date'\n  }\n}\n\n/**\n * Format date with time: \"01 JAN 2025, 10:30 AM\"\n * @param date - Date string or Date object\n * @returns Formatted date and time string\n */\nexport function formatDateWithTime(date: string | Date): string {\n  try {\n    const dateObj = typeof date === 'string' ? new Date(date) : date\n\n    if (isNaN(dateObj.getTime())) {\n      return 'Invalid date'\n    }\n\n    const day = String(dateObj.getDate()).padStart(2, '0')\n    const month = dateObj.toLocaleString('en-US', { month: 'short' }).toUpperCase()\n    const year = dateObj.getFullYear()\n    const time = dateObj.toLocaleString('en-US', {\n      hour: '2-digit',\n      minute: '2-digit',\n      hour12: true,\n    })\n\n    return `${day} ${month} ${year}, ${time}`\n  } catch (error) {\n    console.error('Error formatting date with time:', error)\n    return 'Invalid date'\n  }\n}\n\n/**\n * Format relative time: \"2 days ago\", \"3 minutes ago\"\n * @param date - Date string or Date object\n * @returns Relative time string\n */\nexport function formatRelativeTime(date: string | Date): string {\n  try {\n    const dateObj = typeof date === 'string' ? new Date(date) : date\n\n    if (isNaN(dateObj.getTime())) {\n      return 'Invalid date'\n    }\n\n    const now = new Date()\n    const diffMs = now.getTime() - dateObj.getTime()\n    const diffSecs = Math.floor(diffMs / 1000)\n    const diffMins = Math.floor(diffSecs / 60)\n    const diffHours = Math.floor(diffMins / 60)\n    const diffDays = Math.floor(diffHours / 24)\n    const diffWeeks = Math.floor(diffDays / 7)\n    const diffMonths = Math.floor(diffDays / 30)\n    const diffYears = Math.floor(diffDays / 365)\n\n    if (diffSecs < 60) return 'just now'\n    if (diffMins < 60) return `${diffMins} minute${diffMins > 1 ? 's' : ''} ago`\n    if (diffHours < 24) return `${diffHours} hour${diffHours > 1 ? 's' : ''} ago`\n    if (diffDays < 7) return `${diffDays} day${diffDays > 1 ? 's' : ''} ago`\n    if (diffWeeks < 4) return `${diffWeeks} week${diffWeeks > 1 ? 's' : ''} ago`\n    if (diffMonths < 12) return `${diffMonths} month${diffMonths > 1 ? 's' : ''} ago`\n    return `${diffYears} year${diffYears > 1 ? 's' : ''} ago`\n  } catch (error) {\n    console.error('Error formatting relative time:', error)\n    return 'Invalid date'\n  }\n}\n\n/**\n * Format date for API/database: \"2025-01-01\"\n * @param date - Date object or string\n * @returns ISO date string (YYYY-MM-DD)\n */\nexport function formatDateForAPI(date: string | Date): string {\n  try {\n    const dateObj = typeof date === 'string' ? new Date(date) : date\n\n    if (isNaN(dateObj.getTime())) {\n      return ''\n    }\n\n    return dateObj.toISOString().split('T')[0]\n  } catch (error) {\n    console.error('Error formatting date for API:', error)\n    return ''\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 190, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/layout/sidebar.tsx"],"sourcesContent":["'use client'\n\nimport Link from 'next/link'\nimport { usePathname } from 'next/navigation'\nimport {\n  LayoutDashboard,\n  ClipboardList,\n  Code,\n  Shield,\n  Zap,\n  Workflow,\n  ChevronLeft,\n  Menu,\n  FolderOpen,\n  BarChart3,\n  CreditCard,\n  Users,\n  Puzzle,\n  ChevronDown,\n  Building2,\n  Plus,\n  User,\n  Settings,\n  HelpCircle,\n  LogOut,\n  Check\n} from 'lucide-react'\nimport { useState, useEffect } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { useAuth } from '@/lib/auth-context'\nimport api from '@/lib/api'\nimport { toast } from 'sonner'\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000'\n\ninterface SidebarProps {\n  organisationId?: string\n  projectId?: string\n}\n\nconst getMainMenuItems = (organisationId?: string, isOwner?: boolean) => {\n  const allItems = [\n    {\n      name: 'Projects',\n      href: organisationId ? `/organizations/${organisationId}/projects` : '/projects',\n      icon: FolderOpen,\n      iconColor: 'text-blue-600',\n      bgColor: 'bg-blue-50',\n      allowMember: true, // Members can see this\n    },\n    {\n      name: 'Enterprise Reporting',\n      href: organisationId ? `/organizations/${organisationId}/enterprise-reporting` : '/enterprise-reporting',\n      icon: BarChart3,\n      iconColor: 'text-purple-600',\n      bgColor: 'bg-purple-50',\n      allowMember: false, // Only owners\n    },\n    {\n      name: 'Billing & Usage',\n      href: organisationId ? `/organizations/${organisationId}/billing` : '/billing',\n      icon: CreditCard,\n      iconColor: 'text-green-600',\n      bgColor: 'bg-green-50',\n      allowMember: false, // Only owners\n    },\n    {\n      name: 'Users & Teams',\n      href: organisationId ? `/organizations/${organisationId}/users-teams` : '/users-teams',\n      icon: Users,\n      iconColor: 'text-orange-600',\n      bgColor: 'bg-orange-50',\n      allowMember: false, // Only owners\n    },\n    {\n      name: 'Integrations',\n      href: organisationId ? `/organizations/${organisationId}/integrations` : '/integrations',\n      icon: Puzzle,\n      iconColor: 'text-pink-600',\n      bgColor: 'bg-pink-50',\n      allowMember: false, // Only owners\n    },\n    {\n      name: 'Settings',\n      href: organisationId ? `/organizations/${organisationId}/settings` : '/settings',\n      icon: Settings,\n      iconColor: 'text-gray-600',\n      bgColor: 'bg-gray-50',\n      allowMember: false, // Only owners\n    },\n  ]\n\n  // Filter items based on user role\n  if (isOwner) {\n    return allItems\n  } else {\n    // Members only see items where allowMember is true\n    return allItems.filter(item => item.allowMember)\n  }\n}\n\nconst otherMenuItems = []\n\ninterface Organisation {\n  id: string\n  name: string\n  website?: string\n  description?: string\n  owner_id: string\n  created_at: string\n  updated_at?: string\n}\n\nexport function Sidebar({ organisationId, projectId }: SidebarProps) {\n  const pathname = usePathname()\n  const router = useRouter()\n  const { user, logout } = useAuth()\n  const [isCollapsed, setIsCollapsed] = useState(false)\n  const [isMobileOpen, setIsMobileOpen] = useState(false)\n  const [currentOrganisation, setCurrentOrganisation] = useState<Organisation | null>(null)\n  const [organisations, setOrganisations] = useState<Organisation[]>([])\n  const [isProfileOpen, setIsProfileOpen] = useState(false)\n  const [isOwner, setIsOwner] = useState(false)\n\n  useEffect(() => {\n    const currentOrg = localStorage.getItem('current_organisation')\n    if (currentOrg) {\n      try {\n        setCurrentOrganisation(JSON.parse(currentOrg))\n      } catch (error) {\n        console.error('Failed to parse organisation from localStorage', error)\n      }\n    }\n    if (user) {\n      fetchOrganisations()\n    }\n  }, [user])\n\n  // Check if current user is the owner of the organization\n  useEffect(() => {\n    if (user && currentOrganisation) {\n      setIsOwner(currentOrganisation.owner_id === user.id)\n    }\n  }, [user, currentOrganisation])\n\n  const fetchOrganisations = async () => {\n    if (!user) return\n    try {\n      const response = await api.get('/api/v1/organisations/')\n      setOrganisations(response.data)\n    } catch (error) {\n      console.error('Failed to fetch organisations:', error)\n    }\n  }\n\n  const switchOrganisation = (org: Organisation) => {\n    setCurrentOrganisation(org)\n    localStorage.setItem('current_organisation', JSON.stringify(org))\n    window.dispatchEvent(new CustomEvent('organisationChanged', { detail: org }))\n    setIsProfileOpen(false)\n    // Refetch organizations after switching\n    setTimeout(() => fetchOrganisations(), 100)\n    router.push(`/organizations/${org.id}/projects`)\n  }\n\n  return (\n    <>\n      {/* Mobile Menu Button */}\n      <button\n        onClick={() => setIsMobileOpen(!isMobileOpen)}\n        className=\"lg:hidden fixed top-4 left-4 z-50 p-2 bg-white dark:bg-gray-800 rounded-lg shadow-md border border-gray-200 dark:border-gray-700\"\n      >\n        <Menu className=\"w-5 h-5 text-gray-600 dark:text-gray-400\" />\n      </button>\n\n      {/* Mobile Overlay */}\n      {isMobileOpen && (\n        <div\n          className=\"lg:hidden fixed inset-0 bg-black/50 z-40\"\n          onClick={() => setIsMobileOpen(false)}\n        />\n      )}\n\n      {/* Sidebar */}\n      <aside\n        className={`\n          fixed lg:sticky top-0 left-0 h-screen bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 z-40 transition-all duration-300\n          ${isCollapsed ? 'lg:w-20' : 'lg:w-64'}\n          ${isMobileOpen ? 'translate-x-0 w-64' : '-translate-x-full lg:translate-x-0'}\n        `}\n      >\n        <div className=\"flex flex-col h-full\">\n          {/* Profile Section */}\n          {!isCollapsed && user && currentOrganisation && (\n            <div className=\"p-4 relative\">\n              {/* Main Profile Button */}\n              <button\n                onClick={() => {\n                  setIsProfileOpen(!isProfileOpen)\n                  if (!isProfileOpen) {\n                    // Refetch organizations when opening the profile menu\n                    fetchOrganisations()\n                  }\n                }}\n                className={`w-full flex items-center gap-3 p-3 rounded-lg transition-all ${\n                  isProfileOpen\n                    ? 'border border-primary bg-primary/5 dark:bg-primary/10'\n                    : 'border border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700'\n                }`}\n              >\n                <div className=\"w-10 h-10 rounded-full bg-primary flex items-center justify-center flex-shrink-0\">\n                  <span className=\"text-sm font-semibold text-white\">\n                    {currentOrganisation.name.substring(0, 2).toUpperCase()}\n                  </span>\n                </div>\n                <div className=\"flex-1 min-w-0 text-left\">\n                  <p className=\"text-sm font-semibold text-gray-900 dark:text-white leading-tight line-clamp-1\">\n                    {currentOrganisation.name}\n                  </p>\n                  <p className=\"text-xs text-gray-500 dark:text-gray-400 uppercase tracking-wide mt-0.5\">\n                    {user.username}\n                  </p>\n                </div>\n                <ChevronDown\n                  className={`w-4 h-4 text-gray-400 flex-shrink-0 transition-transform ${\n                    isProfileOpen ? 'rotate-180' : ''\n                  }`}\n                />\n              </button>\n\n              {/* Profile Dropdown Details - Overlay */}\n              {isProfileOpen && (\n                <div className=\"absolute top-24 left-4 right-4 p-4 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 shadow-lg space-y-4 z-50\">\n                  {/* Organisations Section */}\n                  <div className=\"space-y-2\">\n                    <h3 className=\"text-sm font-semibold text-gray-600 dark:text-gray-400\">\n                      Organisations ({organisations.length})\n                    </h3>\n                    <div className=\"space-y-2 max-h-40 overflow-y-auto\">\n                      {organisations.map((org) => (\n                        <button\n                          key={org.id}\n                          onClick={() => switchOrganisation(org)}\n                          className=\"w-full flex items-center gap-2 p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-left\"\n                        >\n                          <Building2 className=\"w-4 h-4 text-gray-600 dark:text-gray-400 flex-shrink-0\" />\n                          <span className=\"text-sm text-gray-900 dark:text-white flex-1 truncate\">\n                            {org.name}\n                          </span>\n                          {currentOrganisation?.id === org.id && (\n                            <Check className=\"w-4 h-4 text-primary flex-shrink-0\" />\n                          )}\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n\n                  {/* Add Organisation - Only show for owners */}\n                  {isOwner && (\n                    <>\n                      <hr className=\"border-gray-200 dark:border-gray-700\" />\n                      <button\n                        onClick={() => {\n                          router.push('/organizations/new')\n                          setIsProfileOpen(false)\n                        }}\n                        className=\"w-full flex items-center gap-3 p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-left\"\n                      >\n                        <Plus className=\"w-4 h-4 text-gray-600 dark:text-gray-400\" />\n                        <span className=\"text-sm text-gray-900 dark:text-white\">Add Organisation</span>\n                      </button>\n                    </>\n                  )}\n\n                  <hr className=\"border-gray-200 dark:border-gray-700\" />\n\n                  {/* Edit Profile */}\n                  <button\n                    onClick={() => {\n                      router.push('/profile/edit')\n                      setIsProfileOpen(false)\n                    }}\n                    className=\"w-full flex items-center gap-3 p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-left\"\n                  >\n                    <User className=\"w-4 h-4 text-gray-600 dark:text-gray-400\" />\n                    <span className=\"text-sm text-gray-900 dark:text-white\">Edit profile</span>\n                  </button>\n\n                  {/* Account Settings */}\n                  <button\n                    onClick={() => {\n                      router.push('/account/settings')\n                      setIsProfileOpen(false)\n                    }}\n                    className=\"w-full flex items-center gap-3 p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-left\"\n                  >\n                    <Settings className=\"w-4 h-4 text-gray-600 dark:text-gray-400\" />\n                    <span className=\"text-sm text-gray-900 dark:text-white\">Account settings</span>\n                  </button>\n\n                  {/* Support */}\n                  <button\n                    onClick={() => {\n                      router.push('/support')\n                      setIsProfileOpen(false)\n                    }}\n                    className=\"w-full flex items-center gap-3 p-2 rounded-md hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors text-left\"\n                  >\n                    <HelpCircle className=\"w-4 h-4 text-gray-600 dark:text-gray-400\" />\n                    <span className=\"text-sm text-gray-900 dark:text-white\">Support</span>\n                  </button>\n\n                  <hr className=\"border-gray-200 dark:border-gray-700\" />\n\n                  {/* Sign Out */}\n                  <button\n                    onClick={() => {\n                      logout()\n                      setIsProfileOpen(false)\n                    }}\n                    className=\"w-full flex items-center gap-3 p-2 rounded-md hover:bg-red-100 dark:hover:bg-red-900/20 transition-colors text-left\"\n                  >\n                    <LogOut className=\"w-4 h-4 text-red-600 dark:text-red-400\" />\n                    <span className=\"text-sm text-red-600 dark:text-red-400 font-medium\">Sign out</span>\n                  </button>\n                </div>\n              )}\n            </div>\n          )}\n\n          {/* Close profile dropdown when clicking outside */}\n          {isProfileOpen && (\n            <div\n              className=\"fixed inset-0 z-40\"\n              onClick={() => setIsProfileOpen(false)}\n            />\n          )}\n\n          {/* Navigation */}\n          <nav className=\"flex-1 overflow-y-auto py-6 px-3\">\n            <div className=\"space-y-1 mb-6\">\n              {getMainMenuItems(currentOrganisation?.id, isOwner).map((item) => {\n                const isActive = pathname === item.href\n                const Icon = item.icon\n\n                return (\n                  <Link\n                    key={item.name}\n                    href={item.href}\n                    onClick={() => setIsMobileOpen(false)}\n                    className={`\n                      flex items-center gap-3 px-3 py-2.5 rounded-lg transition-all group\n                      ${\n                        isActive\n                          ? `${item.bgColor} text-gray-900 dark:text-white`\n                          : 'text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700'\n                      }\n                      ${isCollapsed ? 'justify-center' : ''}\n                    `}\n                  >\n                    <Icon\n                      className={`w-5 h-5 flex-shrink-0 ${item.iconColor}`}\n                    />\n                    {!isCollapsed && (\n                      <span className=\"font-medium text-sm\">{item.name}</span>\n                    )}\n                  </Link>\n                )\n              })}\n            </div>\n\n          </nav>\n\n          {/* Footer - Project Info */}\n          {!isCollapsed && projectId && (\n            <div className=\"p-4 border-t border-gray-200 dark:border-gray-700\">\n              <div className=\"text-xs text-gray-500 dark:text-gray-400 mb-1\">\n                Current Project\n              </div>\n              <div className=\"text-sm font-medium text-gray-900 dark:text-white truncate\">\n                Project Name\n              </div>\n            </div>\n          )}\n        </div>\n      </aside>\n    </>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 797, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/api/roles.ts"],"sourcesContent":["import api from './index'\n\nexport interface Permission {\n  id: string\n  name: string\n  description?: string\n  resource: string\n  action: string\n}\n\nexport interface ProjectRole {\n  id: string\n  name: string\n  description?: string\n  role_type: string\n  organisation_id: string\n  is_system_role: boolean\n  is_active: boolean\n  created_at: string\n  updated_at?: string\n}\n\nexport interface UserProjectRoleWithDetails {\n  id: string\n  user_id: string\n  role_id: string\n  project_id: string\n  role: ProjectRole\n  user?: {\n    username: string\n    email: string\n  }\n}\n\nexport interface GroupProjectRoleWithDetails {\n  id: string\n  group_id: string\n  role_id: string\n  project_id: string\n  role: ProjectRole\n  group?: {\n    name: string\n  }\n}\n\nexport async function listRoles(organisationId: string): Promise<{ roles: ProjectRole[] }> {\n  const response = await api.get(`/api/v1/roles/`, {\n    params: { organisation_id: organisationId }\n  })\n  return response.data\n}\n\nexport async function listUserRoles(userId: string, projectId: string): Promise<UserProjectRoleWithDetails[]> {\n  const response = await api.get(`/api/v1/roles/assignments/users`, {\n    params: { user_id: userId, project_id: projectId }\n  })\n  return response.data.assignments || []\n}\n\nexport async function listGroupRoles(groupId: string, projectId: string): Promise<GroupProjectRoleWithDetails[]> {\n  const response = await api.get(`/api/v1/roles/assignments/groups`, {\n    params: { group_id: groupId, project_id: projectId }\n  })\n  return response.data.assignments || []\n}\n\nexport async function assignRoleToUser(\n  userId: string,\n  roleId: string,\n  projectId: string\n): Promise<UserProjectRoleWithDetails> {\n  const response = await api.post('/api/v1/roles/assignments/users', {\n    user_id: userId,\n    role_id: roleId,\n    project_id: projectId\n  })\n  return response.data\n}\n\nexport async function assignRoleToGroup(\n  groupId: string,\n  roleId: string,\n  projectId: string\n): Promise<GroupProjectRoleWithDetails> {\n  const response = await api.post('/api/v1/roles/assignments/groups', {\n    group_id: groupId,\n    role_id: roleId,\n    project_id: projectId\n  })\n  return response.data\n}\n\nexport async function removeRoleFromUser(assignmentId: string): Promise<void> {\n  await api.delete(`/api/v1/roles/assignments/users/${assignmentId}`)\n}\n\nexport async function removeRoleFromGroup(assignmentId: string): Promise<void> {\n  await api.delete(`/api/v1/roles/assignments/groups/${assignmentId}`)\n}\n\nexport async function createRole(\n  organisationId: string,\n  name: string,\n  roleType: string,\n  description?: string,\n  permissions?: string[]\n): Promise<ProjectRole> {\n  const response = await api.post('/api/v1/roles/', {\n    organisation_id: organisationId,\n    name,\n    role_type: roleType,\n    description,\n    permissions: permissions || []\n  })\n  return response.data\n}\n\nexport async function deleteRole(roleId: string): Promise<void> {\n  await api.delete(`/api/v1/roles/${roleId}`)\n}\n\nexport async function listPermissions(): Promise<Permission[]> {\n  const response = await api.get('/api/v1/roles/permissions')\n  return response.data.permissions || []\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAAA;;AA6CO,eAAe,UAAU,cAAsB;IACpD,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC,CAAC,cAAc,CAAC,EAAE;QAC/C,QAAQ;YAAE,iBAAiB;QAAe;IAC5C;IACA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,cAAc,MAAc,EAAE,SAAiB;IACnE,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC,CAAC,+BAA+B,CAAC,EAAE;QAChE,QAAQ;YAAE,SAAS;YAAQ,YAAY;QAAU;IACnD;IACA,OAAO,SAAS,IAAI,CAAC,WAAW,IAAI,EAAE;AACxC;AAEO,eAAe,eAAe,OAAe,EAAE,SAAiB;IACrE,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC,CAAC,gCAAgC,CAAC,EAAE;QACjE,QAAQ;YAAE,UAAU;YAAS,YAAY;QAAU;IACrD;IACA,OAAO,SAAS,IAAI,CAAC,WAAW,IAAI,EAAE;AACxC;AAEO,eAAe,iBACpB,MAAc,EACd,MAAc,EACd,SAAiB;IAEjB,MAAM,WAAW,MAAM,6IAAG,CAAC,IAAI,CAAC,mCAAmC;QACjE,SAAS;QACT,SAAS;QACT,YAAY;IACd;IACA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,kBACpB,OAAe,EACf,MAAc,EACd,SAAiB;IAEjB,MAAM,WAAW,MAAM,6IAAG,CAAC,IAAI,CAAC,oCAAoC;QAClE,UAAU;QACV,SAAS;QACT,YAAY;IACd;IACA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,mBAAmB,YAAoB;IAC3D,MAAM,6IAAG,CAAC,MAAM,CAAC,CAAC,gCAAgC,EAAE,cAAc;AACpE;AAEO,eAAe,oBAAoB,YAAoB;IAC5D,MAAM,6IAAG,CAAC,MAAM,CAAC,CAAC,iCAAiC,EAAE,cAAc;AACrE;AAEO,eAAe,WACpB,cAAsB,EACtB,IAAY,EACZ,QAAgB,EAChB,WAAoB,EACpB,WAAsB;IAEtB,MAAM,WAAW,MAAM,6IAAG,CAAC,IAAI,CAAC,kBAAkB;QAChD,iBAAiB;QACjB;QACA,WAAW;QACX;QACA,aAAa,eAAe,EAAE;IAChC;IACA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,WAAW,MAAc;IAC7C,MAAM,6IAAG,CAAC,MAAM,CAAC,CAAC,cAAc,EAAE,QAAQ;AAC5C;AAEO,eAAe;IACpB,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC;IAC/B,OAAO,SAAS,IAAI,CAAC,WAAW,IAAI,EAAE;AACxC","debugId":null}},
    {"offset": {"line": 893, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/api/users.ts"],"sourcesContent":["import api from './index'\n\nexport interface User {\n  id: string\n  username: string\n  email: string\n  full_name?: string\n  is_active: boolean\n  created_at: string\n  updated_at?: string\n}\n\nexport async function listOrganisationUsers(organisationId: string): Promise<User[]> {\n  const response = await api.get(`/api/v1/organisations/${organisationId}/users`)\n  return response.data\n}\n\nexport async function getUserById(userId: string): Promise<User> {\n  const response = await api.get(`/api/v1/users/${userId}`)\n  return response.data\n}\n\nexport async function updateUser(userId: string, data: Partial<User>): Promise<User> {\n  const response = await api.put(`/api/v1/users/${userId}`, data)\n  return response.data\n}\n\nexport async function deleteUser(userId: string): Promise<void> {\n  await api.delete(`/api/v1/users/${userId}`)\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAYO,eAAe,sBAAsB,cAAsB;IAChE,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC,CAAC,sBAAsB,EAAE,eAAe,MAAM,CAAC;IAC9E,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,YAAY,MAAc;IAC9C,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC,CAAC,cAAc,EAAE,QAAQ;IACxD,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,WAAW,MAAc,EAAE,IAAmB;IAClE,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC,CAAC,cAAc,EAAE,QAAQ,EAAE;IAC1D,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,WAAW,MAAc;IAC7C,MAAM,6IAAG,CAAC,MAAM,CAAC,CAAC,cAAc,EAAE,QAAQ;AAC5C","debugId":null}},
    {"offset": {"line": 927, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/roles/role-assignment-modal.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { X, Shield, Trash2, Plus, AlertCircle } from 'lucide-react'\nimport { toast } from 'sonner'\nimport { formatDateHumanReadable } from '@/lib/date-utils'\nimport {\n  listRoles,\n  listUserRoles,\n  listGroupRoles,\n  assignRoleToUser,\n  assignRoleToGroup,\n  removeRoleFromUser,\n  removeRoleFromGroup,\n  type ProjectRole,\n  type UserProjectRoleWithDetails,\n  type GroupProjectRoleWithDetails\n} from '@/lib/api/roles'\n\ninterface RoleAssignmentModalProps {\n  isOpen: boolean\n  onClose: () => void\n  organisationId: string\n  projectId?: string\n  entityType: 'user' | 'group'\n  entityId: string\n  entityName: string\n  availableProjects?: Array<{ id: string; name: string }>\n  onRoleAssigned?: () => void | Promise<void>\n  onModalOpen?: () => void | Promise<void>\n}\n\nexport function RoleAssignmentModal({\n  isOpen,\n  onClose,\n  organisationId,\n  projectId: initialProjectId,\n  entityType,\n  entityId,\n  entityName,\n  availableProjects = [],\n  onRoleAssigned,\n  onModalOpen\n}: RoleAssignmentModalProps) {\n  const [loading, setLoading] = useState(false)\n  const [roles, setRoles] = useState<ProjectRole[]>([])\n  const [currentRoles, setCurrentRoles] = useState<(UserProjectRoleWithDetails | GroupProjectRoleWithDetails)[]>([])\n  const [selectedProjectId, setSelectedProjectId] = useState<string>(initialProjectId || '')\n  const [filterProjectId, setFilterProjectId] = useState<string>(initialProjectId || '')\n  const [selectedRoleId, setSelectedRoleId] = useState<string>('')\n  const [showAddRole, setShowAddRole] = useState(false)\n\n  // Fetch roles on modal open (independent of project selection)\n  useEffect(() => {\n    if (isOpen) {\n      // Call parent callback to refresh projects/data if needed\n      if (onModalOpen) {\n        onModalOpen()\n      }\n      fetchRoles()\n      fetchAllUserRoles() // Fetch all roles for this user across all projects\n    }\n  }, [isOpen, organisationId])\n\n  // Fetch current assignments when filter project changes\n  useEffect(() => {\n    if (isOpen && filterProjectId) {\n      fetchCurrentRoles()\n    }\n  }, [filterProjectId, entityId])\n\n  // Fetch all roles for this user across all projects\n  const fetchAllUserRoles = async () => {\n    try {\n      // Fetch from all projects to see where user already has roles\n      if (entityType === 'user' && availableProjects.length > 0) {\n        let allRoles: (UserProjectRoleWithDetails | GroupProjectRoleWithDetails)[] = []\n\n        for (const project of availableProjects) {\n          try {\n            const userRolesData = await listUserRoles(entityId, project.id)\n            allRoles = [...allRoles, ...userRolesData]\n          } catch (e) {\n            // Project might not have any roles for this user\n          }\n        }\n\n        setCurrentRoles(allRoles)\n      }\n    } catch (error: any) {\n      console.error('Error fetching all user roles:', error)\n    }\n  }\n\n  const fetchRoles = async () => {\n    setLoading(true)\n    try {\n      const rolesData = await listRoles(organisationId)\n      setRoles(rolesData.roles)\n    } catch (error: any) {\n      console.error('Error fetching roles:', error)\n      toast.error(error.message || 'Failed to load roles')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const fetchCurrentRoles = async () => {\n    if (!filterProjectId) return\n\n    try {\n      // Fetch current role assignments for the selected project\n      if (entityType === 'user') {\n        const userRolesData = await listUserRoles(entityId, filterProjectId)\n        setCurrentRoles(userRolesData)\n      } else {\n        const groupRolesData = await listGroupRoles(entityId, filterProjectId)\n        setCurrentRoles(groupRolesData)\n      }\n    } catch (error: any) {\n      console.error('Error fetching current roles:', error)\n      toast.error(error.message || 'Failed to load current roles')\n    }\n  }\n\n  const handleAssignRole = async () => {\n    const selectedRole = roles.find(r => r.id === selectedRoleId)\n    const isAdminRole = selectedRole?.role_type === 'administrator'\n\n    // Admin role only needs role selection\n    // Other roles require both role and project\n    if (!selectedRoleId) return\n    if (!isAdminRole && !selectedProjectId) return\n\n    try {\n      let projectToAssign = selectedProjectId\n\n      // Get list of projects where user already has roles\n      const projectsWithRoles = new Set(\n        currentRoles.map(role => {\n          // Extract project_id from currentRoles\n          return (role as any).project_id\n        })\n      )\n\n      // For admin role, if no project selected, find a project where user doesn't already have a role\n      if (isAdminRole && !projectToAssign && availableProjects.length > 0) {\n        // Find first project without a role assignment\n        const projectWithoutRole = availableProjects.find(\n          p => !projectsWithRoles.has(p.id)\n        )\n\n        if (projectWithoutRole) {\n          projectToAssign = projectWithoutRole.id\n        } else {\n          // All projects have roles, use the first one and suggest updating\n          projectToAssign = availableProjects[0].id\n          toast.warning('User already has roles in all projects. Attempting to assign as admin role (may need to remove existing role first).')\n        }\n      }\n\n      // For non-admin roles, check if selected project already has a role\n      if (!isAdminRole && selectedProjectId && projectsWithRoles.has(selectedProjectId)) {\n        // User already has a role on this project, try to find alternative\n        const projectWithoutRole = availableProjects.find(\n          p => !projectsWithRoles.has(p.id)\n        )\n\n        if (projectWithoutRole) {\n          // Auto-switch to project without role\n          projectToAssign = projectWithoutRole.id\n          toast.info(`User already has a role on \"${availableProjects.find(p => p.id === selectedProjectId)?.name || 'selected project'}\". Assigning to \"${projectWithoutRole.name}\" instead.`)\n        } else {\n          // All projects have roles for this user\n          toast.error('User already has a role on all projects. Please remove an existing role first, or assign an admin role for organization-wide access.')\n          return\n        }\n      }\n\n      if (!projectToAssign) {\n        toast.error('Please create a project first before assigning roles')\n        return\n      }\n\n      if (entityType === 'user') {\n        await assignRoleToUser(entityId, selectedRoleId, projectToAssign)\n      } else {\n        await assignRoleToGroup(entityId, selectedRoleId, projectToAssign)\n      }\n\n      toast.success('Role assigned successfully')\n      if (isAdminRole) {\n        toast.success('âœ… Admin user now has automatic access to all projects in this organization')\n      }\n      setSelectedRoleId('')\n      setSelectedProjectId('')\n      setShowAddRole(false)\n      // Refresh if viewing that project\n      if (filterProjectId === projectToAssign) {\n        await fetchCurrentRoles()\n      }\n      // Call parent callback to refresh data\n      if (onRoleAssigned) {\n        await onRoleAssigned()\n      }\n    } catch (error: any) {\n      toast.error(error.response?.data?.detail || error.message || 'Failed to assign role')\n    }\n  }\n\n  const handleRemoveRole = async (assignmentId: string) => {\n    if (!confirm('Are you sure you want to remove this role assignment?')) return\n\n    try {\n      if (entityType === 'user') {\n        await removeRoleFromUser(assignmentId)\n      } else {\n        await removeRoleFromGroup(assignmentId)\n      }\n\n      toast.success('Role removed successfully')\n      // Refresh roles after removal\n      await fetchAllUserRoles()\n      if (filterProjectId) {\n        await fetchCurrentRoles()\n      }\n    } catch (error: any) {\n      toast.error(error.message || 'Failed to remove role')\n    }\n  }\n\n  const getRoleBadgeColor = (roleType: string) => {\n    switch (roleType) {\n      case 'administrator':\n        return 'bg-red-100 text-red-800 border-red-200'\n      case 'project_manager':\n        return 'bg-purple-100 text-purple-800 border-purple-200'\n      case 'developer':\n        return 'bg-blue-100 text-blue-800 border-blue-200'\n      case 'tester':\n        return 'bg-green-100 text-green-800 border-green-200'\n      case 'viewer':\n        return 'bg-gray-100 text-gray-800 border-gray-200'\n      default:\n        return 'bg-cyan-100 text-cyan-800 border-cyan-200'\n    }\n  }\n\n  if (!isOpen) return null\n\n  return (\n    <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col\">\n        {/* Header */}\n        <div className=\"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700\">\n          <div className=\"flex items-center gap-3\">\n            <Shield className=\"w-6 h-6 text-primary\" />\n            <div>\n              <h2 className=\"text-xl font-bold text-gray-900 dark:text-white\">\n                Manage Roles - {entityName}\n              </h2>\n              <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                Assign and manage roles for this {entityType}\n              </p>\n            </div>\n          </div>\n          <button\n            onClick={onClose}\n            className=\"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors\"\n          >\n            <X className=\"w-5 h-5 text-gray-500\" />\n          </button>\n        </div>\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto p-6 space-y-6\">\n          {loading ? (\n            <div className=\"flex items-center justify-center py-12\">\n              <div className=\"text-gray-500\">Loading roles...</div>\n            </div>\n          ) : (\n            <>\n              {/* Assign Role Section - Always Visible */}\n              <div>\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                  Assign Role\n                </h3>\n\n                <div className=\"space-y-4\">\n                  {/* Role Selection */}\n                  <div>\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      Select Role\n                    </label>\n                    <select\n                      value={selectedRoleId}\n                      onChange={(e) => setSelectedRoleId(e.target.value)}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                    >\n                      <option value=\"\">Choose a role...</option>\n                      {roles.map((role) => (\n                        <option key={role.id} value={role.id}>\n                          {role.name} ({role.role_type.replace('_', ' ')})\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n\n                  {/* Project Selection for Assignment - Hidden for Admin Role */}\n                  {selectedRoleId && (() => {\n                    const selectedRole = roles.find(r => r.id === selectedRoleId)\n                    const isAdminRole = selectedRole?.role_type === 'administrator'\n\n                    if (isAdminRole) {\n                      return (\n                        <div className=\"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg\">\n                          <div className=\"flex items-start gap-3\">\n                            <Shield className=\"w-5 h-5 text-green-600 dark:text-green-400 flex-shrink-0 mt-0.5\" />\n                            <div>\n                              <p className=\"text-sm font-semibold text-green-800 dark:text-green-200 mb-1\">\n                                Admin Role - No Project Selection Needed\n                              </p>\n                              <p className=\"text-sm text-green-700 dark:text-green-300\">\n                                Admin users automatically have full access to all projects in this organization.\n                              </p>\n                            </div>\n                          </div>\n                        </div>\n                      )\n                    }\n\n                    // Get projects where user already has roles\n                    const projectsWithRoles = new Set(\n                      currentRoles.map(role => (role as any).project_id)\n                    )\n\n                    return (\n                      <div className=\"space-y-3\">\n                        <div>\n                          <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                            Select Project to Assign To\n                          </label>\n                          {availableProjects.length > 0 ? (\n                            <select\n                              value={selectedProjectId}\n                              onChange={(e) => setSelectedProjectId(e.target.value)}\n                              className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                            >\n                              <option value=\"\">Select a project...</option>\n                              {availableProjects.map((project) => (\n                                <option key={project.id} value={project.id}>\n                                  {project.name}\n                                  {projectsWithRoles.has(project.id) ? ' (already assigned)' : ''}\n                                </option>\n                              ))}\n                            </select>\n                          ) : (\n                            <div className=\"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg\">\n                              <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n                                âš ï¸ No projects available. Please create a project first before assigning roles.\n                              </p>\n                            </div>\n                          )}\n                        </div>\n\n                        {/* Warning: Projects with existing roles */}\n                        {projectsWithRoles.size > 0 && (\n                          <div className=\"p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg\">\n                            <p className=\"text-xs font-semibold text-amber-800 dark:text-amber-200 mb-2\">\n                              â„¹ï¸ User already has roles on:\n                            </p>\n                            <div className=\"flex flex-wrap gap-2\">\n                              {availableProjects\n                                .filter(p => projectsWithRoles.has(p.id))\n                                .map(p => (\n                                  <span\n                                    key={p.id}\n                                    className=\"inline-block px-2 py-1 text-xs bg-amber-200 text-amber-900 dark:bg-amber-800 dark:text-amber-100 rounded\"\n                                  >\n                                    {p.name}\n                                  </span>\n                                ))}\n                            </div>\n                            <p className=\"text-xs text-amber-700 dark:text-amber-300 mt-2\">\n                              System will automatically use a different project if you select one with an existing role.\n                            </p>\n                          </div>\n                        )}\n                      </div>\n                    )\n                  })()}\n\n\n                  {/* Role Preview */}\n                  {selectedRoleId && (\n                    <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4\">\n                      {(() => {\n                        const selectedRole = roles.find(r => r.id === selectedRoleId)\n                        if (!selectedRole) return null\n\n                        return (\n                          <div>\n                            <div className=\"flex items-center gap-2 mb-2\">\n                              <Shield className=\"w-5 h-5 text-blue-600\" />\n                              <span className=\"font-semibold text-blue-900 dark:text-blue-100\">\n                                {selectedRole.name}\n                              </span>\n                              <span className={`px-2 py-0.5 text-xs font-semibold rounded-full border ${getRoleBadgeColor(selectedRole.role_type)}`}>\n                                {selectedRole.role_type.replace('_', ' ')}\n                              </span>\n                            </div>\n                            {selectedRole.description && (\n                              <p className=\"text-sm text-blue-700 dark:text-blue-200\">\n                                {selectedRole.description}\n                              </p>\n                            )}\n                          </div>\n                        )\n                      })()}\n                    </div>\n                  )}\n\n                  {/* Assign Button */}\n                  {(() => {\n                    const selectedRole = roles.find(r => r.id === selectedRoleId)\n                    const isAdminRole = selectedRole?.role_type === 'administrator'\n                    // Admin role only needs role selection, others need both role and project\n                    const isEnabled = selectedRoleId && (isAdminRole || selectedProjectId)\n\n                    return (\n                      <Button\n                        onClick={handleAssignRole}\n                        disabled={!isEnabled}\n                        className=\"w-full\"\n                      >\n                        Assign Role\n                      </Button>\n                    )\n                  })()}\n                </div>\n              </div>\n\n              {/* Current Role Assignments */}\n              <div className=\"border-t border-gray-200 dark:border-gray-700 pt-6\">\n                <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-4\">\n                  Current Roles\n                </h3>\n\n                {/* Show all current roles */}\n                {currentRoles.length > 0 ? (\n                  <div className=\"space-y-3 mb-4\">\n                    {currentRoles.map((roleAssignment) => {\n                      const roleName = (roleAssignment as any).role?.name || (roleAssignment as any).role_name || 'Unknown Role'\n                      const roleType = (roleAssignment as any).role?.role_type || (roleAssignment as any).role_type || 'system'\n                      const projectId = (roleAssignment as any).project_id\n                      const projectName = availableProjects.find(p => p.id === projectId)?.name || 'Unknown Project'\n\n                      return (\n                        <div\n                          key={roleAssignment.id}\n                          className=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600\"\n                        >\n                          <div className=\"flex-1\">\n                            <div className=\"flex items-center gap-2 mb-1\">\n                              <span className=\"font-medium text-gray-900 dark:text-white\">\n                                {roleName}\n                              </span>\n                              <span className={`px-2 py-0.5 text-xs font-semibold rounded-full border ${getRoleBadgeColor(roleType)}`}>\n                                {roleType.replace('_', ' ')}\n                              </span>\n                            </div>\n                            <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                              Project: {projectName}\n                            </p>\n                          </div>\n                          <button\n                            onClick={() => handleRemoveRole(roleAssignment.id)}\n                            className=\"ml-4 p-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors\"\n                            title=\"Remove role\"\n                          >\n                            <Trash2 size={16} />\n                          </button>\n                        </div>\n                      )\n                    })}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-8 bg-gray-50 dark:bg-gray-700/50 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600\">\n                    <Shield className=\"w-12 h-12 mx-auto mb-3 text-gray-400\" />\n                    <p className=\"text-sm text-gray-600 dark:text-gray-400\">No roles assigned yet</p>\n                  </div>\n                )}\n\n                {/* Project Filter for Viewing Specific Project Roles */}\n                {availableProjects.length > 0 && (\n                  <div className=\"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700\">\n                    <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                      View roles by project (optional)\n                    </label>\n                    <select\n                      value={filterProjectId}\n                      onChange={(e) => {\n                        setFilterProjectId(e.target.value)\n                        if (e.target.value) {\n                          fetchCurrentRoles()\n                        }\n                      }}\n                      className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                    >\n                      <option value=\"\">All projects</option>\n                      {availableProjects.map((project) => (\n                        <option key={project.id} value={project.id}>\n                          {project.name}\n                        </option>\n                      ))}\n                    </select>\n                  </div>\n                )}\n\n                {filterProjectId && currentRoles.length === 0 ? (\n                  <div className=\"text-center py-8 bg-gray-50 dark:bg-gray-700/50 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600\">\n                    <Shield className=\"w-12 h-12 mx-auto mb-3 text-gray-400\" />\n                    <p className=\"text-gray-500 dark:text-gray-400\">\n                      No roles assigned yet for this project\n                    </p>\n                  </div>\n                ) : (\n                  <div className=\"space-y-3\">\n                    {currentRoles.map((assignment) => (\n                      <div\n                        key={assignment.id}\n                        className=\"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600\"\n                      >\n                        <div className=\"flex items-center gap-3\">\n                          <Shield className=\"w-5 h-5 text-gray-400\" />\n                          <div>\n                            <div className=\"flex items-center gap-2\">\n                              <span className=\"font-medium text-gray-900 dark:text-white\">\n                                {(assignment as any).role?.name || (assignment as any).role_name}\n                              </span>\n                              <span className={`px-2 py-0.5 text-xs font-semibold rounded-full border ${getRoleBadgeColor((assignment as any).role?.role_type || (assignment as any).role_type)}`}>\n                                {((assignment as any).role?.role_type || (assignment as any).role_type).replace('_', ' ')}\n                              </span>\n                            </div>\n                          </div>\n                        </div>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => handleRemoveRole(assignment.id)}\n                          className=\"text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-900/20\"\n                        >\n                          <Trash2 className=\"w-4 h-4\" />\n                        </Button>\n                      </div>\n                    ))}\n                  </div>\n                )}\n              </div>\n            </>\n          )}\n        </div>\n\n        {/* Footer */}\n        <div className=\"flex items-center justify-end gap-2 p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800\">\n          <Button variant=\"outline\" onClick={onClose}>\n            Close\n          </Button>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1863, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/api/invitations.ts"],"sourcesContent":["import api from './index'\n\nexport interface Invitation {\n  id: string\n  email: string\n  token: string\n  organisation_id: string\n  invited_by: string\n  expiry_date: string\n  accepted_at?: string\n  created_at: string\n}\n\nexport async function createInvitation(data: {\n  email: string\n  full_name?: string\n  organisation_id: string\n  expiry_days?: number\n}): Promise<Invitation> {\n  const response = await api.post('/api/v1/invitations/', data)\n  return response.data\n}\n\nexport async function listInvitations(organisationId: string): Promise<Invitation[]> {\n  const response = await api.get(`/api/v1/invitations/`, {\n    params: { organisation_id: organisationId }\n  })\n  return response.data\n}\n\nexport async function cancelInvitation(invitationId: string): Promise<void> {\n  await api.delete(`/api/v1/invitations/${invitationId}`)\n}\n\nexport async function acceptInvitation(token: string, data: {\n  username: string\n  password: string\n}): Promise<{ access_token: string; refresh_token: string }> {\n  const response = await api.post('/api/v1/invitations/accept', {\n    token,\n    ...data\n  })\n  return response.data\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;AAaO,eAAe,iBAAiB,IAKtC;IACC,MAAM,WAAW,MAAM,6IAAG,CAAC,IAAI,CAAC,wBAAwB;IACxD,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,gBAAgB,cAAsB;IAC1D,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC,CAAC,oBAAoB,CAAC,EAAE;QACrD,QAAQ;YAAE,iBAAiB;QAAe;IAC5C;IACA,OAAO,SAAS,IAAI;AACtB;AAEO,eAAe,iBAAiB,YAAoB;IACzD,MAAM,6IAAG,CAAC,MAAM,CAAC,CAAC,oBAAoB,EAAE,cAAc;AACxD;AAEO,eAAe,iBAAiB,KAAa,EAAE,IAGrD;IACC,MAAM,WAAW,MAAM,6IAAG,CAAC,IAAI,CAAC,8BAA8B;QAC5D;QACA,GAAG,IAAI;IACT;IACA,OAAO,SAAS,IAAI;AACtB","debugId":null}},
    {"offset": {"line": 1904, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/ui/checkbox.tsx"],"sourcesContent":["import * as React from 'react'\nimport { Check } from 'lucide-react'\nimport { cn } from '@/lib/utils'\n\ninterface CheckboxProps extends React.InputHTMLAttributes<HTMLInputElement> {\n  checked?: boolean\n  onCheckedChange?: (checked: boolean) => void\n}\n\nconst Checkbox = React.forwardRef<HTMLInputElement, CheckboxProps>(\n  ({ className, onCheckedChange, checked, onChange, ...props }, ref) => {\n    const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n      if (onCheckedChange) {\n        onCheckedChange(e.target.checked)\n      }\n      if (onChange) {\n        onChange(e)\n      }\n    }\n\n    return (\n      <div className=\"relative inline-flex\">\n        <input\n          type=\"checkbox\"\n          ref={ref}\n          checked={checked}\n          onChange={handleChange}\n          className=\"sr-only\"\n          {...props}\n        />\n        <div\n          className={cn(\n            'h-5 w-5 rounded border border-gray-300 dark:border-gray-600 flex items-center justify-center transition-all',\n            checked\n              ? 'bg-blue-600 border-blue-600 dark:bg-blue-600 dark:border-blue-600'\n              : 'bg-white dark:bg-gray-800 hover:border-gray-400 dark:hover:border-gray-500',\n            props.disabled && 'opacity-50 cursor-not-allowed',\n            className\n          )}\n        >\n          {checked && <Check className=\"w-4 h-4 text-white\" strokeWidth={3} />}\n        </div>\n      </div>\n    )\n  }\n)\n\nCheckbox.displayName = 'Checkbox'\n\nexport { Checkbox }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAOA,MAAM,yBAAW,2KAAgB,MAC/B,CAAC,EAAE,SAAS,EAAE,eAAe,EAAE,OAAO,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE;IAC5D,MAAM,eAAe,CAAC;QACpB,IAAI,iBAAiB;YACnB,gBAAgB,EAAE,MAAM,CAAC,OAAO;QAClC;QACA,IAAI,UAAU;YACZ,SAAS;QACX;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBACC,MAAK;gBACL,KAAK;gBACL,SAAS;gBACT,UAAU;gBACV,WAAU;gBACT,GAAG,KAAK;;;;;;0BAEX,6LAAC;gBACC,WAAW,IAAA,iIAAE,EACX,+GACA,UACI,sEACA,8EACJ,MAAM,QAAQ,IAAI,iCAClB;0BAGD,yBAAW,6LAAC,gNAAK;oBAAC,WAAU;oBAAqB,aAAa;;;;;;;;;;;;;;;;;AAIvE;;AAGF,SAAS,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 1975, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/settings/permission-matrix.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState, Fragment } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { Checkbox } from '@/components/ui/checkbox'\nimport { toast } from 'sonner'\nimport api from '@/lib/api'\nimport { Loader2, Save, RotateCcw } from 'lucide-react'\n\ninterface Permission {\n  id: string\n  name: string\n  resource: string\n  action: string\n  description?: string\n}\n\ninterface Role {\n  id: string\n  name: string\n  description?: string\n  permission_count?: number\n  permissions?: Permission[]\n}\n\ninterface PermissionMatrixProps {\n  organisationId: string\n  isAdmin?: boolean\n}\n\ninterface RolePermissionMap {\n  [roleId: string]: string[]\n}\n\n// Group permissions by resource for better organization\nconst PERMISSION_GROUPS = {\n  'User Management': ['user_read_access', 'user_write_access', 'user_delete_access'],\n  'Role Management': ['role_read_access', 'role_write_access', 'role_delete_access'],\n  'Project Management': ['project_read_access', 'project_write_access', 'project_delete_access'],\n  'Settings': ['settings_read_access', 'settings_write_access'],\n  'Organization': ['organization_manage_access'],\n  'Test Case Management': [\n    'test_case_read_access', 'test_case_write_access', 'test_case_delete_access', 'test_case_execute_access',\n  ],\n  'Security Testing': [\n    'security_test_read_access', 'security_test_write_access', 'security_test_delete_access', 'security_test_execute_access',\n  ],\n  'API Testing': [\n    'api_test_read_access', 'api_test_write_access', 'api_test_delete_access', 'api_test_execute_access',\n  ],\n  'Automation Hub': [\n    'automation_read_access', 'automation_write_access', 'automation_delete_access', 'automation_execute_access',\n  ],\n}\n\n// Permission matrix definition - which roles have which permissions\n// Based on role permission specification: Owner/Admin have full access, others have graduated access levels\nconst PERMISSION_MATRIX: Record<string, Record<string, boolean>> = {\n  // User Management\n  'user_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'user_write_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'user_delete_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  // Role Management\n  'role_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'role_write_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'role_delete_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  // Project Management\n  'project_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'project_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'project_delete_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  // Settings\n  'settings_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'settings_write_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  // Organization\n  'organization_manage_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  // Test Case Management\n  'test_case_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'test_case_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'test_case_delete_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'test_case_execute_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // Security Testing\n  'security_test_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'security_test_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'security_test_delete_access': { 'owner': true, 'admin': true, 'qa_manager': false, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'security_test_execute_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // API Testing\n  'api_test_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'api_test_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  'api_test_delete_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'api_test_execute_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n  // Automation Hub\n  'automation_read_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': true, 'viewer': true },\n  'automation_write_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'automation_delete_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': false, 'qa_engineer': false, 'product_owner': false, 'viewer': false },\n  'automation_execute_access': { 'owner': true, 'admin': true, 'qa_manager': true, 'qa_lead': true, 'qa_engineer': true, 'product_owner': false, 'viewer': false },\n}\n\nexport function PermissionMatrix({ organisationId, isAdmin = false }: PermissionMatrixProps) {\n  const [roles, setRoles] = useState<Role[]>([])\n  const [permissions, setPermissions] = useState<Permission[]>([])\n  const [loading, setLoading] = useState(true)\n  const [saving, setSaving] = useState(false)\n  const [rolePermissions, setRolePermissions] = useState<RolePermissionMap>({})\n  const [originalRolePermissions, setOriginalRolePermissions] = useState<RolePermissionMap>({})\n  const [permissionGroups, setPermissionGroups] = useState<Record<string, string[]>>(PERMISSION_GROUPS)\n  const [enabledModules, setEnabledModules] = useState<string[]>([])\n\n  useEffect(() => {\n    fetchData()\n  }, [organisationId])\n\n  const fetchData = async () => {\n    setLoading(true)\n    try {\n      // Fetch roles\n      const rolesResponse = await api.get('/api/v1/roles/', {\n        params: { organisation_id: organisationId }\n      })\n      const rolesList = rolesResponse.data.roles || []\n      setRoles(rolesList)\n\n      // Fetch dynamic permissions based on enabled modules\n      let permsList: Permission[] = []\n      try {\n        const dynamicResponse = await api.get(`/api/v1/roles/dynamic/${organisationId}`)\n        const { permission_groups, all_permissions, enabled_modules } = dynamicResponse.data\n\n        // Use dynamic permission groups if available\n        if (permission_groups) {\n          setPermissionGroups(permission_groups)\n        }\n\n        // Set enabled modules for reference\n        if (enabled_modules) {\n          setEnabledModules(enabled_modules)\n        }\n\n        // Use all permissions including dynamic ones\n        permsList = all_permissions || []\n        setPermissions(permsList)\n      } catch (dynamicError) {\n        // Fallback to static permissions if dynamic endpoint fails\n        console.warn('Could not fetch dynamic permissions, using static permissions:', dynamicError)\n        const permsResponse = await api.get('/api/v1/roles/permissions')\n        permsList = permsResponse.data.permissions || []\n        setPermissions(permsList)\n      }\n\n      // Initialize role-permission mapping based on PERMISSION_MATRIX ONLY\n      // Important: We ignore any permissions from the API and use ONLY PERMISSION_MATRIX\n      const permMap: RolePermissionMap = {}\n\n      rolesList.forEach((role: Role) => {\n        const rolePerms: string[] = []\n\n        // For each permission, check if it should be granted to this role based on PERMISSION_MATRIX\n        permsList.forEach((perm: Permission) => {\n          const shouldHavePermission = PERMISSION_MATRIX[perm.name]?.[role.role_type] ?? false\n          if (shouldHavePermission) {\n            rolePerms.push(perm.id)\n          }\n        })\n\n        console.log(`âœ… Role \"${role.name}\" (${role.role_type}): ${rolePerms.length}/${permsList.length} permissions`)\n        permMap[role.id] = rolePerms\n      })\n\n      // Force state reset to ensure clean state\n      setRolePermissions({})\n      // Then set the correct permissions\n      setTimeout(() => {\n        setRolePermissions(permMap)\n        setOriginalRolePermissions(JSON.parse(JSON.stringify(permMap)))\n      }, 0)\n    } catch (error: any) {\n      console.error('Failed to fetch data:', error)\n      toast.error('Failed to load roles and permissions')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const togglePermission = (roleId: string, permissionId: string) => {\n    if (!isAdmin) return\n\n    setRolePermissions(prev => {\n      const newMap = { ...prev }\n      const rolePerms = [...(newMap[roleId] || [])]\n      const index = rolePerms.indexOf(permissionId)\n      if (index > -1) {\n        rolePerms.splice(index, 1)\n      } else {\n        rolePerms.push(permissionId)\n      }\n      newMap[roleId] = rolePerms\n      return newMap\n    })\n  }\n\n  const hasChanges = () => {\n    return Object.keys(rolePermissions).some(\n      roleId => {\n        const original = Array.from(originalRolePermissions[roleId] || []).sort()\n        const current = Array.from(rolePermissions[roleId] || []).sort()\n        return JSON.stringify(original) !== JSON.stringify(current)\n      }\n    )\n  }\n\n  const savePermissions = async () => {\n    setSaving(true)\n    try {\n      // Update each role with its new permissions\n      for (const role of roles) {\n        const permIds = Array.from(rolePermissions[role.id] || [])\n        await api.put(`/api/v1/roles/${role.id}`, {\n          permission_ids: permIds\n        })\n      }\n      toast.success('Permissions updated successfully!')\n      setOriginalRolePermissions(JSON.parse(JSON.stringify(rolePermissions)))\n    } catch (error: any) {\n      console.error('Failed to save permissions:', error)\n      toast.error(error.response?.data?.detail || 'Failed to save permissions')\n    } finally {\n      setSaving(false)\n    }\n  }\n\n  const resetChanges = () => {\n    setRolePermissions(JSON.parse(JSON.stringify(originalRolePermissions)))\n    toast.info('Changes discarded')\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center py-12\">\n        <Loader2 className=\"w-6 h-6 animate-spin text-primary\" />\n        <span className=\"ml-2\">Loading permission matrix...</span>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div>\n        <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\n          Role Permissions Matrix\n        </h3>\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n          Configure permissions for each role. Check the boxes to grant permissions.\n        </p>\n        {!isAdmin && (\n          <p className=\"text-sm text-orange-600 dark:text-orange-400 mt-2\">\n            Only administrators can modify role permissions.\n          </p>\n        )}\n      </div>\n\n      {/* Controls */}\n      <div className=\"flex gap-3 justify-end\">\n        <Button\n          variant=\"outline\"\n          onClick={resetChanges}\n          disabled={!hasChanges() || saving || !isAdmin}\n          className=\"gap-2\"\n        >\n          <RotateCcw className=\"w-4 h-4\" />\n          Discard Changes\n        </Button>\n        <Button\n          onClick={savePermissions}\n          disabled={!hasChanges() || saving || !isAdmin}\n          className=\"gap-2 bg-blue-600 hover:bg-blue-700\"\n        >\n          {saving ? (\n            <>\n              <Loader2 className=\"w-4 h-4 animate-spin\" />\n              Saving...\n            </>\n          ) : (\n            <>\n              <Save className=\"w-4 h-4\" />\n              Save Changes\n            </>\n          )}\n        </Button>\n      </div>\n\n      {/* Permission Matrix */}\n      <div className=\"border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden bg-white dark:bg-gray-800\">\n        <div className=\"overflow-x-auto\">\n          <table className=\"w-full text-sm border-collapse\" style={{ tableLayout: 'fixed' }}>\n            {/* Header */}\n            <thead>\n              <tr className=\"bg-gray-50 dark:bg-gray-900 border-b border-gray-200 dark:border-gray-700\">\n                <th className=\"px-3 py-3 text-left font-semibold text-gray-900 dark:text-white sticky left-0 bg-gray-50 dark:bg-gray-900 z-10\" style={{ width: '192px' }}>\n                  Permission\n                </th>\n                {roles.map(role => (\n                  <th\n                    key={role.id}\n                    className=\"px-2 py-3 text-center font-semibold text-gray-900 dark:text-white whitespace-nowrap align-middle\"\n                    style={{ width: '120px' }}\n                  >\n                    <div className=\"truncate text-xs\" title={role.name}>\n                      {role.name}\n                    </div>\n                  </th>\n                ))}\n              </tr>\n            </thead>\n\n            {/* Body */}\n            <tbody>\n              {Object.entries(permissionGroups).map(([groupName, permNames]) => {\n                return (\n                  <Fragment key={groupName}>\n                    {/* Group Header */}\n                    <tr className=\"bg-blue-50 dark:bg-blue-900/20 border-b border-gray-200 dark:border-gray-700\">\n                      <td\n                        colSpan={roles.length + 1}\n                        className=\"px-3 py-2 text-sm font-bold text-blue-900 dark:text-blue-200 sticky left-0 bg-blue-50 dark:bg-blue-900/20 z-10\"\n                      >\n                        {groupName}\n                      </td>\n                    </tr>\n\n                    {/* Permission rows */}\n                    {permNames.map((permName, idx) => {\n                      // Find the permission by name\n                      const perm = permissions.find(p => p.name === permName)\n                      if (!perm) return null\n\n                      return (\n                        <tr\n                          key={`${groupName}-${permName}-${idx}`}\n                          className=\"border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50\"\n                        >\n                          <td className=\"px-3 py-3 text-gray-900 dark:text-white sticky left-0 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700/50 z-10 align-middle\" style={{ width: '192px' }}>\n                            <div>\n                              <div className=\"font-medium text-xs truncate\" title={perm.name}>{perm.name}</div>\n                              <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-0.5 hidden sm:block truncate\" title={perm.description || `${perm.action} ${perm.resource}`}>\n                                {perm.description || `${perm.action} ${perm.resource}`}\n                              </div>\n                            </div>\n                          </td>\n                          {roles.map(role => {\n                            const isChecked = (rolePermissions[role.id] || []).includes(perm.id)\n                            return (\n                              <td\n                                key={`${role.id}-${perm.id}`}\n                                className=\"px-2 py-3 text-center align-middle\"\n                                style={{ width: '120px' }}\n                              >\n                                <div className=\"flex items-center justify-center h-full\">\n                                  <Checkbox\n                                    key={`${role.id}-${perm.id}-${isChecked}`}\n                                    checked={isChecked}\n                                    onCheckedChange={() =>\n                                      togglePermission(role.id, perm.id)\n                                    }\n                                    className=\"w-4 h-4\"\n                                    disabled={saving || !isAdmin}\n                                  />\n                                </div>\n                              </td>\n                            )\n                          })}\n                        </tr>\n                      )\n                    })}\n                  </Fragment>\n                )\n              })}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* Summary */}\n      <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-3\">\n        {roles.map(role => (\n          <div\n            key={role.id}\n            className=\"p-3 border border-gray-200 dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-800\"\n          >\n            <div className=\"text-xs font-semibold text-gray-900 dark:text-white mb-1 truncate\" title={role.name}>\n              {role.name}\n            </div>\n            <div className=\"text-xl font-bold text-blue-600 dark:text-blue-400\">\n              {(rolePermissions[role.id] || []).length}\n            </div>\n            <div className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n              assigned\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {/* Change indicator */}\n      {hasChanges() && (\n        <div className=\"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg\">\n          <p className=\"text-sm text-yellow-800 dark:text-yellow-200\">\n            You have unsaved changes. Click \"Save Changes\" to apply them.\n          </p>\n        </div>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2819, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/app/organizations/%5Buuid%5D/users-teams/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport { Button } from '@/components/ui/button'\nimport { PlusCircle, User, Users, Search, Pencil, Trash2, UserPlus, Shield, Plus } from 'lucide-react'\nimport { useParams } from 'next/navigation'\nimport { toast } from 'sonner'\nimport { formatDateHumanReadable } from '@/lib/date-utils'\nimport { Sidebar } from '@/components/layout/sidebar'\nimport {\n  listRoles,\n  listUserRoles,\n  assignRoleToUser,\n  removeRoleFromUser,\n  createRole,\n  deleteRole,\n  listPermissions,\n  type ProjectRole,\n  type UserProjectRoleWithDetails,\n  type Permission\n} from '@/lib/api/roles'\nimport { listOrganisationUsers, type User as UserType } from '@/lib/api/users'\nimport { RoleAssignmentModal } from '@/components/roles/role-assignment-modal'\nimport { createInvitation } from '@/lib/api/invitations'\nimport { PermissionMatrix } from '@/components/settings/permission-matrix'\nimport { useAuth } from '@/lib/auth-context'\nimport api from '@/lib/api'\n\ntype Tab = 'users' | 'roles'\n\ninterface Project {\n  id: string\n  name: string\n}\n\ninterface Organisation {\n  id: string\n  name: string\n  owner_id: string\n  created_at: string\n}\n\nexport default function UsersTeamsPage() {\n  const params = useParams()\n  const organisationId = params.uuid as string\n  const { user: currentUser } = useAuth()\n\n  const [activeTab, setActiveTab] = useState<Tab>('users')\n  const [organisation, setOrganisation] = useState<Organisation | null>(null)\n  const [users, setUsers] = useState<UserType[]>([])\n  const [roles, setRoles] = useState<ProjectRole[]>([])\n  const [permissions, setPermissions] = useState<Permission[]>([])\n  const [userRoles, setUserRoles] = useState<UserProjectRoleWithDetails[]>([])\n  const [loading, setLoading] = useState(true)\n  const [searchQuery, setSearchQuery] = useState('')\n  const [projects, setProjects] = useState<Project[]>([])\n  const [userProjects, setUserProjects] = useState<Record<string, Project[]>>({})\n  const [isCurrentUserAdmin, setIsCurrentUserAdmin] = useState(false)\n\n  // Modal states\n  const [showInviteModal, setShowInviteModal] = useState(false)\n  const [showProjectAssignModal, setShowProjectAssignModal] = useState(false)\n  const [showAssignRoleModal, setShowAssignRoleModal] = useState(false)\n  const [showCreateRoleModal, setShowCreateRoleModal] = useState(false)\n  const [rolesView, setRolesView] = useState<'list' | 'matrix'>('list')\n  const [showDeleteRoleDialog, setShowDeleteRoleDialog] = useState(false)\n  const [roleToDelete, setRoleToDelete] = useState<ProjectRole | null>(null)\n  const [deletingRoleId, setDeletingRoleId] = useState<string | null>(null)\n\n  // Selected items\n  const [selectedUser, setSelectedUser] = useState<UserType | null>(null)\n  const [selectedUserForProjects, setSelectedUserForProjects] = useState<UserType | null>(null)\n  const [roleModalEntity, setRoleModalEntity] = useState<{\n    type: 'user'\n    id: string\n    name: string\n  } | null>(null)\n  const [selectedUserToAdd, setSelectedUserToAdd] = useState<string>('')\n  const [showAddMemberSection, setShowAddMemberSection] = useState(false)\n\n  // Form data\n  const [userFormData, setUserFormData] = useState({\n    email: '',\n    username: '',\n    password: '',\n    full_name: ''\n  })\n  const [roleFormData, setRoleFormData] = useState({\n    name: '',\n    roleType: '',\n    description: '',\n    selectedPermissions: [] as string[]\n  })\n\n  useEffect(() => {\n    const loadAllData = async () => {\n      try {\n        // Fetch projects first since other data depends on it\n        const projectsResponse = await api.get('/api/v1/projects/', {\n          params: { organisation_id: organisationId }\n        })\n        const projectsData = projectsResponse.data\n        setProjects(projectsData)\n\n        // Then fetch other data, passing projects as parameter\n        await Promise.all([\n          fetchDataWithProjects(projectsData),\n          fetchPermissions()\n        ])\n      } catch (error: any) {\n        console.error('Error loading data:', error)\n        toast.error('Failed to load data')\n      }\n    }\n    loadAllData()\n  }, [organisationId, activeTab])\n\n  const fetchData = async () => {\n    // This is kept for modal callbacks - it will use current state projects\n    const currentProjects = projects\n    await fetchDataWithProjects(currentProjects)\n  }\n\n  const fetchDataWithProjects = async (projectsData: Project[]) => {\n    setLoading(true)\n    try {\n      // Fetch organization details\n      const orgResponse = await api.get(`/api/v1/organisations/${organisationId}`)\n      setOrganisation(orgResponse.data)\n\n      // Determine if current user is admin\n      const isAdmin = currentUser?.is_superuser || currentUser?.id === orgResponse.data.owner_id\n      setIsCurrentUserAdmin(isAdmin)\n\n      // Fetch users\n      const usersData = await listOrganisationUsers(organisationId)\n      setUsers(usersData)\n\n      // Fetch roles\n      const rolesData = await listRoles(organisationId)\n      setRoles(rolesData.roles)\n\n      // Fetch user roles across all projects (pass projects as parameter)\n      await fetchAllUserRoles(usersData, projectsData)\n\n      // Fetch user projects for each user\n      if (usersData.length > 0) {\n        fetchAllUserProjects(usersData, projectsData)\n      }\n\n    } catch (error: any) {\n      console.error('Error fetching data:', error)\n      toast.error(error.message || 'Failed to load data')\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const fetchAllUserRoles = async (usersList: UserType[], projectsList: Project[] = projects) => {\n    try {\n      let allRoles: UserProjectRoleWithDetails[] = []\n\n      // Fetch roles for each project\n      for (const project of projectsList) {\n        try {\n          const response = await api.get(`/api/v1/roles/assignments/users`, {\n            params: { project_id: project.id }\n          })\n          if (response.data.assignments) {\n            allRoles = [...allRoles, ...response.data.assignments]\n          }\n        } catch (e) {\n          // Project might not have any roles\n        }\n      }\n\n      setUserRoles(allRoles)\n    } catch (error: any) {\n      console.error('Error fetching user roles:', error)\n    }\n  }\n\n  const getUserRole = (user: UserType): string => {\n    // If user is the organization owner, return \"Owner\"\n    if (organisation && user.id === organisation.owner_id) {\n      return 'Owner'\n    }\n    // Otherwise return \"Member\" (you can enhance this to fetch actual roles)\n    return 'Member'\n  }\n\n  const fetchAllUserProjects = async (usersList: UserType[], projectsList: Project[] = projects) => {\n    try {\n      const userProjectsMap: Record<string, Project[]> = {}\n\n      for (const user of usersList) {\n        const assignedProjects: Project[] = []\n\n        for (const project of projectsList) {\n          try {\n            const response = await api.get(`/api/v1/projects/${project.id}/members`)\n            if (response.data.some((m: any) => m.id === user.id)) {\n              assignedProjects.push(project)\n            }\n          } catch (e) {\n            // User not assigned to this project, skip\n          }\n        }\n\n        userProjectsMap[user.id] = assignedProjects\n      }\n\n      setUserProjects(userProjectsMap)\n    } catch (error: any) {\n      console.error('Error fetching user projects:', error)\n    }\n  }\n\n  const fetchUserProjects = async (userId: string) => {\n    try {\n      const assignedProjects: Project[] = []\n\n      for (const project of projects) {\n        try {\n          const response = await api.get(`/api/v1/projects/${project.id}/members`)\n          if (response.data.some((m: any) => m.id === userId)) {\n            assignedProjects.push(project)\n          }\n        } catch (e) {\n          // User not assigned to this project\n        }\n      }\n\n      setUserProjects(prev => ({ ...prev, [userId]: assignedProjects }))\n    } catch (error: any) {\n      console.error('Failed to fetch user projects:', error)\n    }\n  }\n\n  const fetchProjects = async () => {\n    try {\n      const response = await api.get('/api/v1/projects/', {\n        params: { organisation_id: organisationId }\n      })\n      console.log('Fetched projects:', response.data)\n      setProjects(response.data)\n    } catch (error: any) {\n      console.error('Error fetching projects:', error)\n      toast.error('Failed to fetch projects: ' + (error.response?.data?.detail || error.message))\n    }\n  }\n\n  const fetchPermissions = async () => {\n    try {\n      const permissionsData = await listPermissions()\n      setPermissions(permissionsData)\n    } catch (error: any) {\n      console.error('Error fetching permissions:', error)\n    }\n  }\n\n  const handleInviteUser = async () => {\n    if (!userFormData.email) {\n      toast.error('Email address is required')\n      return\n    }\n\n    try {\n      await createInvitation({\n        email: userFormData.email,\n        full_name: userFormData.full_name || undefined,\n        organisation_id: organisationId,\n        expiry_days: 7\n      })\n\n      toast.success(`Invitation sent to ${userFormData.email}`)\n      setShowInviteModal(false)\n      setUserFormData({ email: '', username: '', password: '', full_name: '' })\n\n      // Refresh data to show pending invitations\n      fetchData()\n    } catch (error: any) {\n      console.error('Failed to send invitation:', error)\n      toast.error(error.response?.data?.detail || 'Failed to send invitation')\n    }\n  }\n\n  const openProjectAssignmentModal = (user: UserType) => {\n    setSelectedUserForProjects(user)\n    setShowProjectAssignModal(true)\n  }\n\n  const handleAssignToProject = async (projectId: string) => {\n    if (!selectedUserForProjects) return\n\n    try {\n      await api.post(`/api/v1/projects/${projectId}/members`, null, {\n        params: { user_id: selectedUserForProjects.id }\n      })\n      toast.success(`${selectedUserForProjects.username} assigned to project`)\n      // Refresh user projects\n      await fetchUserProjects(selectedUserForProjects.id)\n    } catch (error: any) {\n      console.error('Failed to assign user:', error)\n      toast.error(error.response?.data?.detail || 'Failed to assign user')\n    }\n  }\n\n  const handleRemoveFromProject = async (projectId: string) => {\n    if (!selectedUserForProjects) return\n\n    if (!confirm(`Remove ${selectedUserForProjects.username} from this project?`)) return\n\n    try {\n      await api.delete(\n        `/api/v1/projects/${projectId}/members/${selectedUserForProjects.id}`\n      )\n      toast.success('User removed from project')\n      // Refresh user projects\n      await fetchUserProjects(selectedUserForProjects.id)\n    } catch (error: any) {\n      console.error('Failed to remove user:', error)\n      toast.error(error.response?.data?.detail || 'Failed to remove user')\n    }\n  }\n\n  const handleCreateRole = async () => {\n    if (!roleFormData.name || !roleFormData.roleType) {\n      toast.error('Please fill in all required fields')\n      return\n    }\n\n    try {\n      await createRole(\n        organisationId,\n        roleFormData.name,\n        roleFormData.roleType,\n        roleFormData.description,\n        roleFormData.selectedPermissions\n      )\n      toast.success('Role created successfully')\n      setShowCreateRoleModal(false)\n      setRoleFormData({ name: '', roleType: '', description: '', selectedPermissions: [] })\n      fetchData()\n    } catch (error: any) {\n      console.error('Failed to create role:', error)\n      toast.error(error.response?.data?.detail || 'Failed to create role')\n    }\n  }\n\n  const handleDeleteRole = async (role: ProjectRole) => {\n    // Check if it's a system role\n    if (role.is_system_role) {\n      toast.error('Cannot delete system roles')\n      return\n    }\n\n    setRoleToDelete(role)\n    setShowDeleteRoleDialog(true)\n  }\n\n  const confirmDeleteRole = async () => {\n    if (!roleToDelete) return\n\n    setDeletingRoleId(roleToDelete.id)\n    try {\n      await deleteRole(roleToDelete.id)\n      toast.success(`Role \"${roleToDelete.name}\" deleted successfully`)\n      setShowDeleteRoleDialog(false)\n      setRoleToDelete(null)\n      fetchData()\n    } catch (error: any) {\n      console.error('Failed to delete role:', error)\n      toast.error(error.response?.data?.detail || 'Failed to delete role')\n    } finally {\n      setDeletingRoleId(null)\n    }\n  }\n\n  const filteredUsers = users.filter(user =>\n    user.email.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    user.username.toLowerCase().includes(searchQuery.toLowerCase()) ||\n    (user.full_name && user.full_name.toLowerCase().includes(searchQuery.toLowerCase()))\n  )\n\n  // Role type display mapping\n  const roleTypeDisplayMap: Record<string, string> = {\n    'owner': 'Super Administrator',\n    'admin': 'Administration',\n    'qa_manager': 'Quality Assurance',\n    'qa_lead': 'Quality Assurance',\n    'qa_engineer': 'Quality Assurance',\n    'product_owner': 'Stakeholder',\n    'viewer': 'Read Only'\n  }\n\n  const filteredRoles = roles\n    .filter(role =>\n      role.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      role.role_type.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      (role.description && role.description.toLowerCase().includes(searchQuery.toLowerCase()))\n    )\n    .sort((a, b) => a.name.localeCompare(b.name))\n\n  if (loading) {\n    return (\n      <div className=\"flex min-h-screen\">\n        <Sidebar organisationId={organisationId} />\n        <div className=\"flex-1 flex items-center justify-center bg-white\">\n          <div className=\"text-center\">\n            <div className=\"text-gray-500\">Loading...</div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"flex min-h-screen bg-white\">\n      <Sidebar organisationId={organisationId} />\n      <div className=\"flex-1 p-8\">\n      <div className=\"flex items-center gap-4 mb-2\">\n        <div className=\"w-16 h-16 bg-primary rounded-2xl flex items-center justify-center flex-shrink-0\">\n          <Users className=\"w-8 h-8 text-white\" />\n        </div>\n        <h1 className=\"text-4xl font-bold text-gray-900\">Users & Teams</h1>\n      </div>\n      <p className=\"text-lg text-gray-600 mb-8 mt-4\">Manage user access, teams, and role assignments</p>\n\n      <div className=\"flex items-center justify-end mb-8\">\n        <div className=\"flex gap-2\">\n          {activeTab === 'users' && (\n            <Button onClick={() => setShowInviteModal(true)}>\n              <PlusCircle className=\"mr-2 h-4 w-4\" />\n              Invite User\n            </Button>\n          )}\n          {activeTab === 'roles' && (\n            <Button onClick={() => setShowCreateRoleModal(true)}>\n              <Shield className=\"mr-2 h-4 w-4\" />\n              Create Role\n            </Button>\n          )}\n        </div>\n      </div>\n\n      {/* Tabs */}\n      <div className=\"border-b border-gray-200 mb-6\">\n        <nav className=\"-mb-px flex space-x-8\">\n          <button\n            onClick={() => setActiveTab('users')}\n            className={`${\n              activeTab === 'users'\n                ? 'border-primary text-primary'\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n            } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2`}\n          >\n            <User className=\"w-4 h-4\" />\n            Users ({users.length})\n          </button>\n          <button\n            onClick={() => setActiveTab('roles')}\n            className={`${\n              activeTab === 'roles'\n                ? 'border-primary text-primary'\n                : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'\n            } whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2`}\n          >\n            <Shield className=\"w-4 h-4\" />\n            Roles ({roles.length})\n          </button>\n        </nav>\n      </div>\n\n      {/* Search and Filters */}\n      <div className=\"mb-6 flex gap-3\">\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5\" />\n          <input\n            type=\"text\"\n            placeholder={`Search ${activeTab}...`}\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n          />\n        </div>\n      </div>\n\n      {/* Users Tab Content */}\n      {activeTab === 'users' && (\n        <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm\">\n          <div className=\"overflow-x-auto\">\n            <table className=\"w-full text-sm text-left text-gray-500 dark:text-gray-400\">\n              <thead className=\"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400\">\n                <tr>\n                  <th scope=\"col\" className=\"px-6 py-3\">User</th>\n                  <th scope=\"col\" className=\"px-6 py-3\">Role</th>\n                  <th scope=\"col\" className=\"px-6 py-3\">Projects</th>\n                  <th scope=\"col\" className=\"px-6 py-3\">Created</th>\n                  <th scope=\"col\" className=\"px-6 py-3 text-center\">Actions</th>\n                </tr>\n              </thead>\n              <tbody>\n                {filteredUsers.length === 0 ? (\n                  <tr>\n                    <td colSpan={5} className=\"px-6 py-8 text-center text-gray-500\">\n                      No users found. Invite users to get started.\n                    </td>\n                  </tr>\n                ) : (\n                  filteredUsers.map((user) => (\n                    <tr key={user.id} className=\"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\">\n                      <td className=\"px-6 py-4\">\n                        <div className=\"flex items-center\">\n                          <div className=\"h-10 w-10 flex-shrink-0\">\n                            <div className=\"h-10 w-10 rounded-full bg-gradient-to-br from-teal-500 to-cyan-600 flex items-center justify-center\">\n                              <span className=\"text-sm font-semibold text-white\">\n                                {user.username.substring(0, 2).toUpperCase()}\n                              </span>\n                            </div>\n                          </div>\n                          <div className=\"ml-4\">\n                            <div className=\"text-sm font-medium text-gray-900 dark:text-white\">{user.full_name || user.username}</div>\n                            <div className=\"text-sm text-gray-500 dark:text-gray-400\">{user.email}</div>\n                          </div>\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4\">\n                        {(() => {\n                          const userRolesList = userRoles.filter(ur => ur.user_id === user.id)\n                          if (userRolesList.length === 0) {\n                            return <span className=\"text-sm text-gray-500 dark:text-gray-400\">No roles</span>\n                          }\n\n                          // Deduplicate roles by name\n                          const uniqueRoles = Array.from(\n                            new Map(\n                              userRolesList.map(ur => {\n                                const roleName = (ur as any).role?.name || (ur as any).role_name || 'Unknown Role'\n                                return [roleName, ur]\n                              })\n                            ).values()\n                          )\n\n                          return (\n                            <div className=\"flex flex-wrap gap-1\">\n                              {uniqueRoles.map(ur => (\n                                <span\n                                  key={ur.id}\n                                  className=\"inline-block px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded\"\n                                >\n                                  {(ur as any).role?.name || (ur as any).role_name || 'Unknown Role'}\n                                </span>\n                              ))}\n                            </div>\n                          )\n                        })()}\n                      </td>\n                      <td className=\"px-6 py-4\">\n                        <div className=\"space-y-1\">\n                          {(() => {\n                            // Check if user is an Admin\n                            const hasAdminRole = userRoles.some(\n                              ur => ur.user_id === user.id &&\n                                ((ur as any).role?.name === 'Admin' || (ur as any).role_name === 'Admin')\n                            )\n\n                            if (hasAdminRole) {\n                              return (\n                                <div className=\"flex items-center gap-2 px-3 py-2 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800\">\n                                  <Shield className=\"w-4 h-4 text-green-600 dark:text-green-400\" />\n                                  <span className=\"text-sm font-medium text-green-800 dark:text-green-200\">\n                                    All projects (auto)\n                                  </span>\n                                </div>\n                              )\n                            }\n\n                            if ((userProjects[user.id] || []).length > 0) {\n                              return (\n                                <div className=\"flex flex-wrap gap-1\">\n                                  {(userProjects[user.id] || []).map(project => (\n                                    <span\n                                      key={project.id}\n                                      className=\"inline-block px-2 py-1 text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200 rounded\"\n                                    >\n                                      {project.name}\n                                    </span>\n                                  ))}\n                                </div>\n                              )\n                            }\n\n                            return (\n                              <span className=\"text-sm text-gray-500 dark:text-gray-400\">No projects</span>\n                            )\n                          })()}\n                          <button\n                            onClick={() => openProjectAssignmentModal(user)}\n                            className=\"text-xs text-primary hover:underline flex items-center gap-1 mt-1\"\n                          >\n                            <Plus className=\"w-3 h-3\" />\n                            Manage Projects\n                          </button>\n                        </div>\n                      </td>\n                      <td className=\"px-6 py-4 text-sm text-gray-500\">\n                        {formatDateHumanReadable(user.created_at)}\n                      </td>\n                      <td className=\"px-6 py-4 flex justify-center items-center\">\n                        <button\n                          onClick={() => {\n                            setRoleModalEntity({\n                              type: 'user',\n                              id: user.id,\n                              name: user.full_name || user.username\n                            })\n                            setShowAssignRoleModal(true)\n                          }}\n                          className=\"flex items-center gap-1 px-3 py-2 rounded-lg text-blue-600 bg-blue-50 hover:bg-blue-100 dark:text-blue-400 dark:bg-blue-900/20 dark:hover:bg-blue-900/30 transition-colors\"\n                        >\n                          <Pencil className=\"w-4 h-4\" />\n                          Edit Roles\n                        </button>\n                      </td>\n                    </tr>\n                  ))\n                )}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n\n      {/* Roles Tab Content */}\n      {activeTab === 'roles' && (\n        <div>\n          {/* Roles Tab Sub-navigation */}\n          <div className=\"mb-6 flex gap-4 border-b border-gray-200 dark:border-gray-700\">\n            <button\n              onClick={() => setRolesView('list')}\n              className={`py-3 px-4 text-sm font-medium border-b-2 transition-colors ${\n                rolesView === 'list'\n                  ? 'border-primary text-primary'\n                  : 'border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white'\n              }`}\n            >\n              ðŸ“‹ Roles List\n            </button>\n            <button\n              onClick={() => setRolesView('matrix')}\n              className={`py-3 px-4 text-sm font-medium border-b-2 transition-colors ${\n                rolesView === 'matrix'\n                  ? 'border-primary text-primary'\n                  : 'border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white'\n              }`}\n            >\n              ðŸ” Permission Matrix\n            </button>\n          </div>\n\n          {/* Roles List View */}\n          {rolesView === 'list' && (\n            <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm\">\n              <div className=\"overflow-x-auto\">\n                <table className=\"w-full text-sm text-left text-gray-500 dark:text-gray-400\">\n                  <thead className=\"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400\">\n                    <tr>\n                      <th scope=\"col\" className=\"px-6 py-3\">Role Name</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">Type</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">Description</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">Status</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">System Role</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">Created</th>\n                      <th scope=\"col\" className=\"px-6 py-3\">Actions</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {filteredRoles.length === 0 ? (\n                      <tr>\n                        <td colSpan={7} className=\"px-6 py-8 text-center text-gray-500\">\n                          No roles found. {roles.length === 0 ? 'Initialize default roles or create a custom role to get started.' : 'Try adjusting your search.'}\n                        </td>\n                      </tr>\n                    ) : (\n                      filteredRoles.map((role) => (\n                        <tr key={role.id} className=\"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600\">\n                          <td className=\"px-6 py-4\">\n                            <div className=\"font-medium text-gray-900 dark:text-white\">{role.name}</div>\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <span className=\"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800\">\n                              {roleTypeDisplayMap[role.role_type] || role.role_type.replace(/_/g, ' ')}\n                            </span>\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <div className=\"text-sm text-gray-500 dark:text-gray-400 max-w-xs truncate\">\n                              {role.description || '-'}\n                            </div>\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                              role.is_active ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-800'\n                            }`}>\n                              {role.is_active ? 'Active' : 'Inactive'}\n                            </span>\n                          </td>\n                          <td className=\"px-6 py-4\">\n                            <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${\n                              role.is_system_role ? 'bg-purple-100 text-purple-800' : 'bg-gray-100 text-gray-800'\n                            }`}>\n                              {role.is_system_role ? 'System' : 'Custom'}\n                            </span>\n                          </td>\n                          <td className=\"px-6 py-4 text-sm text-gray-500\">\n                            {formatDateHumanReadable(role.created_at)}\n                          </td>\n                          <td className=\"px-6 py-4 text-sm\">\n                            <button\n                              onClick={() => handleDeleteRole(role)}\n                              disabled={role.is_system_role || deletingRoleId === role.id}\n                              className=\"inline-flex items-center gap-2 text-red-600 hover:text-red-800 disabled:text-gray-400 disabled:cursor-not-allowed transition-colors\"\n                              title={role.is_system_role ? 'Cannot delete system roles' : 'Delete role'}\n                            >\n                              <Trash2 size={16} />\n                              {deletingRoleId === role.id ? 'Deleting...' : 'Delete'}\n                            </button>\n                          </td>\n                        </tr>\n                      ))\n                    )}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          )}\n\n          {/* Permission Matrix View */}\n          {rolesView === 'matrix' && (\n            <div className=\"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 shadow-sm p-8\">\n              <PermissionMatrix organisationId={organisationId} isAdmin={isCurrentUserAdmin} />\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Add User Modal */}\n      {showInviteModal && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6\">\n            <h2 className=\"text-xl font-bold mb-4\">ðŸ“§ Invite User</h2>\n            <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-6\">\n              Send an invitation email. The user will receive a welcome email with a link to create their account and join your organization.\n            </p>\n\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Email Address <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"email\"\n                  value={userFormData.email}\n                  onChange={(e) => setUserFormData({ ...userFormData, email: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                  placeholder=\"user@example.com\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Full Name (Optional)\n                </label>\n                <input\n                  type=\"text\"\n                  value={userFormData.full_name}\n                  onChange={(e) => setUserFormData({ ...userFormData, full_name: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                  placeholder=\"John Doe\"\n                />\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                  This will be pre-filled in the invitation email\n                </p>\n              </div>\n\n              <div className=\"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3\">\n                <p className=\"text-xs text-blue-700 dark:text-blue-300\">\n                  ðŸ’¡ The invitation will expire in <strong>7 days</strong>. The user will choose their username and password when they accept the invitation.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex justify-end gap-2 mt-6\">\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setShowInviteModal(false)\n                  setUserFormData({ email: '', username: '', password: '', full_name: '' })\n                }}\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={handleInviteUser}\n                disabled={!userFormData.email}\n              >\n                Send Invitation\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Create Role Modal */}\n      {showCreateRoleModal && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto\">\n            <h2 className=\"text-xl font-bold mb-4\">Create Custom Role</h2>\n            <p className=\"text-sm text-gray-500 dark:text-gray-400 mb-6\">\n              Create a custom role with specific permissions for your organization.\n            </p>\n\n            <div className=\"space-y-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Role Name <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"text\"\n                  value={roleFormData.name}\n                  onChange={(e) => setRoleFormData({ ...roleFormData, name: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                  placeholder=\"e.g., QA Lead\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Role Type <span className=\"text-red-500\">*</span>\n                </label>\n                <input\n                  type=\"text\"\n                  value={roleFormData.roleType}\n                  onChange={(e) => setRoleFormData({ ...roleFormData, roleType: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                  placeholder=\"e.g., qa_lead (lowercase, underscores)\"\n                />\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n                  Use lowercase letters and underscores only (e.g., qa_lead, senior_qa_engineer)\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">\n                  Description\n                </label>\n                <textarea\n                  value={roleFormData.description}\n                  onChange={(e) => setRoleFormData({ ...roleFormData, description: e.target.value })}\n                  className=\"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-primary bg-white dark:bg-gray-700 text-gray-900 dark:text-white\"\n                  rows={3}\n                  placeholder=\"Describe the responsibilities and access level of this role...\"\n                />\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2\">\n                  Permissions (Optional)\n                </label>\n                <p className=\"text-xs text-gray-500 dark:text-gray-400 mb-3\">\n                  Select permissions by module. Each module has READ, WRITE, EXECUTE, and MANAGE permission levels.\n                </p>\n                <div className=\"border border-gray-300 dark:border-gray-600 rounded-md p-4 max-h-96 overflow-y-auto\">\n                  {permissions.length === 0 ? (\n                    <p className=\"text-sm text-gray-500 text-center py-4\">\n                      No permissions available. Run the module permissions initialization script first.\n                    </p>\n                  ) : (\n                    <div className=\"space-y-4\">\n                      {(() => {\n                        // Group permissions by module\n                        const moduleGroups = permissions.reduce((acc, permission) => {\n                          const module = permission.resource\n                          if (!acc[module]) {\n                            acc[module] = []\n                          }\n                          acc[module].push(permission)\n                          return acc\n                        }, {} as Record<string, typeof permissions>)\n\n                        // Module display names and icons\n                        const moduleConfig: Record<string, { name: string; icon: string; color: string }> = {\n                          automation_hub: { name: 'Automation Hub', icon: 'ðŸ¤–', color: 'blue' },\n                          api_testing: { name: 'API Testing', icon: 'ðŸ”Œ', color: 'green' },\n                          test_management: { name: 'Test Management', icon: 'ðŸ“‹', color: 'purple' },\n                          security_testing: { name: 'Security Testing', icon: 'ðŸ”’', color: 'red' },\n                          performance_testing: { name: 'Performance Testing', icon: 'âš¡', color: 'yellow' },\n                          mobile_testing: { name: 'Mobile Testing', icon: 'ðŸ“±', color: 'indigo' },\n                        }\n\n                        // Sort modules\n                        const sortedModules = Object.keys(moduleGroups).sort((a, b) => {\n                          const order = ['automation_hub', 'api_testing', 'test_management', 'security_testing', 'performance_testing', 'mobile_testing']\n                          return order.indexOf(a) - order.indexOf(b)\n                        })\n\n                        return sortedModules.map((module) => {\n                          const config = moduleConfig[module] || { name: module, icon: 'ðŸ“¦', color: 'gray' }\n                          const modulePerms = moduleGroups[module].sort((a, b) => {\n                            const order = ['read', 'write', 'execute', 'manage']\n                            return order.indexOf(a.action) - order.indexOf(b.action)\n                          })\n\n                          const colorClasses = {\n                            blue: 'bg-blue-50 border-blue-200 dark:bg-blue-900/20 dark:border-blue-800',\n                            green: 'bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800',\n                            purple: 'bg-purple-50 border-purple-200 dark:bg-purple-900/20 dark:border-purple-800',\n                            red: 'bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800',\n                            yellow: 'bg-yellow-50 border-yellow-200 dark:bg-yellow-900/20 dark:border-yellow-800',\n                            indigo: 'bg-indigo-50 border-indigo-200 dark:bg-indigo-900/20 dark:border-indigo-800',\n                            gray: 'bg-gray-50 border-gray-200 dark:bg-gray-900/20 dark:border-gray-800',\n                          }\n\n                          return (\n                            <div key={module} className={`border rounded-lg p-3 ${colorClasses[config.color as keyof typeof colorClasses]}`}>\n                              <div className=\"flex items-center gap-2 mb-3\">\n                                <span className=\"text-xl\">{config.icon}</span>\n                                <h4 className=\"text-sm font-semibold text-gray-900 dark:text-white\">\n                                  {config.name}\n                                </h4>\n                                <span className=\"ml-auto text-xs text-gray-500 dark:text-gray-400\">\n                                  {modulePerms.filter(p => roleFormData.selectedPermissions.includes(p.id)).length}/{modulePerms.length} selected\n                                </span>\n                              </div>\n                              <div className=\"space-y-2\">\n                                {modulePerms.map((permission) => (\n                                  <label\n                                    key={permission.id}\n                                    className=\"flex items-start gap-2 p-2 hover:bg-white/50 dark:hover:bg-gray-800/50 rounded cursor-pointer\"\n                                  >\n                                    <input\n                                      type=\"checkbox\"\n                                      checked={roleFormData.selectedPermissions.includes(permission.id)}\n                                      onChange={(e) => {\n                                        if (e.target.checked) {\n                                          setRoleFormData({\n                                            ...roleFormData,\n                                            selectedPermissions: [...roleFormData.selectedPermissions, permission.id]\n                                          })\n                                        } else {\n                                          setRoleFormData({\n                                            ...roleFormData,\n                                            selectedPermissions: roleFormData.selectedPermissions.filter(id => id !== permission.id)\n                                          })\n                                        }\n                                      }}\n                                      className=\"mt-1 h-4 w-4 text-primary focus:ring-primary border-gray-300 rounded\"\n                                    />\n                                    <div className=\"flex-1 min-w-0\">\n                                      <div className=\"text-sm font-medium text-gray-900 dark:text-white flex items-center gap-2\">\n                                        <span className=\"uppercase text-xs px-2 py-0.5 bg-white dark:bg-gray-700 rounded font-semibold\">\n                                          {permission.action}\n                                        </span>\n                                        <span className=\"truncate text-xs\">{permission.name}</span>\n                                      </div>\n                                      {permission.description && (\n                                        <div className=\"text-xs text-gray-600 dark:text-gray-400 mt-1\">\n                                          {permission.description}\n                                        </div>\n                                      )}\n                                    </div>\n                                  </label>\n                                ))}\n                              </div>\n                            </div>\n                          )\n                        })\n                      })()}\n                    </div>\n                  )}\n                </div>\n                {roleFormData.selectedPermissions.length > 0 && (\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-2\">\n                    âœ… {roleFormData.selectedPermissions.length} permission(s) selected across {\n                      new Set(permissions.filter(p => roleFormData.selectedPermissions.includes(p.id)).map(p => p.resource)).size\n                    } module(s)\n                  </p>\n                )}\n              </div>\n            </div>\n\n            <div className=\"flex justify-end gap-2 mt-6\">\n              <Button\n                variant=\"outline\"\n                onClick={() => {\n                  setShowCreateRoleModal(false)\n                  setRoleFormData({ name: '', roleType: '', description: '', selectedPermissions: [] })\n                }}\n              >\n                Cancel\n              </Button>\n              <Button\n                onClick={handleCreateRole}\n                disabled={!roleFormData.name || !roleFormData.roleType}\n              >\n                Create Role\n              </Button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Project Assignment Modal */}\n      {showProjectAssignModal && selectedUserForProjects && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full p-6 max-h-[90vh] overflow-y-auto\">\n            <div className=\"flex items-center justify-between mb-4\">\n              <div>\n                <h2 className=\"text-xl font-bold text-gray-900 dark:text-white\">\n                  Manage Projects for {selectedUserForProjects.full_name || selectedUserForProjects.username}\n                </h2>\n                <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                  Assign or remove this user from projects in your organization\n                </p>\n              </div>\n            </div>\n\n            <div className=\"space-y-3\">\n              {projects.length === 0 ? (\n                <div className=\"text-center py-12 text-gray-500\">\n                  No projects available. Create a project first.\n                </div>\n              ) : (\n                projects.map((project) => {\n                  const isAssigned = (userProjects[selectedUserForProjects.id] || [])\n                    .some(p => p.id === project.id)\n\n                  return (\n                    <div\n                      key={project.id}\n                      className={`flex items-center justify-between p-4 border rounded-lg transition-colors ${\n                        isAssigned\n                          ? 'border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-900/20'\n                          : 'border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700/50'\n                      }`}\n                    >\n                      <div className=\"flex-1\">\n                        <div className=\"flex items-center gap-2\">\n                          <div className=\"font-medium text-gray-900 dark:text-white\">\n                            {project.name}\n                          </div>\n                          {isAssigned && (\n                            <span className=\"px-2 py-0.5 text-xs bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-200 rounded-full\">\n                              Assigned\n                            </span>\n                          )}\n                        </div>\n                        {project.description && (\n                          <div className=\"text-sm text-gray-500 dark:text-gray-400 mt-1\">\n                            {project.description}\n                          </div>\n                        )}\n                      </div>\n\n                      <div className=\"ml-4\">\n                        {isAssigned ? (\n                          <button\n                            onClick={() => handleRemoveFromProject(project.id)}\n                            className=\"px-4 py-2 text-sm bg-red-100 text-red-700 dark:bg-red-900/20 dark:text-red-400 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/30 transition-colors font-medium\"\n                          >\n                            Remove\n                          </button>\n                        ) : (\n                          <button\n                            onClick={() => handleAssignToProject(project.id)}\n                            className=\"px-4 py-2 text-sm bg-primary text-white rounded-lg hover:opacity-90 transition-opacity font-medium\"\n                          >\n                            Assign\n                          </button>\n                        )}\n                      </div>\n                    </div>\n                  )\n                })\n              )}\n            </div>\n\n            <div className=\"flex items-center justify-between mt-6 pt-4 border-t border-gray-200 dark:border-gray-700\">\n              <div className=\"text-sm text-gray-500 dark:text-gray-400\">\n                {(userProjects[selectedUserForProjects.id] || []).length} of {projects.length} projects assigned\n              </div>\n              <button\n                onClick={() => {\n                  setShowProjectAssignModal(false)\n                  setSelectedUserForProjects(null)\n                }}\n                className=\"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors\"\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Role Assignment Modal */}\n      {showAssignRoleModal && roleModalEntity && (\n        <RoleAssignmentModal\n          isOpen={showAssignRoleModal}\n          onClose={() => {\n            setShowAssignRoleModal(false)\n            setRoleModalEntity(null)\n            fetchData() // Refresh data after role changes\n          }}\n          organisationId={organisationId}\n          entityType={roleModalEntity.type}\n          entityId={roleModalEntity.id}\n          entityName={roleModalEntity.name}\n          availableProjects={projects}\n          onRoleAssigned={fetchData} // Refresh data immediately after role assignment\n          onModalOpen={async () => {\n            // Refresh projects when modal opens to ensure latest projects are available\n            try {\n              const projectsResponse = await api.get('/api/v1/projects/', {\n                params: { organisation_id: organisationId }\n              })\n              setProjects(projectsResponse.data)\n            } catch (error) {\n              console.error('Error refreshing projects:', error)\n            }\n          }}\n        />\n      )}\n\n      {/* Delete Role Confirmation Dialog */}\n      {showDeleteRoleDialog && roleToDelete && (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n          <div className=\"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6\">\n            <div className=\"flex items-center gap-3 mb-4\">\n              <div className=\"flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/20\">\n                <Trash2 className=\"h-6 w-6 text-red-600 dark:text-red-400\" />\n              </div>\n              <div>\n                <h3 className=\"text-lg font-medium text-gray-900 dark:text-white\">Delete Role</h3>\n              </div>\n            </div>\n            <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n              Are you sure you want to delete the role <strong>{roleToDelete.name}</strong>? This action cannot be undone.\n            </p>\n            <div className=\"flex gap-3 justify-end\">\n              <button\n                onClick={() => {\n                  setShowDeleteRoleDialog(false)\n                  setRoleToDelete(null)\n                }}\n                disabled={deletingRoleId !== null}\n                className=\"px-4 py-2 text-sm font-medium border border-gray-300 dark:border-gray-600 rounded-lg text-gray-700 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\n              >\n                Cancel\n              </button>\n              <button\n                onClick={confirmDeleteRole}\n                disabled={deletingRoleId !== null}\n                className=\"px-4 py-2 text-sm font-medium bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center gap-2\"\n              >\n                {deletingRoleId === roleToDelete.id ? (\n                  <>\n                    <span className=\"animate-spin\">â³</span>\n                    Deleting...\n                  </>\n                ) : (\n                  <>\n                    <Trash2 size={16} />\n                    Delete Role\n                  </>\n                )}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAYA;AACA;AACA;AACA;AACA;AACA;;;AA1BA;;;;;;;;;;;;;;;AA0Ce,SAAS;;IACtB,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,iBAAiB,OAAO,IAAI;IAClC,MAAM,EAAE,MAAM,WAAW,EAAE,GAAG,IAAA,iJAAO;IAErC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAM;IAChD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAsB;IACtE,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAa,EAAE;IACjD,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB,EAAE;IACpD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAe,EAAE;IAC/D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAA+B,EAAE;IAC3E,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAC;IAC/C,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAY,EAAE;IACtD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAA4B,CAAC;IAC7E,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAAC;IAE7D,eAAe;IACf,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAAC;IACvD,MAAM,CAAC,wBAAwB,0BAA0B,GAAG,IAAA,yKAAQ,EAAC;IACrE,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yKAAQ,EAAC;IAC/D,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yKAAQ,EAAC;IAC/D,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAoB;IAC9D,MAAM,CAAC,sBAAsB,wBAAwB,GAAG,IAAA,yKAAQ,EAAC;IACjE,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAqB;IACrE,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAgB;IAEpE,iBAAiB;IACjB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAkB;IAClE,MAAM,CAAC,yBAAyB,2BAA2B,GAAG,IAAA,yKAAQ,EAAkB;IACxF,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,IAAA,yKAAQ,EAI5C;IACV,MAAM,CAAC,mBAAmB,qBAAqB,GAAG,IAAA,yKAAQ,EAAS;IACnE,MAAM,CAAC,sBAAsB,wBAAwB,GAAG,IAAA,yKAAQ,EAAC;IAEjE,YAAY;IACZ,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;QAC/C,OAAO;QACP,UAAU;QACV,UAAU;QACV,WAAW;IACb;IACA,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;QAC/C,MAAM;QACN,UAAU;QACV,aAAa;QACb,qBAAqB,EAAE;IACzB;IAEA,IAAA,0KAAS;oCAAC;YACR,MAAM;wDAAc;oBAClB,IAAI;wBACF,sDAAsD;wBACtD,MAAM,mBAAmB,MAAM,6IAAG,CAAC,GAAG,CAAC,qBAAqB;4BAC1D,QAAQ;gCAAE,iBAAiB;4BAAe;wBAC5C;wBACA,MAAM,eAAe,iBAAiB,IAAI;wBAC1C,YAAY;wBAEZ,uDAAuD;wBACvD,MAAM,QAAQ,GAAG,CAAC;4BAChB,sBAAsB;4BACtB;yBACD;oBACH,EAAE,OAAO,OAAY;wBACnB,QAAQ,KAAK,CAAC,uBAAuB;wBACrC,oJAAK,CAAC,KAAK,CAAC;oBACd;gBACF;;YACA;QACF;mCAAG;QAAC;QAAgB;KAAU;IAE9B,MAAM,YAAY;QAChB,wEAAwE;QACxE,MAAM,kBAAkB;QACxB,MAAM,sBAAsB;IAC9B;IAEA,MAAM,wBAAwB,OAAO;QACnC,WAAW;QACX,IAAI;YACF,6BAA6B;YAC7B,MAAM,cAAc,MAAM,6IAAG,CAAC,GAAG,CAAC,CAAC,sBAAsB,EAAE,gBAAgB;YAC3E,gBAAgB,YAAY,IAAI;YAEhC,qCAAqC;YACrC,MAAM,UAAU,aAAa,gBAAgB,aAAa,OAAO,YAAY,IAAI,CAAC,QAAQ;YAC1F,sBAAsB;YAEtB,cAAc;YACd,MAAM,YAAY,MAAM,IAAA,2JAAqB,EAAC;YAC9C,SAAS;YAET,cAAc;YACd,MAAM,YAAY,MAAM,IAAA,+IAAS,EAAC;YAClC,SAAS,UAAU,KAAK;YAExB,oEAAoE;YACpE,MAAM,kBAAkB,WAAW;YAEnC,oCAAoC;YACpC,IAAI,UAAU,MAAM,GAAG,GAAG;gBACxB,qBAAqB,WAAW;YAClC;QAEF,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,wBAAwB;YACtC,oJAAK,CAAC,KAAK,CAAC,MAAM,OAAO,IAAI;QAC/B,SAAU;YACR,WAAW;QACb;IACF;IAEA,MAAM,oBAAoB,OAAO,WAAuB,eAA0B,QAAQ;QACxF,IAAI;YACF,IAAI,WAAyC,EAAE;YAE/C,+BAA+B;YAC/B,KAAK,MAAM,WAAW,aAAc;gBAClC,IAAI;oBACF,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC,CAAC,+BAA+B,CAAC,EAAE;wBAChE,QAAQ;4BAAE,YAAY,QAAQ,EAAE;wBAAC;oBACnC;oBACA,IAAI,SAAS,IAAI,CAAC,WAAW,EAAE;wBAC7B,WAAW;+BAAI;+BAAa,SAAS,IAAI,CAAC,WAAW;yBAAC;oBACxD;gBACF,EAAE,OAAO,GAAG;gBACV,mCAAmC;gBACrC;YACF;YAEA,aAAa;QACf,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,8BAA8B;QAC9C;IACF;IAEA,MAAM,cAAc,CAAC;QACnB,oDAAoD;QACpD,IAAI,gBAAgB,KAAK,EAAE,KAAK,aAAa,QAAQ,EAAE;YACrD,OAAO;QACT;QACA,yEAAyE;QACzE,OAAO;IACT;IAEA,MAAM,uBAAuB,OAAO,WAAuB,eAA0B,QAAQ;QAC3F,IAAI;YACF,MAAM,kBAA6C,CAAC;YAEpD,KAAK,MAAM,QAAQ,UAAW;gBAC5B,MAAM,mBAA8B,EAAE;gBAEtC,KAAK,MAAM,WAAW,aAAc;oBAClC,IAAI;wBACF,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC,CAAC,iBAAiB,EAAE,QAAQ,EAAE,CAAC,QAAQ,CAAC;wBACvE,IAAI,SAAS,IAAI,CAAC,IAAI,CAAC,CAAC,IAAW,EAAE,EAAE,KAAK,KAAK,EAAE,GAAG;4BACpD,iBAAiB,IAAI,CAAC;wBACxB;oBACF,EAAE,OAAO,GAAG;oBACV,0CAA0C;oBAC5C;gBACF;gBAEA,eAAe,CAAC,KAAK,EAAE,CAAC,GAAG;YAC7B;YAEA,gBAAgB;QAClB,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,iCAAiC;QACjD;IACF;IAEA,MAAM,oBAAoB,OAAO;QAC/B,IAAI;YACF,MAAM,mBAA8B,EAAE;YAEtC,KAAK,MAAM,WAAW,SAAU;gBAC9B,IAAI;oBACF,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC,CAAC,iBAAiB,EAAE,QAAQ,EAAE,CAAC,QAAQ,CAAC;oBACvE,IAAI,SAAS,IAAI,CAAC,IAAI,CAAC,CAAC,IAAW,EAAE,EAAE,KAAK,SAAS;wBACnD,iBAAiB,IAAI,CAAC;oBACxB;gBACF,EAAE,OAAO,GAAG;gBACV,oCAAoC;gBACtC;YACF;YAEA,gBAAgB,CAAA,OAAQ,CAAC;oBAAE,GAAG,IAAI;oBAAE,CAAC,OAAO,EAAE;gBAAiB,CAAC;QAClE,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,kCAAkC;QAClD;IACF;IAEA,MAAM,gBAAgB;QACpB,IAAI;YACF,MAAM,WAAW,MAAM,6IAAG,CAAC,GAAG,CAAC,qBAAqB;gBAClD,QAAQ;oBAAE,iBAAiB;gBAAe;YAC5C;YACA,QAAQ,GAAG,CAAC,qBAAqB,SAAS,IAAI;YAC9C,YAAY,SAAS,IAAI;QAC3B,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,4BAA4B;YAC1C,oJAAK,CAAC,KAAK,CAAC,+BAA+B,CAAC,MAAM,QAAQ,EAAE,MAAM,UAAU,MAAM,OAAO;QAC3F;IACF;IAEA,MAAM,mBAAmB;QACvB,IAAI;YACF,MAAM,kBAAkB,MAAM,IAAA,qJAAe;YAC7C,eAAe;QACjB,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,+BAA+B;QAC/C;IACF;IAEA,MAAM,mBAAmB;QACvB,IAAI,CAAC,aAAa,KAAK,EAAE;YACvB,oJAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,IAAI;YACF,MAAM,IAAA,4JAAgB,EAAC;gBACrB,OAAO,aAAa,KAAK;gBACzB,WAAW,aAAa,SAAS,IAAI;gBACrC,iBAAiB;gBACjB,aAAa;YACf;YAEA,oJAAK,CAAC,OAAO,CAAC,CAAC,mBAAmB,EAAE,aAAa,KAAK,EAAE;YACxD,mBAAmB;YACnB,gBAAgB;gBAAE,OAAO;gBAAI,UAAU;gBAAI,UAAU;gBAAI,WAAW;YAAG;YAEvE,2CAA2C;YAC3C;QACF,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,8BAA8B;YAC5C,oJAAK,CAAC,KAAK,CAAC,MAAM,QAAQ,EAAE,MAAM,UAAU;QAC9C;IACF;IAEA,MAAM,6BAA6B,CAAC;QAClC,2BAA2B;QAC3B,0BAA0B;IAC5B;IAEA,MAAM,wBAAwB,OAAO;QACnC,IAAI,CAAC,yBAAyB;QAE9B,IAAI;YACF,MAAM,6IAAG,CAAC,IAAI,CAAC,CAAC,iBAAiB,EAAE,UAAU,QAAQ,CAAC,EAAE,MAAM;gBAC5D,QAAQ;oBAAE,SAAS,wBAAwB,EAAE;gBAAC;YAChD;YACA,oJAAK,CAAC,OAAO,CAAC,GAAG,wBAAwB,QAAQ,CAAC,oBAAoB,CAAC;YACvE,wBAAwB;YACxB,MAAM,kBAAkB,wBAAwB,EAAE;QACpD,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,0BAA0B;YACxC,oJAAK,CAAC,KAAK,CAAC,MAAM,QAAQ,EAAE,MAAM,UAAU;QAC9C;IACF;IAEA,MAAM,0BAA0B,OAAO;QACrC,IAAI,CAAC,yBAAyB;QAE9B,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,wBAAwB,QAAQ,CAAC,mBAAmB,CAAC,GAAG;QAE/E,IAAI;YACF,MAAM,6IAAG,CAAC,MAAM,CACd,CAAC,iBAAiB,EAAE,UAAU,SAAS,EAAE,wBAAwB,EAAE,EAAE;YAEvE,oJAAK,CAAC,OAAO,CAAC;YACd,wBAAwB;YACxB,MAAM,kBAAkB,wBAAwB,EAAE;QACpD,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,0BAA0B;YACxC,oJAAK,CAAC,KAAK,CAAC,MAAM,QAAQ,EAAE,MAAM,UAAU;QAC9C;IACF;IAEA,MAAM,mBAAmB;QACvB,IAAI,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,QAAQ,EAAE;YAChD,oJAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,IAAI;YACF,MAAM,IAAA,gJAAU,EACd,gBACA,aAAa,IAAI,EACjB,aAAa,QAAQ,EACrB,aAAa,WAAW,EACxB,aAAa,mBAAmB;YAElC,oJAAK,CAAC,OAAO,CAAC;YACd,uBAAuB;YACvB,gBAAgB;gBAAE,MAAM;gBAAI,UAAU;gBAAI,aAAa;gBAAI,qBAAqB,EAAE;YAAC;YACnF;QACF,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,0BAA0B;YACxC,oJAAK,CAAC,KAAK,CAAC,MAAM,QAAQ,EAAE,MAAM,UAAU;QAC9C;IACF;IAEA,MAAM,mBAAmB,OAAO;QAC9B,8BAA8B;QAC9B,IAAI,KAAK,cAAc,EAAE;YACvB,oJAAK,CAAC,KAAK,CAAC;YACZ;QACF;QAEA,gBAAgB;QAChB,wBAAwB;IAC1B;IAEA,MAAM,oBAAoB;QACxB,IAAI,CAAC,cAAc;QAEnB,kBAAkB,aAAa,EAAE;QACjC,IAAI;YACF,MAAM,IAAA,gJAAU,EAAC,aAAa,EAAE;YAChC,oJAAK,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,aAAa,IAAI,CAAC,sBAAsB,CAAC;YAChE,wBAAwB;YACxB,gBAAgB;YAChB;QACF,EAAE,OAAO,OAAY;YACnB,QAAQ,KAAK,CAAC,0BAA0B;YACxC,oJAAK,CAAC,KAAK,CAAC,MAAM,QAAQ,EAAE,MAAM,UAAU;QAC9C,SAAU;YACR,kBAAkB;QACpB;IACF;IAEA,MAAM,gBAAgB,MAAM,MAAM,CAAC,CAAA,OACjC,KAAK,KAAK,CAAC,WAAW,GAAG,QAAQ,CAAC,YAAY,WAAW,OACzD,KAAK,QAAQ,CAAC,WAAW,GAAG,QAAQ,CAAC,YAAY,WAAW,OAC3D,KAAK,SAAS,IAAI,KAAK,SAAS,CAAC,WAAW,GAAG,QAAQ,CAAC,YAAY,WAAW;IAGlF,4BAA4B;IAC5B,MAAM,qBAA6C;QACjD,SAAS;QACT,SAAS;QACT,cAAc;QACd,WAAW;QACX,eAAe;QACf,iBAAiB;QACjB,UAAU;IACZ;IAEA,MAAM,gBAAgB,MACnB,MAAM,CAAC,CAAA,OACN,KAAK,IAAI,CAAC,WAAW,GAAG,QAAQ,CAAC,YAAY,WAAW,OACxD,KAAK,SAAS,CAAC,WAAW,GAAG,QAAQ,CAAC,YAAY,WAAW,OAC5D,KAAK,WAAW,IAAI,KAAK,WAAW,CAAC,WAAW,GAAG,QAAQ,CAAC,YAAY,WAAW,KAErF,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,IAAI,CAAC,aAAa,CAAC,EAAE,IAAI;IAE7C,IAAI,SAAS;QACX,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC,0JAAO;oBAAC,gBAAgB;;;;;;8BACzB,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;sCAAgB;;;;;;;;;;;;;;;;;;;;;;IAKzC;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,0JAAO;gBAAC,gBAAgB;;;;;;0BACzB,6LAAC;gBAAI,WAAU;;kCACf,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,gNAAK;oCAAC,WAAU;;;;;;;;;;;0CAEnB,6LAAC;gCAAG,WAAU;0CAAmC;;;;;;;;;;;;kCAEnD,6LAAC;wBAAE,WAAU;kCAAkC;;;;;;kCAE/C,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;;gCACZ,cAAc,yBACb,6LAAC,oJAAM;oCAAC,SAAS,IAAM,mBAAmB;;sDACxC,6LAAC,mOAAU;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;gCAI1C,cAAc,yBACb,6LAAC,oJAAM;oCAAC,SAAS,IAAM,uBAAuB;;sDAC5C,6LAAC,mNAAM;4CAAC,WAAU;;;;;;wCAAiB;;;;;;;;;;;;;;;;;;kCAQ3C,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCACC,SAAS,IAAM,aAAa;oCAC5B,WAAW,GACT,cAAc,UACV,gCACA,6EACL,mFAAmF,CAAC;;sDAErF,6LAAC,6MAAI;4CAAC,WAAU;;;;;;wCAAY;wCACpB,MAAM,MAAM;wCAAC;;;;;;;8CAEvB,6LAAC;oCACC,SAAS,IAAM,aAAa;oCAC5B,WAAW,GACT,cAAc,UACV,gCACA,6EACL,mFAAmF,CAAC;;sDAErF,6LAAC,mNAAM;4CAAC,WAAU;;;;;;wCAAY;wCACtB,MAAM,MAAM;wCAAC;;;;;;;;;;;;;;;;;;kCAM3B,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC,mNAAM;oCAAC,WAAU;;;;;;8CAClB,6LAAC;oCACC,MAAK;oCACL,aAAa,CAAC,OAAO,EAAE,UAAU,GAAG,CAAC;oCACrC,OAAO;oCACP,UAAU,CAAC,IAAM,eAAe,EAAE,MAAM,CAAC,KAAK;oCAC9C,WAAU;;;;;;;;;;;;;;;;;oBAMf,cAAc,yBACb,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;gCAAM,WAAU;;kDACf,6LAAC;wCAAM,WAAU;kDACf,cAAA,6LAAC;;8DACC,6LAAC;oDAAG,OAAM;oDAAM,WAAU;8DAAY;;;;;;8DACtC,6LAAC;oDAAG,OAAM;oDAAM,WAAU;8DAAY;;;;;;8DACtC,6LAAC;oDAAG,OAAM;oDAAM,WAAU;8DAAY;;;;;;8DACtC,6LAAC;oDAAG,OAAM;oDAAM,WAAU;8DAAY;;;;;;8DACtC,6LAAC;oDAAG,OAAM;oDAAM,WAAU;8DAAwB;;;;;;;;;;;;;;;;;kDAGtD,6LAAC;kDACE,cAAc,MAAM,KAAK,kBACxB,6LAAC;sDACC,cAAA,6LAAC;gDAAG,SAAS;gDAAG,WAAU;0DAAsC;;;;;;;;;;mDAKlE,cAAc,GAAG,CAAC,CAAC,qBACjB,6LAAC;gDAAiB,WAAU;;kEAC1B,6LAAC;wDAAG,WAAU;kEACZ,cAAA,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAI,WAAU;8EACb,cAAA,6LAAC;wEAAI,WAAU;kFACb,cAAA,6LAAC;4EAAK,WAAU;sFACb,KAAK,QAAQ,CAAC,SAAS,CAAC,GAAG,GAAG,WAAW;;;;;;;;;;;;;;;;8EAIhD,6LAAC;oEAAI,WAAU;;sFACb,6LAAC;4EAAI,WAAU;sFAAqD,KAAK,SAAS,IAAI,KAAK,QAAQ;;;;;;sFACnG,6LAAC;4EAAI,WAAU;sFAA4C,KAAK,KAAK;;;;;;;;;;;;;;;;;;;;;;;kEAI3E,6LAAC;wDAAG,WAAU;kEACX,CAAC;4DACA,MAAM,gBAAgB,UAAU,MAAM,CAAC,CAAA,KAAM,GAAG,OAAO,KAAK,KAAK,EAAE;4DACnE,IAAI,cAAc,MAAM,KAAK,GAAG;gEAC9B,qBAAO,6LAAC;oEAAK,WAAU;8EAA2C;;;;;;4DACpE;4DAEA,4BAA4B;4DAC5B,MAAM,cAAc,MAAM,IAAI,CAC5B,IAAI,IACF,cAAc,GAAG,CAAC,CAAA;gEAChB,MAAM,WAAW,AAAC,GAAW,IAAI,EAAE,QAAQ,AAAC,GAAW,SAAS,IAAI;gEACpE,OAAO;oEAAC;oEAAU;iEAAG;4DACvB,IACA,MAAM;4DAGV,qBACE,6LAAC;gEAAI,WAAU;0EACZ,YAAY,GAAG,CAAC,CAAA,mBACf,6LAAC;wEAEC,WAAU;kFAET,AAAC,GAAW,IAAI,EAAE,QAAQ,AAAC,GAAW,SAAS,IAAI;uEAH/C,GAAG,EAAE;;;;;;;;;;wDAQpB,CAAC;;;;;;kEAEH,6LAAC;wDAAG,WAAU;kEACZ,cAAA,6LAAC;4DAAI,WAAU;;gEACZ,CAAC;oEACA,4BAA4B;oEAC5B,MAAM,eAAe,UAAU,IAAI,CACjC,CAAA,KAAM,GAAG,OAAO,KAAK,KAAK,EAAE,IAC1B,CAAC,AAAC,GAAW,IAAI,EAAE,SAAS,WAAW,AAAC,GAAW,SAAS,KAAK,OAAO;oEAG5E,IAAI,cAAc;wEAChB,qBACE,6LAAC;4EAAI,WAAU;;8FACb,6LAAC,mNAAM;oFAAC,WAAU;;;;;;8FAClB,6LAAC;oFAAK,WAAU;8FAAyD;;;;;;;;;;;;oEAK/E;oEAEA,IAAI,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,EAAE,MAAM,GAAG,GAAG;wEAC5C,qBACE,6LAAC;4EAAI,WAAU;sFACZ,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC,IAAI,EAAE,EAAE,GAAG,CAAC,CAAA,wBACjC,6LAAC;oFAEC,WAAU;8FAET,QAAQ,IAAI;mFAHR,QAAQ,EAAE;;;;;;;;;;oEAQzB;oEAEA,qBACE,6LAAC;wEAAK,WAAU;kFAA2C;;;;;;gEAE/D,CAAC;8EACD,6LAAC;oEACC,SAAS,IAAM,2BAA2B;oEAC1C,WAAU;;sFAEV,6LAAC,6MAAI;4EAAC,WAAU;;;;;;wEAAY;;;;;;;;;;;;;;;;;;kEAKlC,6LAAC;wDAAG,WAAU;kEACX,IAAA,8JAAuB,EAAC,KAAK,UAAU;;;;;;kEAE1C,6LAAC;wDAAG,WAAU;kEACZ,cAAA,6LAAC;4DACC,SAAS;gEACP,mBAAmB;oEACjB,MAAM;oEACN,IAAI,KAAK,EAAE;oEACX,MAAM,KAAK,SAAS,IAAI,KAAK,QAAQ;gEACvC;gEACA,uBAAuB;4DACzB;4DACA,WAAU;;8EAEV,6LAAC,mNAAM;oEAAC,WAAU;;;;;;gEAAY;;;;;;;;;;;;;+CA9G3B,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;oBA4H7B,cAAc,yBACb,6LAAC;;0CAEC,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCACC,SAAS,IAAM,aAAa;wCAC5B,WAAW,CAAC,2DAA2D,EACrE,cAAc,SACV,gCACA,iGACJ;kDACH;;;;;;kDAGD,6LAAC;wCACC,SAAS,IAAM,aAAa;wCAC5B,WAAW,CAAC,2DAA2D,EACrE,cAAc,WACV,gCACA,iGACJ;kDACH;;;;;;;;;;;;4BAMF,cAAc,wBACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC;wCAAM,WAAU;;0DACf,6LAAC;gDAAM,WAAU;0DACf,cAAA,6LAAC;;sEACC,6LAAC;4DAAG,OAAM;4DAAM,WAAU;sEAAY;;;;;;sEACtC,6LAAC;4DAAG,OAAM;4DAAM,WAAU;sEAAY;;;;;;sEACtC,6LAAC;4DAAG,OAAM;4DAAM,WAAU;sEAAY;;;;;;sEACtC,6LAAC;4DAAG,OAAM;4DAAM,WAAU;sEAAY;;;;;;sEACtC,6LAAC;4DAAG,OAAM;4DAAM,WAAU;sEAAY;;;;;;sEACtC,6LAAC;4DAAG,OAAM;4DAAM,WAAU;sEAAY;;;;;;sEACtC,6LAAC;4DAAG,OAAM;4DAAM,WAAU;sEAAY;;;;;;;;;;;;;;;;;0DAG1C,6LAAC;0DACE,cAAc,MAAM,KAAK,kBACxB,6LAAC;8DACC,cAAA,6LAAC;wDAAG,SAAS;wDAAG,WAAU;;4DAAsC;4DAC7C,MAAM,MAAM,KAAK,IAAI,qEAAqE;;;;;;;;;;;2DAI/G,cAAc,GAAG,CAAC,CAAC,qBACjB,6LAAC;wDAAiB,WAAU;;0EAC1B,6LAAC;gEAAG,WAAU;0EACZ,cAAA,6LAAC;oEAAI,WAAU;8EAA6C,KAAK,IAAI;;;;;;;;;;;0EAEvE,6LAAC;gEAAG,WAAU;0EACZ,cAAA,6LAAC;oEAAK,WAAU;8EACb,kBAAkB,CAAC,KAAK,SAAS,CAAC,IAAI,KAAK,SAAS,CAAC,OAAO,CAAC,MAAM;;;;;;;;;;;0EAGxE,6LAAC;gEAAG,WAAU;0EACZ,cAAA,6LAAC;oEAAI,WAAU;8EACZ,KAAK,WAAW,IAAI;;;;;;;;;;;0EAGzB,6LAAC;gEAAG,WAAU;0EACZ,cAAA,6LAAC;oEAAK,WAAW,CAAC,8DAA8D,EAC9E,KAAK,SAAS,GAAG,gCAAgC,6BACjD;8EACC,KAAK,SAAS,GAAG,WAAW;;;;;;;;;;;0EAGjC,6LAAC;gEAAG,WAAU;0EACZ,cAAA,6LAAC;oEAAK,WAAW,CAAC,8DAA8D,EAC9E,KAAK,cAAc,GAAG,kCAAkC,6BACxD;8EACC,KAAK,cAAc,GAAG,WAAW;;;;;;;;;;;0EAGtC,6LAAC;gEAAG,WAAU;0EACX,IAAA,8JAAuB,EAAC,KAAK,UAAU;;;;;;0EAE1C,6LAAC;gEAAG,WAAU;0EACZ,cAAA,6LAAC;oEACC,SAAS,IAAM,iBAAiB;oEAChC,UAAU,KAAK,cAAc,IAAI,mBAAmB,KAAK,EAAE;oEAC3D,WAAU;oEACV,OAAO,KAAK,cAAc,GAAG,+BAA+B;;sFAE5D,6LAAC,uNAAM;4EAAC,MAAM;;;;;;wEACb,mBAAmB,KAAK,EAAE,GAAG,gBAAgB;;;;;;;;;;;;;uDAvC3C,KAAK,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;4BAoD7B,cAAc,0BACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC,kLAAgB;oCAAC,gBAAgB;oCAAgB,SAAS;;;;;;;;;;;;;;;;;oBAOlE,iCACC,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAG,WAAU;8CAAyB;;;;;;8CACvC,6LAAC;oCAAE,WAAU;8CAAgD;;;;;;8CAI7D,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;;8DACC,6LAAC;oDAAM,WAAU;;wDAAkE;sEACnE,6LAAC;4DAAK,WAAU;sEAAe;;;;;;;;;;;;8DAE/C,6LAAC;oDACC,MAAK;oDACL,OAAO,aAAa,KAAK;oDACzB,UAAU,CAAC,IAAM,gBAAgB;4DAAE,GAAG,YAAY;4DAAE,OAAO,EAAE,MAAM,CAAC,KAAK;wDAAC;oDAC1E,WAAU;oDACV,aAAY;;;;;;;;;;;;sDAIhB,6LAAC;;8DACC,6LAAC;oDAAM,WAAU;8DAAkE;;;;;;8DAGnF,6LAAC;oDACC,MAAK;oDACL,OAAO,aAAa,SAAS;oDAC7B,UAAU,CAAC,IAAM,gBAAgB;4DAAE,GAAG,YAAY;4DAAE,WAAW,EAAE,MAAM,CAAC,KAAK;wDAAC;oDAC9E,WAAU;oDACV,aAAY;;;;;;8DAEd,6LAAC;oDAAE,WAAU;8DAAgD;;;;;;;;;;;;sDAK/D,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC;gDAAE,WAAU;;oDAA2C;kEACrB,6LAAC;kEAAO;;;;;;oDAAe;;;;;;;;;;;;;;;;;;8CAK9D,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,oJAAM;4CACL,SAAQ;4CACR,SAAS;gDACP,mBAAmB;gDACnB,gBAAgB;oDAAE,OAAO;oDAAI,UAAU;oDAAI,UAAU;oDAAI,WAAW;gDAAG;4CACzE;sDACD;;;;;;sDAGD,6LAAC,oJAAM;4CACL,SAAS;4CACT,UAAU,CAAC,aAAa,KAAK;sDAC9B;;;;;;;;;;;;;;;;;;;;;;;oBASR,qCACC,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAG,WAAU;8CAAyB;;;;;;8CACvC,6LAAC;oCAAE,WAAU;8CAAgD;;;;;;8CAI7D,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;;8DACC,6LAAC;oDAAM,WAAU;;wDAAkE;sEACvE,6LAAC;4DAAK,WAAU;sEAAe;;;;;;;;;;;;8DAE3C,6LAAC;oDACC,MAAK;oDACL,OAAO,aAAa,IAAI;oDACxB,UAAU,CAAC,IAAM,gBAAgB;4DAAE,GAAG,YAAY;4DAAE,MAAM,EAAE,MAAM,CAAC,KAAK;wDAAC;oDACzE,WAAU;oDACV,aAAY;;;;;;;;;;;;sDAIhB,6LAAC;;8DACC,6LAAC;oDAAM,WAAU;;wDAAkE;sEACvE,6LAAC;4DAAK,WAAU;sEAAe;;;;;;;;;;;;8DAE3C,6LAAC;oDACC,MAAK;oDACL,OAAO,aAAa,QAAQ;oDAC5B,UAAU,CAAC,IAAM,gBAAgB;4DAAE,GAAG,YAAY;4DAAE,UAAU,EAAE,MAAM,CAAC,KAAK;wDAAC;oDAC7E,WAAU;oDACV,aAAY;;;;;;8DAEd,6LAAC;oDAAE,WAAU;8DAAgD;;;;;;;;;;;;sDAK/D,6LAAC;;8DACC,6LAAC;oDAAM,WAAU;8DAAkE;;;;;;8DAGnF,6LAAC;oDACC,OAAO,aAAa,WAAW;oDAC/B,UAAU,CAAC,IAAM,gBAAgB;4DAAE,GAAG,YAAY;4DAAE,aAAa,EAAE,MAAM,CAAC,KAAK;wDAAC;oDAChF,WAAU;oDACV,MAAM;oDACN,aAAY;;;;;;;;;;;;sDAIhB,6LAAC;;8DACC,6LAAC;oDAAM,WAAU;8DAAkE;;;;;;8DAGnF,6LAAC;oDAAE,WAAU;8DAAgD;;;;;;8DAG7D,6LAAC;oDAAI,WAAU;8DACZ,YAAY,MAAM,KAAK,kBACtB,6LAAC;wDAAE,WAAU;kEAAyC;;;;;6EAItD,6LAAC;wDAAI,WAAU;kEACZ,CAAC;4DACA,8BAA8B;4DAC9B,MAAM,eAAe,YAAY,MAAM,CAAC,CAAC,KAAK;gEAC5C,MAAM,SAAS,WAAW,QAAQ;gEAClC,IAAI,CAAC,GAAG,CAAC,OAAO,EAAE;oEAChB,GAAG,CAAC,OAAO,GAAG,EAAE;gEAClB;gEACA,GAAG,CAAC,OAAO,CAAC,IAAI,CAAC;gEACjB,OAAO;4DACT,GAAG,CAAC;4DAEJ,iCAAiC;4DACjC,MAAM,eAA8E;gEAClF,gBAAgB;oEAAE,MAAM;oEAAkB,MAAM;oEAAM,OAAO;gEAAO;gEACpE,aAAa;oEAAE,MAAM;oEAAe,MAAM;oEAAM,OAAO;gEAAQ;gEAC/D,iBAAiB;oEAAE,MAAM;oEAAmB,MAAM;oEAAM,OAAO;gEAAS;gEACxE,kBAAkB;oEAAE,MAAM;oEAAoB,MAAM;oEAAM,OAAO;gEAAM;gEACvE,qBAAqB;oEAAE,MAAM;oEAAuB,MAAM;oEAAK,OAAO;gEAAS;gEAC/E,gBAAgB;oEAAE,MAAM;oEAAkB,MAAM;oEAAM,OAAO;gEAAS;4DACxE;4DAEA,eAAe;4DACf,MAAM,gBAAgB,OAAO,IAAI,CAAC,cAAc,IAAI,CAAC,CAAC,GAAG;gEACvD,MAAM,QAAQ;oEAAC;oEAAkB;oEAAe;oEAAmB;oEAAoB;oEAAuB;iEAAiB;gEAC/H,OAAO,MAAM,OAAO,CAAC,KAAK,MAAM,OAAO,CAAC;4DAC1C;4DAEA,OAAO,cAAc,GAAG,CAAC,CAAC;gEACxB,MAAM,SAAS,YAAY,CAAC,OAAO,IAAI;oEAAE,MAAM;oEAAQ,MAAM;oEAAM,OAAO;gEAAO;gEACjF,MAAM,cAAc,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,GAAG;oEAChD,MAAM,QAAQ;wEAAC;wEAAQ;wEAAS;wEAAW;qEAAS;oEACpD,OAAO,MAAM,OAAO,CAAC,EAAE,MAAM,IAAI,MAAM,OAAO,CAAC,EAAE,MAAM;gEACzD;gEAEA,MAAM,eAAe;oEACnB,MAAM;oEACN,OAAO;oEACP,QAAQ;oEACR,KAAK;oEACL,QAAQ;oEACR,QAAQ;oEACR,MAAM;gEACR;gEAEA,qBACE,6LAAC;oEAAiB,WAAW,CAAC,sBAAsB,EAAE,YAAY,CAAC,OAAO,KAAK,CAA8B,EAAE;;sFAC7G,6LAAC;4EAAI,WAAU;;8FACb,6LAAC;oFAAK,WAAU;8FAAW,OAAO,IAAI;;;;;;8FACtC,6LAAC;oFAAG,WAAU;8FACX,OAAO,IAAI;;;;;;8FAEd,6LAAC;oFAAK,WAAU;;wFACb,YAAY,MAAM,CAAC,CAAA,IAAK,aAAa,mBAAmB,CAAC,QAAQ,CAAC,EAAE,EAAE,GAAG,MAAM;wFAAC;wFAAE,YAAY,MAAM;wFAAC;;;;;;;;;;;;;sFAG1G,6LAAC;4EAAI,WAAU;sFACZ,YAAY,GAAG,CAAC,CAAC,2BAChB,6LAAC;oFAEC,WAAU;;sGAEV,6LAAC;4FACC,MAAK;4FACL,SAAS,aAAa,mBAAmB,CAAC,QAAQ,CAAC,WAAW,EAAE;4FAChE,UAAU,CAAC;gGACT,IAAI,EAAE,MAAM,CAAC,OAAO,EAAE;oGACpB,gBAAgB;wGACd,GAAG,YAAY;wGACf,qBAAqB;+GAAI,aAAa,mBAAmB;4GAAE,WAAW,EAAE;yGAAC;oGAC3E;gGACF,OAAO;oGACL,gBAAgB;wGACd,GAAG,YAAY;wGACf,qBAAqB,aAAa,mBAAmB,CAAC,MAAM,CAAC,CAAA,KAAM,OAAO,WAAW,EAAE;oGACzF;gGACF;4FACF;4FACA,WAAU;;;;;;sGAEZ,6LAAC;4FAAI,WAAU;;8GACb,6LAAC;oGAAI,WAAU;;sHACb,6LAAC;4GAAK,WAAU;sHACb,WAAW,MAAM;;;;;;sHAEpB,6LAAC;4GAAK,WAAU;sHAAoB,WAAW,IAAI;;;;;;;;;;;;gGAEpD,WAAW,WAAW,kBACrB,6LAAC;oGAAI,WAAU;8GACZ,WAAW,WAAW;;;;;;;;;;;;;mFA9BxB,WAAW,EAAE;;;;;;;;;;;mEAbhB;;;;;4DAoDd;wDACF,CAAC;;;;;;;;;;;gDAIN,aAAa,mBAAmB,CAAC,MAAM,GAAG,mBACzC,6LAAC;oDAAE,WAAU;;wDAAgD;wDACxD,aAAa,mBAAmB,CAAC,MAAM;wDAAC;wDACzC,IAAI,IAAI,YAAY,MAAM,CAAC,CAAA,IAAK,aAAa,mBAAmB,CAAC,QAAQ,CAAC,EAAE,EAAE,GAAG,GAAG,CAAC,CAAA,IAAK,EAAE,QAAQ,GAAG,IAAI;wDAC5G;;;;;;;;;;;;;;;;;;;8CAMT,6LAAC;oCAAI,WAAU;;sDACb,6LAAC,oJAAM;4CACL,SAAQ;4CACR,SAAS;gDACP,uBAAuB;gDACvB,gBAAgB;oDAAE,MAAM;oDAAI,UAAU;oDAAI,aAAa;oDAAI,qBAAqB,EAAE;gDAAC;4CACrF;sDACD;;;;;;sDAGD,6LAAC,oJAAM;4CACL,SAAS;4CACT,UAAU,CAAC,aAAa,IAAI,IAAI,CAAC,aAAa,QAAQ;sDACvD;;;;;;;;;;;;;;;;;;;;;;;oBASR,0BAA0B,yCACzB,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC;;0DACC,6LAAC;gDAAG,WAAU;;oDAAkD;oDACzC,wBAAwB,SAAS,IAAI,wBAAwB,QAAQ;;;;;;;0DAE5F,6LAAC;gDAAE,WAAU;0DAAgD;;;;;;;;;;;;;;;;;8CAMjE,6LAAC;oCAAI,WAAU;8CACZ,SAAS,MAAM,KAAK,kBACnB,6LAAC;wCAAI,WAAU;kDAAkC;;;;;+CAIjD,SAAS,GAAG,CAAC,CAAC;wCACZ,MAAM,aAAa,CAAC,YAAY,CAAC,wBAAwB,EAAE,CAAC,IAAI,EAAE,EAC/D,IAAI,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK,QAAQ,EAAE;wCAEhC,qBACE,6LAAC;4CAEC,WAAW,CAAC,0EAA0E,EACpF,aACI,4EACA,mFACJ;;8DAEF,6LAAC;oDAAI,WAAU;;sEACb,6LAAC;4DAAI,WAAU;;8EACb,6LAAC;oEAAI,WAAU;8EACZ,QAAQ,IAAI;;;;;;gEAEd,4BACC,6LAAC;oEAAK,WAAU;8EAAqG;;;;;;;;;;;;wDAKxH,QAAQ,WAAW,kBAClB,6LAAC;4DAAI,WAAU;sEACZ,QAAQ,WAAW;;;;;;;;;;;;8DAK1B,6LAAC;oDAAI,WAAU;8DACZ,2BACC,6LAAC;wDACC,SAAS,IAAM,wBAAwB,QAAQ,EAAE;wDACjD,WAAU;kEACX;;;;;6EAID,6LAAC;wDACC,SAAS,IAAM,sBAAsB,QAAQ,EAAE;wDAC/C,WAAU;kEACX;;;;;;;;;;;;2CArCA,QAAQ,EAAE;;;;;oCA4CrB;;;;;;8CAIJ,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;;gDACZ,CAAC,YAAY,CAAC,wBAAwB,EAAE,CAAC,IAAI,EAAE,EAAE,MAAM;gDAAC;gDAAK,SAAS,MAAM;gDAAC;;;;;;;sDAEhF,6LAAC;4CACC,SAAS;gDACP,0BAA0B;gDAC1B,2BAA2B;4CAC7B;4CACA,WAAU;sDACX;;;;;;;;;;;;;;;;;;;;;;;oBASR,uBAAuB,iCACtB,6LAAC,yLAAmB;wBAClB,QAAQ;wBACR,SAAS;4BACP,uBAAuB;4BACvB,mBAAmB;4BACnB,aAAY,kCAAkC;wBAChD;wBACA,gBAAgB;wBAChB,YAAY,gBAAgB,IAAI;wBAChC,UAAU,gBAAgB,EAAE;wBAC5B,YAAY,gBAAgB,IAAI;wBAChC,mBAAmB;wBACnB,gBAAgB;wBAChB,aAAa;4BACX,4EAA4E;4BAC5E,IAAI;gCACF,MAAM,mBAAmB,MAAM,6IAAG,CAAC,GAAG,CAAC,qBAAqB;oCAC1D,QAAQ;wCAAE,iBAAiB;oCAAe;gCAC5C;gCACA,YAAY,iBAAiB,IAAI;4BACnC,EAAE,OAAO,OAAO;gCACd,QAAQ,KAAK,CAAC,8BAA8B;4BAC9C;wBACF;;;;;;oBAKH,wBAAwB,8BACvB,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAI,WAAU;sDACb,cAAA,6LAAC,uNAAM;gDAAC,WAAU;;;;;;;;;;;sDAEpB,6LAAC;sDACC,cAAA,6LAAC;gDAAG,WAAU;0DAAoD;;;;;;;;;;;;;;;;;8CAGtE,6LAAC;oCAAE,WAAU;;wCAAwC;sDACV,6LAAC;sDAAQ,aAAa,IAAI;;;;;;wCAAU;;;;;;;8CAE/E,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CACC,SAAS;gDACP,wBAAwB;gDACxB,gBAAgB;4CAClB;4CACA,UAAU,mBAAmB;4CAC7B,WAAU;sDACX;;;;;;sDAGD,6LAAC;4CACC,SAAS;4CACT,UAAU,mBAAmB;4CAC7B,WAAU;sDAET,mBAAmB,aAAa,EAAE,iBACjC;;kEACE,6LAAC;wDAAK,WAAU;kEAAe;;;;;;oDAAQ;;6EAIzC;;kEACE,6LAAC,uNAAM;wDAAC,MAAM;;;;;;oDAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAYxC;GAtnCwB;;QACP,kJAAS;QAEM,iJAAO;;;KAHf","debugId":null}}]
}