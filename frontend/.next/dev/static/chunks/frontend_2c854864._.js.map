{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/api/index.ts"],"sourcesContent":["import axios from 'axios'\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000'\n\n// Create axios instance\nconst api = axios.create({\n  baseURL: API_URL,\n  withCredentials: true,\n})\n\n// Add request interceptor to include access token\napi.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem('access_token')\n    if (token) {\n      config.headers.Authorization = `Bearer ${token}`\n    }\n    return config\n  },\n  (error) => Promise.reject(error)\n)\n\n// Add response interceptor to handle token refresh\napi.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config\n\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true\n\n      try {\n        // Try to refresh the token\n        const refreshToken = localStorage.getItem('refresh_token')\n        if (refreshToken) {\n          const response = await axios.post(`${API_URL}/api/v1/auth/refresh`, {\n            refresh_token: refreshToken,\n          }, {\n            withCredentials: true,\n          })\n\n          const { access_token } = response.data\n          localStorage.setItem('access_token', access_token)\n\n          // Retry the original request with new token\n          originalRequest.headers.Authorization = `Bearer ${access_token}`\n          return api(originalRequest)\n        }\n      } catch (refreshError) {\n        // Refresh failed, redirect to login\n        localStorage.removeItem('access_token')\n        localStorage.removeItem('refresh_token')\n        window.location.href = '/auth/signin'\n        return Promise.reject(refreshError)\n      }\n    }\n\n    return Promise.reject(error)\n  }\n)\n\nexport default api\n"],"names":[],"mappings":";;;;AAEgB;AAFhB;;AAEA,MAAM,UAAU,6DAAmC;AAEnD,wBAAwB;AACxB,MAAM,MAAM,mJAAK,CAAC,MAAM,CAAC;IACvB,SAAS;IACT,iBAAiB;AACnB;AAEA,kDAAkD;AAClD,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAC1B,CAAC;IACC,MAAM,QAAQ,aAAa,OAAO,CAAC;IACnC,IAAI,OAAO;QACT,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;IAClD;IACA,OAAO;AACT,GACA,CAAC,QAAU,QAAQ,MAAM,CAAC;AAG5B,mDAAmD;AACnD,IAAI,YAAY,CAAC,QAAQ,CAAC,GAAG,CAC3B,CAAC,WAAa,UACd,OAAO;IACL,MAAM,kBAAkB,MAAM,MAAM;IAEpC,IAAI,MAAM,QAAQ,EAAE,WAAW,OAAO,CAAC,gBAAgB,MAAM,EAAE;QAC7D,gBAAgB,MAAM,GAAG;QAEzB,IAAI;YACF,2BAA2B;YAC3B,MAAM,eAAe,aAAa,OAAO,CAAC;YAC1C,IAAI,cAAc;gBAChB,MAAM,WAAW,MAAM,mJAAK,CAAC,IAAI,CAAC,GAAG,QAAQ,oBAAoB,CAAC,EAAE;oBAClE,eAAe;gBACjB,GAAG;oBACD,iBAAiB;gBACnB;gBAEA,MAAM,EAAE,YAAY,EAAE,GAAG,SAAS,IAAI;gBACtC,aAAa,OAAO,CAAC,gBAAgB;gBAErC,4CAA4C;gBAC5C,gBAAgB,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,cAAc;gBAChE,OAAO,IAAI;YACb;QACF,EAAE,OAAO,cAAc;YACrB,oCAAoC;YACpC,aAAa,UAAU,CAAC;YACxB,aAAa,UAAU,CAAC;YACxB,OAAO,QAAQ,CAAC,IAAI,GAAG;YACvB,OAAO,QAAQ,MAAM,CAAC;QACxB;IACF;IAEA,OAAO,QAAQ,MAAM,CAAC;AACxB;uCAGa","debugId":null}},
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/app/organizations/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { useAuth } from '@/lib/auth-context'\nimport api from '@/lib/api'\nimport { toast } from 'sonner'\nimport { Plus } from 'lucide-react'\n\ninterface Organisation {\n  id: string\n  name: string\n  website?: string\n  description?: string\n  owner_id: string\n  created_at: string\n  updated_at?: string\n}\n\ninterface OrganisationStats {\n  org: Organisation\n  projectCount: number\n  userCount: number\n}\n\nexport default function OrganizationsPage() {\n  const { user, loading } = useAuth()\n  const router = useRouter()\n  const [organisations, setOrganisations] = useState<OrganisationStats[]>([])\n  const [pageLoading, setPageLoading] = useState(true)\n\n  useEffect(() => {\n    if (loading) return\n\n    if (!user) {\n      router.push('/auth/signin')\n      return\n    }\n\n    fetchOrganisations()\n  }, [user, loading, router])\n\n  const fetchOrganisations = async () => {\n    try {\n      const response = await api.get('/api/v1/organisations/')\n\n      // If user has exactly one organization, redirect directly to it\n      if (response.data.length === 1) {\n        const org = response.data[0]\n        localStorage.setItem('current_organisation', JSON.stringify(org))\n        window.dispatchEvent(new CustomEvent('organisationChanged', { detail: org }))\n        router.push(`/organizations/${org.id}/projects`)\n        return\n      }\n\n      // Fetch stats for each organization\n      const orgsWithStats = await Promise.all(\n        response.data.map(async (org: Organisation) => {\n          try {\n            const [projectsRes, membersRes] = await Promise.all([\n              api.get(`/api/v1/projects/?organisation_id=${org.id}`),\n              api.get(`/api/v1/organisations/${org.id}/members/`).catch(() => ({ data: [] }))\n            ])\n\n            return {\n              org,\n              projectCount: projectsRes.data.length || 0,\n              userCount: membersRes.data.length || 1\n            }\n          } catch (error) {\n            return {\n              org,\n              projectCount: 0,\n              userCount: 1\n            }\n          }\n        })\n      )\n\n      setOrganisations(orgsWithStats)\n    } catch (error: any) {\n      console.error('Failed to fetch organisations:', error)\n      toast.error('Failed to load organisations')\n    } finally {\n      setPageLoading(false)\n    }\n  }\n\n  const handleSelectOrganisation = (org: Organisation) => {\n    localStorage.setItem('current_organisation', JSON.stringify(org))\n    window.dispatchEvent(new CustomEvent('organisationChanged', { detail: org }))\n    router.push(`/organizations/${org.id}/projects`)\n  }\n\n  if (loading || pageLoading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-gray-600 dark:text-gray-400\">Loading organisations...</p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 dark:bg-gray-900 py-12 px-4\">\n      <div className=\"max-w-4xl mx-auto\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-2\">\n            Your Organizations\n          </h1>\n          <p className=\"text-gray-600 dark:text-gray-400\">\n            Select an organization to get started\n          </p>\n        </div>\n\n        {organisations.length === 0 ? (\n          <div className=\"text-center py-12\">\n            <p className=\"text-gray-600 dark:text-gray-400 mb-6\">\n              You don't have any organisations yet\n            </p>\n            <button\n              onClick={() => router.push('/organisations/new')}\n              className=\"inline-flex items-center px-6 py-3 rounded-lg bg-primary text-white font-medium hover:bg-primary/90 transition-colors\"\n            >\n              <Plus className=\"w-5 h-5 mr-2\" />\n              Create Organisation\n            </button>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {organisations.map(({ org, projectCount, userCount }) => (\n              <div\n                key={org.id}\n                className=\"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-6 flex items-center justify-between hover:shadow-md transition-shadow\"\n              >\n                <div className=\"flex items-center gap-4 flex-1\">\n                  {/* Organization Avatar */}\n                  <div className=\"flex-shrink-0 w-12 h-12 rounded-lg bg-primary/10 dark:bg-primary/20 flex items-center justify-center\">\n                    <span className=\"text-sm font-semibold text-primary\">\n                      {org.name.substring(0, 2).toUpperCase()}\n                    </span>\n                  </div>\n\n                  {/* Organization Info */}\n                  <div className=\"flex-1 min-w-0\">\n                    <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\n                      {org.name}\n                    </h3>\n                    <div className=\"flex gap-4 text-sm text-gray-600 dark:text-gray-400\">\n                      <span>{projectCount} project{projectCount !== 1 ? 's' : ''}</span>\n                      <span>{userCount} user{userCount !== 1 ? 's' : ''}</span>\n                    </div>\n                  </div>\n                </div>\n\n                {/* Open Button */}\n                <button\n                  onClick={() => handleSelectOrganisation(org)}\n                  className=\"ml-4 flex-shrink-0 px-6 py-2 rounded-lg border-2 border-primary text-primary font-medium hover:bg-primary hover:text-white transition-colors\"\n                >\n                  Open\n                </button>\n              </div>\n            ))}\n\n            {/* Create New Organization Button */}\n            <button\n              onClick={() => router.push('/organisations/new')}\n              className=\"w-full py-4 rounded-lg border-2 border-dashed border-gray-300 dark:border-gray-600 text-gray-600 dark:text-gray-400 font-medium hover:border-primary hover:text-primary dark:hover:text-primary transition-colors\"\n            >\n              <Plus className=\"w-5 h-5 mx-auto mb-2\" />\n              Create new organization\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}