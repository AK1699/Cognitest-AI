{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/api/index.ts"],"sourcesContent":["import axios from 'axios'\n\nconst API_URL = process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000'\n\n// Create axios instance\nconst api = axios.create({\n  baseURL: API_URL,\n  withCredentials: true,\n})\n\n// Request interceptor - cookies are automatically sent via withCredentials: true\napi.interceptors.request.use(\n  (config) => {\n    // With httpOnly cookies, authorization is handled automatically\n    // No need to manually add Bearer token\n    return config\n  },\n  (error) => Promise.reject(error)\n)\n\n// Add response interceptor to handle token refresh\napi.interceptors.response.use(\n  (response) => response,\n  async (error) => {\n    const originalRequest = error.config\n\n    if (error.response?.status === 401 && !originalRequest._retry) {\n      originalRequest._retry = true\n\n      try {\n        // Try to refresh the token using httpOnly cookies\n        // The refresh endpoint will use the httpOnly refresh_token cookie automatically\n        const response = await axios.post(`${API_URL}/api/v1/auth/refresh`, {}, {\n          withCredentials: true,\n        })\n\n        // The server will set new httpOnly cookies automatically\n        // Just retry the original request\n        return api(originalRequest)\n      } catch (refreshError) {\n        // Refresh failed, redirect to login only if not already on signin page\n        // httpOnly cookies are managed by the server\n        // Clear any stale localStorage tokens for backward compatibility\n        if (localStorage.getItem('access_token')) {\n          localStorage.removeItem('access_token')\n        }\n        if (localStorage.getItem('refresh_token')) {\n          localStorage.removeItem('refresh_token')\n        }\n\n        // Only redirect if we're not already on the signin page\n        if (typeof window !== 'undefined' && !window.location.pathname.includes('/auth/signin')) {\n          window.location.href = '/auth/signin'\n        }\n        return Promise.reject(refreshError)\n      }\n    }\n\n    return Promise.reject(error)\n  }\n)\n\nexport default api\n"],"names":[],"mappings":";;;;AAEgB;AAFhB;;AAEA,MAAM,UAAU,6DAAmC;AAEnD,wBAAwB;AACxB,MAAM,MAAM,mJAAK,CAAC,MAAM,CAAC;IACvB,SAAS;IACT,iBAAiB;AACnB;AAEA,iFAAiF;AACjF,IAAI,YAAY,CAAC,OAAO,CAAC,GAAG,CAC1B,CAAC;IACC,gEAAgE;IAChE,uCAAuC;IACvC,OAAO;AACT,GACA,CAAC,QAAU,QAAQ,MAAM,CAAC;AAG5B,mDAAmD;AACnD,IAAI,YAAY,CAAC,QAAQ,CAAC,GAAG,CAC3B,CAAC,WAAa,UACd,OAAO;IACL,MAAM,kBAAkB,MAAM,MAAM;IAEpC,IAAI,MAAM,QAAQ,EAAE,WAAW,OAAO,CAAC,gBAAgB,MAAM,EAAE;QAC7D,gBAAgB,MAAM,GAAG;QAEzB,IAAI;YACF,kDAAkD;YAClD,gFAAgF;YAChF,MAAM,WAAW,MAAM,mJAAK,CAAC,IAAI,CAAC,GAAG,QAAQ,oBAAoB,CAAC,EAAE,CAAC,GAAG;gBACtE,iBAAiB;YACnB;YAEA,yDAAyD;YACzD,kCAAkC;YAClC,OAAO,IAAI;QACb,EAAE,OAAO,cAAc;YACrB,uEAAuE;YACvE,6CAA6C;YAC7C,iEAAiE;YACjE,IAAI,aAAa,OAAO,CAAC,iBAAiB;gBACxC,aAAa,UAAU,CAAC;YAC1B;YACA,IAAI,aAAa,OAAO,CAAC,kBAAkB;gBACzC,aAAa,UAAU,CAAC;YAC1B;YAEA,wDAAwD;YACxD,IAAI,+CAAkB,eAAe,CAAC,OAAO,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,iBAAiB;gBACvF,OAAO,QAAQ,CAAC,IAAI,GAAG;YACzB;YACA,OAAO,QAAQ,MAAM,CAAC;QACxB;IACF;IAEA,OAAO,QAAQ,MAAM,CAAC;AACxB;uCAGa","debugId":null}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/lib/auth-context.tsx"],"sourcesContent":["'use client'\n\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react'\nimport { useRouter } from 'next/navigation'\nimport api from '@/lib/api'\n\ninterface User {\n  id: string\n  email: string\n  username: string\n  full_name?: string\n  avatar_url?: string\n  is_active: boolean\n  is_superuser: boolean\n  created_at: string\n}\n\ninterface AuthContextType {\n  user: User | null\n  loading: boolean\n  login: (email: string, password: string) => Promise<void>\n  signup: (email: string, username: string, password: string, fullName?: string) => Promise<void>\n  logout: () => void\n  checkAuth: () => Promise<void>\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null)\n  const [loading, setLoading] = useState(true)\n  const router = useRouter()\n\n  const checkAuth = async () => {\n    try {\n      // Fetch user info using httpOnly cookies\n      const response = await api.get(`/api/v1/auth/me`)\n      setUser(response.data)\n    } catch (error: any) {\n      // 401 is expected when user is not logged in - don't log it as an error\n      if (error.response?.status !== 401) {\n        console.error('Auth check failed:', error)\n      }\n      setUser(null)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  useEffect(() => {\n    checkAuth()\n  }, [])\n\n  const login = async (email: string, password: string) => {\n    try {\n      const response = await api.post(`/api/v1/auth/login`, {\n        email,\n        password\n      })\n\n      // Tokens are set as httpOnly cookies by the server, no need to store in localStorage\n\n      // Fetch user data after successful login\n      const userResponse = await api.get(`/api/v1/auth/me`)\n      setUser(userResponse.data)\n\n      // Fetch organizations to determine redirect\n      try {\n        const orgsResponse = await api.get(`/api/v1/organisations/`)\n        const organisations = orgsResponse.data\n\n        if (organisations.length === 0) {\n          // No organizations - redirect to create first one\n          router.push('/organizations/new')\n        } else if (organisations.length === 1) {\n          // One organization - auto-select and go to projects\n          localStorage.setItem('current_organization', JSON.stringify(organisations[0]))\n          router.push(`/organizations/${organisations[0].id}/projects`)\n        } else {\n          // Multiple organizations - show selection page\n          router.push('/organizations')\n        }\n      } catch (orgError) {\n        console.error('Failed to fetch organisations:', orgError)\n        // Fallback if org fetch fails\n        router.push('/organizations')\n      }\n    } catch (error: any) {\n      console.error('Login failed:', error)\n      throw new Error(error.response?.data?.detail || 'Login failed')\n    }\n  }\n\n  const signup = async (email: string, username: string, password: string, fullName?: string) => {\n    try {\n      const response = await api.post(`/api/v1/auth/signup`, {\n        email,\n        username,\n        password,\n        full_name: fullName\n      })\n\n      // Tokens are set as httpOnly cookies by the server, no need to store in localStorage\n\n      // Fetch user data after successful signup\n      const userResponse = await api.get(`/api/v1/auth/me`)\n      setUser(userResponse.data)\n\n      // Fetch organizations to determine redirect\n      try {\n        const orgsResponse = await api.get(`/api/v1/organisations/`)\n        const organisations = orgsResponse.data\n\n        if (organisations.length === 0) {\n          // No organizations - redirect to create first one\n          router.push('/organizations/new')\n        } else if (organisations.length === 1) {\n          // One organization - auto-select and go to projects\n          localStorage.setItem('current_organization', JSON.stringify(organisations[0]))\n          router.push(`/organizations/${organisations[0].id}/projects`)\n        } else {\n          // Multiple organizations - show selection page\n          router.push('/organizations')\n        }\n      } catch (orgError) {\n        console.error('Failed to fetch organisations:', orgError)\n        // Fallback if org fetch fails\n        router.push('/organizations')\n      }\n    } catch (error: any) {\n      console.error('Signup failed:', error)\n      throw new Error(error.response?.data?.detail || 'Signup failed')\n    }\n  }\n\n  const logout = () => {\n    // Clear organization and project preferences\n    localStorage.removeItem('current_organization')\n    localStorage.removeItem('current_project')\n    setUser(null)\n    // Note: httpOnly cookies are cleared by the server on logout\n    router.push('/auth/signin')\n  }\n\n  return (\n    <AuthContext.Provider value={{ user, loading, login, signup, logout, checkAuth }}>\n      {children}\n    </AuthContext.Provider>\n  )\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext)\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider')\n  }\n  return context\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 226, "column": 0}, "map": {"version":3,"sources":["file:///Applications/TestingHub/testingHub/Cognitest-AI/frontend/components/providers.tsx"],"sourcesContent":["'use client'\n\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query'\nimport { ThemeProvider } from 'next-themes'\nimport { Toaster } from 'sonner'\nimport { useState } from 'react'\nimport { AuthProvider } from '@/lib/auth-context'\n\nexport function Providers({ children }: { children: React.ReactNode }) {\n  const [queryClient] = useState(() => new QueryClient({\n    defaultOptions: {\n      queries: {\n        staleTime: 60 * 1000, // 1 minute\n        refetchOnWindowFocus: false,\n      },\n    },\n  }))\n\n  return (\n    <QueryClientProvider client={queryClient}>\n      <ThemeProvider attribute=\"class\" defaultTheme=\"light\" enableSystem={false} forcedTheme=\"light\">\n        <AuthProvider>\n          {children}\n          <Toaster position=\"top-right\" richColors />\n        </AuthProvider>\n      </ThemeProvider>\n    </QueryClientProvider>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;AACA;AACA;;;AANA;;;;;;AAQO,SAAS,UAAU,EAAE,QAAQ,EAAiC;;IACnE,MAAM,CAAC,YAAY,GAAG,IAAA,yKAAQ;8BAAC,IAAM,IAAI,+LAAW,CAAC;gBACnD,gBAAgB;oBACd,SAAS;wBACP,WAAW,KAAK;wBAChB,sBAAsB;oBACxB;gBACF;YACF;;IAEA,qBACE,6LAAC,gNAAmB;QAAC,QAAQ;kBAC3B,cAAA,6LAAC,oKAAa;YAAC,WAAU;YAAQ,cAAa;YAAQ,cAAc;YAAO,aAAY;sBACrF,cAAA,6LAAC,sJAAY;;oBACV;kCACD,6LAAC,sJAAO;wBAAC,UAAS;wBAAY,UAAU;;;;;;;;;;;;;;;;;;;;;;AAKlD;GApBgB;KAAA","debugId":null}}]
}